On the Prediction of Anomalous Events Onboard Geostationary SpacecraftMaj. Tmothy M P  MountfordJoint Services Command Staff College,Faringdon Road, Watchfield, Swindon, Wiltshire, SN6 8LADr.Venkat.V.S.S. Sastry(Applied Mathematics and Operational Research GroupEngineering Systems Department, RMCS Shrivenham, Cranfield University, Wilts. SN6 8LAKeywords: Anomalous events, neural networks, multi-layer perceptronsABSTRACT  Spacecraft are constantly exposed to various risks caused by space weather that result in anomalous behaviour of spacecraft components. These are often related to both surface charging and internal charging. These anomalies range from simple events such as register corruption to severe events such as loss of solar power generation. There have been some studies to predict the anomalous behaviour of the spacecraft by hypothesizing that space weather has a significant effect. Wintoft and Lundstedt have proposed neural network models that predict spacecraft anomalies given the space environment data. Their work utilizes data for satelites Tele-X & Meteosat 3 which were in geostationary orbit where the risk due to space weather is significant. In this paper, we aim to investigate the causal relationship between the space weather and anomalies by incorporating data series associated with the anomalies and the corresponding environmental data, in particular the weighted geomagnetic index Kp. A significant outcome of the study is the explanation of the false positives, where some of these have been accounted for by tracing the events to other known satellite anomalies (excluding SKYNET IV). The neural network models presented in this paper provide useful insights for further work in this area.IntroductionOne of the primary aims of this study is to investigate the causal nature of space weather on space craft. Using the environmental data for the 12 year period (1990 – 2001), and the anomalies data for the SKYNET IV constellation of spacecraft, several neural network models have been developed. The anomaly data was first categorized to derive the subset of anomalies most likely to have occurred as a result of space weather, before any presentation to the networks took place. The input to the network consists of environmental data (Kp – weighted average of K index values taken from magnetometres on the earth’s surface) as time series of given lengths. Both these datasets were available at one hour resolution for the period under study. In the first model we investigate direct correlations in time between Kp-time series and the anomalies data. The second model investigates causal lag by including Kp-series of various lengths and the anomalies in two different ways. The first approach considered a point estimate for a given length of the Kp-series, while the second approach retained the past history.  All the models developed were tested using the data for 1993 as an example. The performance of the networks is qulalitatively consistent. A significant outcome of the study is the explanation of the false positives, where some of these have been accounted for by tracing the events to other known satellite anomalies (excluding SKYNET IV). A plausible explanation is that the inputs considered affect all the satellites that are present in the magnetosphere.   It is found that Kp data has significant impact. From the implementation perspective, the gradient of Kp data resulted in better performance of the network. Other environmental data such as energetic particle density (derived from GOES space craft data) have also been used as inputs to the netowrk, and it was found to have very little impact on the results. In summary, the neural network models presented in the study support a causal relationship between the space weather and spacecraft anomalies. The models provide a simple mechanism to accommodate lag time between cause and effect. The preliminary results are encouraging and suggest further work. They also offer a useful tool to predict the occurrence of anomalies on spacecraft. The paper is organised as follows: Section 2 provides a very brief introduction to space weather and introduces some of the terminology used in this article. Section 3 describes data sets used in the development of neural networks. Section 4 discusses the results of the neural network models. The results of our preliminary study into prediction of anomalies are summarized in Section 5.BackgroundSpace weather refers to magnetic, electromagnetic or particulate activity, which has an influence upon the environment of our solar system, mostly as a result of solar activity. The significant effect of space weather on spacecraft is not understood very well. High energy particle emissions due to solar activity can cause serious damage to the electronic systems on board space craft as illustrated in the following examples.“As a consequence of a high-speed solar wind stream impacting the earth’s magnetosphere on January 20, 1994 at 1735 UT, the Anik E-1 spacecraft at geostationary orbit suffered an operational anomaly causing a loss of attitude control. Telesat Canada operators were able to finally switch to the backup momentum wheel controller and resume reasonably normal operations. The Anik E-2 satellite also experienced a failure of its momentum wheel control circuitry at 0210 UT on the following day. Anik E-2’s backup circuitry was found to be non-functional and therefore normal operational control of the spacecraft was lost. TV, radio, telephone and scientific operations within the American continent were affected for hours to days by these anomalies: the news, weather and entertainment programming were affected, daily newspaper’s information gathering systems were inoperative, and telephone services were interrupted in Canada (Baker, 1996)”An anomaly is any form of unexpected action or activity on board a spacecraft. Typical anomalies include, electrical fault, an attitude anomaly where the spacecraft exceeds expected pitch, roll and yaw parameters; or action anomaly where event occurs that should not have occurred. One of the major environmental causes for anomalies is the exposure of satellites to the hot plasma and energetic particle populations. There have been some studies by Swedish scientists (Anderson et al, 2000; Wu and Lundstedt, 1998) to predict the anomalies in the satellites given the environmental data. For example, Wu and Lundstedt (1998) found good correlation between the anomalies found on board two GEO satellites (Meteosat-3 and Tele-X) with environmental data derived from solar wind measurements.It is widely agreed that the interaction between orbiting spacecraft and energized particles, particularly highly energized particles, causes charging. Charging  is normally caused by magnetospheric substorms, solar illumination and geomagnetic storms.In this paper, we consider a subset of anomalies that are believed to have been associated with some form of charging, and that have resulted from the cumulative effects of what is generically known as electrostatic discharge (ESD). Input DataInput data consists of anomalies data and the environmental data, which are described below.Anomaly DataIn this paper, we have grouped the events due to surface discharge and deep dielectric discharge under one label. We have used the anomaly database for SKYNET 4 series of spacecraft (Davidson, 2002). The anomaly database consists of 1300 anomalies, of which 471 are associated with ESD. Anomaly data set is available at one hour resolution. The spread of anomalies across 12 year period is shown in Figure 1. The plot clearly indicates the maximum in anomalies associated with solar maximum in 1994/95. The anomaly numbers would normally tail off toward solar minimum in 2001/02, but the figure shows increased anomalies which are attributable to launching of three additional spacecraft, which effectively doubles the constellation size. This is further compounded by the fact that many anomalous events tend to occur during the initial in-orbit testing phase of the spacecraft.Environmental dataThe environmental data considered in this article consists of energetic particle (electron flux) data (>2MeV) from Geosynchronous Operational Environmental Satellites (GOES), and the geomagnetic data, Kp. The measurement of electron energetic particle density is made by one, or more, of the GOES series of spacecraft. This data is obtained from Space Physics Interactive Data Resource (SPIDR), at Boulder, Colorado. It is possible to download data of varying resolutions covering Solar, Geomagnetic and electron energetic particle indices. The highest resolution for >2Mev energetic particle density resolution is five minutes. In the present study, we chose hourly resolution for the reason that magnetic field data and solar wind data was only available at a minimum resolution of one hour. In the case of the anomaly data this entailed a change of notation to indicate in which hour the anomaly had occurred rather than in which minute of the hour. We believe that this to be an acceptable level of resolution. As with the anomaly data, we began with three small sets of test data covering the dates mentioned in the anomaly data section above. Sufficient care is taken to assure that the data obtained from different sources is correctly aligned.The magnetic field in which the satellites are situated is characterised by two indices – planetary K index (Kp) and Dst (Disturbance storm time) index. The magnetic field measured at the Earth’s surface is the sum of an internal planetary magnetic field and of components of primarily external origin, including those due to currents induced in the conductive Earth. While the primary magnetic field has a slow variation period, the external components are characterized by transient variations having time scale in the order of days to minutes or even less.These transient variations are in themselves representative of the changes of state taking place in the whole of the magnetosphere as a result of coupling between the solar wind stream and the magnetosphere. The transient variations can be further decomposed in to regular and irregular components. It is the irregular variations that we are primarily interested in as they are mostly due to the energy fluctuations in the magnetosphere as a result of, for example, magnetospheric storms and substorms. There are also higher frequency fluctuations and rapid variations including so called magnetic pulsations, but as little information is available on these phenomena they have been  ignored in this study.There are a large number of indices that can be used to measure transient variations. It is believed that geomagnetic activity has significant influence on satellite anomalies, we have used the planetary K index (Kp), as it is an index of geomagnetic storm activity, and the Dst index. (See Wu et al., 1998 and Andersson et al, 2000 ).Kp is a three hourly measurement and is an index ranging from 0-9,  where a value of 0 corresponds to  quiet and a value of 9 corresponds to severe disturbances in the magnetosphere indicating the presence of strong geomagnetic substorms, respectively. The index is derived from ground-based magnetometers at several dozen locations around the globe as opposed to actual measurements from spacecraft in the plasma medium of the magnetosphere. Kp is calculated from a weighted average of K index values from the network of magnetometers placed at observatories on the earth’s surface at a multitude of locations around the globe. Thus it suffers from variation in local methods of calculating K and, from the fact that not all observatories report K in real time. As a result Kp can sometimes be a best guess effort and due to the highly localized nature of geomagnetic substorms the use of a global average can mask the local severity of such storms upon individual spacecraft. One school of thought suggests that it is better to use data from an observatory that has the magnetometer closest to the point at which the magnetic field line nearest to the affected satellite achieves earthfall.The main reason for using the Kp index as an input is from the study of work carried out to relate the geomagnetic indices Kp and Dst to spacecraft anomalies  In this study a variety of neural networks were trained to make daily anomaly predictions. It was found that whilst a link between electron energetic particle density of the >2Mev type is linked to anomalies, the best parameter for daily prediction was in fact Kp. This finding was confirmed by further research carried out in to anomalies occurring onboard the Meteosat III and Telsat satellites, by the Swedish institute of Space Physics. We therefore have made use of this parameter, following our initial investigation into anomaly classification based upon energetic particle flux.The previous work in this field has also made use of the Dst Index, although it has been shown to be less effective than Kp. In simple terms it can be said that at low latitudes, i.e. those in which geosynchronous spacecraft orbit, irregular variations in the geomagnetic field present themselves as variations in the magnetospheric ring currents or those currents induced by perturbations in the horizontal component of the earth’s magnetic field. Dst is not an exact measure of the ring current values but can be said to be representative of them. KP and Dst are important because they are indices used to monitor and represent the effect of transient variations of the earth’s magnetic field as observed at various points on the earth’s surface. KP and Dst are both measured at the earth’s surface and are at this time the only accurate method available for determining the state of the magnetosphere at any given time, but it must not be forgotten that due to their global nature they may not take account of all localized events due to solar wind magnetosphere coupling and as such a clear link between these indices and the events onboard a particular spacecraft may not be obvious. Nevertheless, we believe that both Dst and Kp are key parameters Kp and Dst data was obtained  from the OMNIWEB space weather data repository at http://nssdc.gsfc.nasa.gov/omniweb. It was then cross-correlated by date with the other environmental data. Note that since 2000, true solar wind data has become available via two experimental spacecraft that sit in the interplanetary magnetic field beyond the earth’s magnetosphere and therefore in an unprotected position within the solar wind stream. The data available clearly does not cover the bulk of the period under investigation. However, future studies will benefit from the use of such  data where possible to investigate the relevance of solar wind stream data to the occurrence of the anomalies.    EMBED Excel.Chart.8 \s Figure 1 Distribution of anomalies due to Electro Static Discharge. A typical distribution of electron flux density and anomalies is shown in Figure 2 for the year 1993.Figure 2 Distribution of electron flux density (>2 MeV) on GOES 5 (top), GOES 6 (middle) and anomalies (bottom).Distribution of Kp index is shown in Figure 3.Figure 3 Distribution of electron flux data (filtered), and    Kp index superimposed on anomalies data.Neural network modelsIn this article, we investigate primarily three neural network models for the prediction of anomalies. These are described in some detail in the following sections.Model 1 In this model, we consider a neural network with three inputs and two outputs. The three inputs consist of electron flux density (>2 MeV) from GOES 5 and GOES 6, and the Kp value. Corresponding to each triplet, we associate a desired output as a vector of two elements, one representing the occurrence of an anomaly, and the other the non-occurrence of an anomaly.  It is conjectured that this choice of output enables the network to learn non-anomalous relationships between the inputs and outputs.The data set for the year 1993 was chosen to investigate the model. In this year there are 48 anomalies among 8760 samples. In order to minimize over-learning on the non-anomalous events, we have restricted the traning set  to consist of any 100 randomly chosen samples. The neural network consists of three inputs, 10 hidden layer neurons, and two outputs, often referred to as 3-10-2 network. The number of hidden layer neurons has been varied, and the results for the 3-10-2 network are found to be optimal. The transfer function used in the hidden layer and the output layer is log-sigmoid function, EMBED Equation.3  .The network is trained using Levenberg-Marquhardt algorithm. All the networks reported in this article are developed using Neural Network Toolbox (Mathworks, 2002). Once the network has been trained, we consider the number of misclassifications to assess the performance of the network. To this end, we have presented the performance of the network as a two by two matrix,GBGGGGBBBGBBWhere GG represents the number of instance, the network has correctly classified an anomalous event given an input that is known to correspond to an anomalous event; GB represents the number of instances, the network has classified an anomalous event as a non-anomalous event; BG represents the number of instances the network has classified an non-anomalous event as an anomalous event; and finally BB represents the number of instances the network has classified a non-anomalous event as a non-anomalous event. The output of two typical runs is shown below:    GBG434B73111400GBG397B61602565               Run 1                                       Run 2While the network is able to achieve a good classification on anomalous events, its performance of non-anomalous events is rather poor. This model also suggests that the use of spot values alone is unlikely to lead to better prediction of anomalous events. Model 2In this model, we attempt to account for the causal relationship between the environmental data and the anomalies. In this approach, we divide the data for the year into blocks of a given size. As a first step, we associate the cumulative sum of the environmental data with the corresponding sum for the anomalous events. This is undoubtedly a crude method and takes no account of the fact that more than one anomaly may occur in a time period, making it difficult to separate the causes for each anomaly from each other due to summation. It is also unable to relate between blocks such that an anomaly occurring at the very beginning of a block may be related to activity in a previous block, but the network will not able to discern this relationship. Despite these limitations it was considered worth investigating as the summing process does represent the process of charge build up on board a spacecraft, and it is hoped that the study might reveal if a threshold level existed after which discharge would occur.Typical results for a block length of 60 are presented here. For the data set under consideration (year 1993), 42 blocks are associated with an anomalous event, while 104 blocks are associated with non anomalous events. The network is trained using Levenberg-Marquhardt algorithm. Approximately 57% of the data is used for the training, and the remaining for validation and testing. The performance of the network on the complete data set is shown below.GBG29 13B18 86 The above performance is encouraging in that the network is able to learn the non-anomalies (83%) better than the anomalies (69%). We also considered the block sizes of length 120 and 240 over the entire set for 12 years (1990-2001) and the performance degraded substantially. However, this model suggests a detailed consideration of time histories of environmental data associated with the anomalies which is discussed in the next Section.Model 3In this approach, an anomaly is associated with a fixed length of data series associated with the environmental data, Kp. The network is trained on the data set for the year 1993, and predictions are made using the data set for the period 10 – 19 March 1994. The test set contained four ESD anomalies on board Skynet, and 13 ESD anomalies on board other spacecraft. This choice of the test set also provides us an opportunity to explain the false positives. The input to the network consists of sample values of the data series of chosen size associated with the anomalies. First, we partition the data set into two classes those associated with anomalies and non-anomalies. For the year 1993, there are 48 anomalous events, none of which were found during the first 23 samples. To obtain a good coverage, the training set consisted of data associated with all the 48 anomalous events, and 200 randomly chosen samples of data associated with non-anomalous events. We also found that the curvature information of the environmental data resulted in improved classification.  In view of the randomness introduced in the non-anomalous data set, it is useful to test the performance of the network by presenting the complete data set for the year 1993. A typical result is shown below:GBG462B19656724   It is no surprise that most of the anomalous events are identified correctly. However, there are still 23% of non-anomalous events are identified as anomalous events, which is a significant improvement on Model 1. The performance of the network on the test set (for the period 10 – 19 March 1994) is shown below:1994GBG37173Note that the test set contains 17 recorded anomalies. An abridged version of the anomaly data obtained from  HYPERLINK "http://www.ngdc.noaa.gov/stp/GOES/goes_looking.htm" http://www.ngdc.noaa.gov/stp/GOES/goes_looking.htm is shown in Table 1 for easy reference. DateSatellite IDTime (UT)10-Mar-94@GG0505075710-Mar-94@GG0511224512-Mar-94@GG0503200013-Mar-94@GG0505074013-Mar-94@GG0507110913-Mar-94@GG0507112814-Mar-94@GG0508013914-Mar-94@GG0511085314-Mar-94@GG0505174015-Mar-94@GG0508024615-Mar-94@GG0507163215-Mar-94@GG0504191016-Mar-94@GG0505103817-Mar-94@GG0510110317-Mar-94@GG0504172718-Mar-94@GG0511NA19-Mar-94@GG05051058Table 1 Anomalies on board satellites other than Skynet. An @ symbol for the satellite ID denotes an anonymous name to protect its identity.A plot of recorded events together with the prediction for the period under consideration is shown in Figure 4.Figure 4 Anomaly predictions for 10 – 19 March 1994 using data series of length 24. Blue asterisks show the predictions, and magenta circles show the recorded events during the same period.The horizontal axis in Figure 4 represents hours in the year starting on 1 January 1994. The prediction of four anomalous events (at index positions 1641, 1689, 1762 nd 1812) on the Skynet satellites is clearly visible. It is also interesting to note that the majority of the blue predicted event asterisks coincide with or are cluster close to the magenta circles (recorded events). This indicates a prediction matching an actual event in the case of coincidence or a prediction missing an actual event time by a few hours in the case of close clustering.  The occurrence of blue prediction asterisks in regions where there are no nearby or coincident magenta circles can be explained in one of three ways. Firstly they could well be the result of an incorrect prediction, secondly the conditions for an anomaly to be triggered may have existed at that time at some point within the magnetosphere, but no spacecraft was in that region, or third an event did occur, but no data is available to indicate occurrence. As it is generally considered that the typical lag between the geomagnetic activity and anomalies is of the order of three to eight days. Accordingly, the data series of lengths 48 and 72 were used to compare the predictions, and the typical results are shown below.lengthGB481812772131400    The number of anomalous events for the data series of lengths 48 and 72 are much closer to those actually recorded for the  period under consideration, when compared with the predictions with data series of length 24. However, the predicted values, as shown in Figure 4 are far superior for the data series of length 24.It must be emphasized that even given access to this additional source of data, it is likely that other events will have occurred on board other spacecraft, the details of which are not available due to commercial or military sensitivities. As such we do not expect to be able to account for all false positives. DiscussionIn this paper, we have developed neural network models to predict anomalies on board satellites. The models make an attempt to exploit the causal relationship between space weather and ESD anomalies. The exact nature of this relationship remains unclear, but it would appear that Kp, the global average of K indices, is the most significant relationship descriptor available to date.It has also been shown that it is possible to examine the data in a variety of ways, but still see evidence of this relationship throughout. In some forms it is clearer, such as when using the second derivative of Kp at 24 hour time series resolution, than for example a simple statistical analysis at one hour resolution. Yet the fact that such evidence pervades the whole of the study leads us to believe that this study has followed the right path. As far as we are aware the use of the second derivative of Kp is a new approach and needs further investigation to examine whether it really is more effective than using raw Kp or whether that was simply a quirk of the data used for this study.  Note that the use of numerical derivatives for the environmental data in general amounts to smoothing, and has the additional advantage of removing some unwanted noise in the data.It is very clear from this preliminary study that both >2MeV and Kp data have an important part to play in the prediction of anomalies, but it is suspected that there remain other parameters, known or unknown that could be used to more exactly classify the likelihood of such events. References[1] Anderson, L., O. Norberg and L. Eliasson, The use of environmental data to predict and analyse spacecraft anomalies, In Proceedings of 6th Spacecraft Charging Technology Conference, AFRL-VS-TR-20001578, 1 September 2000.[2] Baker, D.N., J.H. Allen, R.D. Belian, J.B. Blake, S.G. Kanekal, B. Klecker, R.P. Lepping, X. Li, R.A. Mewaldt, K. Ogilvie, T. Onsager, G. D. Reeves, G. Rostoker, R. n, H, J. Singer, H. E. Spence, N. Turner, An assessment of space environmental conditions during the recent Anix E1 spacecraft operational failure, ISTP Newsletter, Vol. 6, No. 2, June, 1996.[3] Wu. J.-G., and H. Lundstedt, Neural network modelling of solar wind-magnetosphere interaction, JGR, 1998.[4] Davidson, M, Anomaly data, Private communication, RAF Oakhanger, 2002.[5] Mathworks, Neural Network Toolbox, Version 4.0.2 (R13)  28-Jun-2002.Maj. Timothy MountfordTimothy M P Mountford (Monty) is a serving officer in the British Army. He has recently completed an MSc in Defence Simulation and Modelling, submitting a thesis looking at the effects of space weather on geo-synchronous orbit spacecraft. Monty is currently studying at the Joint Services Command and Staff College in the UK. He has a particular interest in the space environment stemming from three years spent as a mission controller for the UK Military Skynet IV constellation of communications satellites. Dr.Venkat.V.S.Sastry VenkatV S S Sastry has obtained his PhD (1980) in Applied Mathematics from IISc Bangalore, India. Venkat worked on analytical models of propagation of sound over ground, in underwater sediments (1981-86) as a post doctoral research fellow. Venkat joined Royal Military College of Science, Shrivenham in 1989 as a lecturer. Since then he has developed interests into applications of Intelligent Systems and Virtual Environments for Training. His current interests include, gesture interpretation in virtual environments for training applications and application of agents for decision support.( Author for correspondence. Wintoft, P., and H. Lundstedt, Neural network prediction of geosynchronous relativistic electron flux from solar wind data, The First SRAMP Conference, Sapporo, Japan, Oct. 2-6, 200, S1-P11, p.22, 2000.Page  PAGE 7 of  NUMPAGES 7