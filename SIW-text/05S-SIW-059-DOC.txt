Towards Rapid 3D Reconstruction of Complex Areas of OperationsSimon Ahlberg, Ulf Söderman, Åsa Persson, Magnus ElmqvistSwedish Defence Research Agency, FOIPO Box 1165SE-581 11 LinköpingSweden+46 13 37 80 00{simon.ahlberg,ulf.soderman,asa.persson,magnus.elmqvist}@foi.seKeywords:Environment modelling, LIDAR data, mission planning, mission rehearsal ABSTRACT: Modern operations often take place in complex and dynamic environments such as urban areas, where access to updated and detailed geographic and topographic information can be a key factor for mission success. In many situations, this kind of information is sparse, old or even unavailable. For international operations this becomes increasingly important, since knowledge about the locality is of essence when planning or preparing for a mission. Systems for decision support, mission planning and mission rehearsal benefit from having accurate and updated information about the area of interest. The information can range from a detailed description of the actual terrain shape down to individual objects such as trees and buildings. An accurate and updated representation of the area of interest can give increased situation awareness and preparedness.To obtain the kind of information needed for these applications we suggest the use of high resolution laser scanners combined with digital cameras. Today, these systems can be mounted on aircraft and helicopters, but in the future we should expect to see them mounted on tactical UAVs or UGVs. We have developed new methods for extracting relevant information from the acquired data. For example, methods for automatically modelling the bare earth, extracting and reconstructing buildings, identifying and classifying features such as individual trees, lamp posts and power lines. This information can then be used for mission planning systems for rapid visualisation, detailed LOS calculations or for route planning systems, etc. The extracted information can also be used as input to commercial terrain database generation tools for producing accurate models of the area of operations. These models can then be used in training simulators for eg. mission rehearsal. In many situations, time is a critical aspect, emphasising the need for automated processes from data acquisition to application specific environment model.   In this paper we will present recent results and how these methods can be used to create detailed and specific virtual environment models for e.g. mission planning and training. The long term objective of the research is to develop an automatic process from data acquisition through feature extraction to produce mission and task specific virtual environment models of the areas of operations.IntroductionModern conflicts often face the challenge of a changing battlefield. We have gone from massive force-on-force clashes on large battlefields to close quarters, often involving a “green force” in the form of non-combatants and civilians. The battle has moved from the fields into urban areas, where access to updated geographic information is of great value for mission success. Peacekeeping operations are increasing in number, so the current military capabilities must be transformed in order to meet the new challenges. These new battlefield challenges and situations also set new requirements for turnaround time and geometric resolution for environmental data for mission planning and mission rehearsal systems, making updated and high resolution geographic information a vital component in today’s battle management systems. New sensors provide new possibilities for acquiring these kinds of data. Traditionally, satellite and aerial imagery and radar have been the sources for acquiring topographic information, but the use of laser scanners is becoming more frequent. With laser scanners it is possible to acquire data with a very high resolution.  This also gives new opportunities for extracting terrain feature information. Traditionally, processing the data to find the actual targets has been the focus of this kind of data processing. Now, extracting information about the whole environment is becoming increasingly important, e.g. for manoeuvrability and intervisibility analyses in C2 systems. Research on development of methods for processing laser data is growing and is strongly influenced by the increased interest of using laser radar systems for data collection in many mapping and remote sensing applications [1]. Results have been reported for many problem areas of which several are of interest for high-resolution natural environment modelling for various simulation applications, e.g. infrastructure mapping, remote sensing of forest and natural resources, city modelling including 3D reconstruction, etc [2] [3] [4]. A fast data acquisition and processing system would make it possible to create updated terrain models for use in C2 and training systems. A realistic geospecific training environment used in simulations for training prior to a mission can give vital knowledge about the locality and familiarity with the area of operations.Data acquisitionAdvances in sensor technology have made it possible to use new high resolution sensors for data acquisition. In our work we use data from airborne laser scanning (ALS) systems with digital cameras.  Today, these systems can be mounted on airplanes or helicopters, but in the future we expect to see them carried by UAVs, UCAVs or UGVs.ALS systems generally consist of a range measuring laser radar (sometimes also referred to as LIDAR - Light Detection and Ranging), an opto-mechanical scanner, a positioning and orientation subsystem consisting of a differential GPS, an INS (Inertial Navigation System) and a control and storage unit. The laser radar consists of a laser range finder measuring range by time-of-flight. In many applications, aerial imagery is a desired complement to the laser data. Therefore, many ALS systems are also equipped with high resolution digital cameras. For each image, the position and orientation of the camera can be obtained using the GPS and INS subsystems. Georeferenced orthophoto mosaics can then be produced using the images, the camera position and orientation data and a digital terrain elevation model from the laser data. Since no stereo overlapping images and/or ground control points are needed, orthorectification can be completely automatic.The laser and image data we have used in our research are acquired using the TopEye ALS and camera system (www.topeye.com). The data used in this work originates from data sets acquired at different occasions between 1998 and 2004. The surveyed areas consist of different terrain types, for example forests, urban terrain and rural terrain. The point density in these data sets varies from approximately 4 up to 16 points per m2.  SHAPE  \* MERGEFORMAT Figure  SEQ Figure \* ARABIC 1. Scanning ALS principle.Recent technology development has made it possible for systems to have the ability to store the whole waveform of the reflected laser pulse, leading to new opportunities in data processing and classification. New sensors are also being developed, such as the Focal Plane Array (FPA), where the single detector is replaced by a matrix of detector elements, yielding an “image” of range values for each laser pulse, leading to vastly increased spatial resolution and significantly higher data acquisition speeds. SHAPE  \* MERGEFORMAT Figure  SEQ Figure \* ARABIC 2. FPA principle. A matrix of detectors gives a range “image”. SHAPE  \* MERGEFORMAT Figure  SEQ Figure \* ARABIC 3. ALS “laser images”. Height (left), multiple returns (middle) intensity (right).Laser dataThe most frequently used scanners are line scanners which use an oscillating mirror to deflect the laser beam back and forth across the flight track. The measured elevation points form a zigzag pattern on the terrain surface as the platform moves forward The positions of the points correspond to the locations where the laser pulses have been reflected off the terrain or off object surfaces, for example on vegetation, ground or man-made objects. The laser point positions are determined using the measured ranges and the registered corresponding positions and orientations of the laser radar system. In addition to terrain elevation, modern ALS systems usually register the “intensity” of the reflected laser pulse. Many systems also have the ability to register multiple returns for a single laser pulse. The intensity and the multiple return data constitute a valuable source of additional information for terrain feature classification.Data processingDepending on the application requirements for the 3D virtual environment model, different types of information are needed for its construction. However, to facilitate data processing, raw data from the ALS system must be pre-processed and stored in some suitable format. The digital images often need to be colour and contrast balanced and the spatially irregularly distributed laser data points are often structured into regular grids with suitable cell sizes to resemble “images”. Different types of grids or “laser images” can be obtained depending on the selection of value for the cells. For example, a maximum (minimum) elevation image can be obtained if the highest (lowest) elevation value is selected in each cell. A “multiple return image” can be obtained if the number of laser points that are part of multiple returns is selected as cell value.  REF _Ref94431349 \h Figure 3 shows a maximum elevation, intensity and a multiple return image. The elevation and intensity images are interpolated to fill empty cells. Note the appearance of the vegetation, building outlines and other sharp edges in the multiple return images. The maximum elevation image is usually also referred to as a digital surface model (DSM) since its elevation data models the terrain topography including trees, buildings and other features. A DSM can be used directly for 3D-visualization, simple view-shed analysis etc. Ground filteringClassification of laser data [5], [6] is an important processing step towards single tree identification, 3D building reconstruction and other types of feature extraction. The first class to be determined is “ground”. This is done by estimating a ground surface model representing the bare earth using a minimum elevation image s and then classifying all pixels on or within a given range from this surface as ground. After that, the remaining data can be further classified as buildings, vegetation, power lines, etc. SHAPE  \* MERGEFORMAT Figure  SEQ Figure \* ARABIC 4. Extracting the DTM from the LIDAR data.For the construction of a ground surface model, a.k.a. a digital terrain model (DTM) we have developed a method based on active contours [7]. The method is based on the theory of active shape models [8], [9]) and the implementation uses a hierarchic and iterative processing scheme, like many other methods for ground surface modelling [10], [11]. The active contour acts, metaphorically speaking, like a sticky rubber cloth that is being pulled upwards towards the ground points from beneath. It is attracted by the elevation data and sticks to points that (are assumed to) represent the true ground. The internal elasticity forces prevent it from reaching points not representing the true ground. When it is stabilised the result forms a continuous model of the ground surface. An example illustrating the result of using this method is shown in  REF _Ref94431450 \h Figure 4. The implementation has recently been evaluated in an international study on methods for ground surface modelling [12].Feature classificationOnce the ground surface model is constructed, pixels are classified as ground if they are within some given range to the surface. After ground classification, the remaining data can be further classified. Classification of buildings starts by segmentation. Information about multiple returns is used to remove large parts of the vegetation and building outlines. Point candidates for the building class are grouped into segments. Next, each segment is classified as building or non-building using an artificial neural network. The classification is based on measures of shape, curvature and maximum slope.Posts (e.g. lampposts or short masts) can be classified by detecting narrow and high objects in the DSM. Detected post-like objects which are close to vegetation or buildings are removed to avoid ambiguities. Everything which lies higher than a specified height above the ground surface and which is not classified as buildings or posts is classified as vegetation. Laser points classified as ground can be further classified as “road” (roads, paths, other paved areas, etc) or “non-road” using intensity information. Building reconstructionBuilding reconstruction from laser data is a growing field of research [13], [14], [15]. For 3D reconstruction of buildings we have developed a method that is aimed to be fully automatic and that should be general enough to handle almost every building, including buildings with curved walls and dome shaped roofs. For each segment that is classified as building, i.e. the building footprint, the elevation data is used to extract the height data within that segment. The data is analysed in order to find segments that make out the roof. From these segments, vertical walls are dropped down to the ground, resulting in a 3D hull (a CAD model) of the building.  REF _Ref94431543 \h Figure 5 illustrates the 3D reconstruction of a building using this method. SHAPE  \* MERGEFORMAT Figure  SEQ Figure \* ARABIC 5. From building footprint to CAD model.Tree identificationThe use of ALS data for forest applications is increasing [16].  We have developed a novel method for identification of single trees and estimation of tree position, height, and crown diameter in areas classified as vegetation [17]. In ongoing work we are also extending the method to include tree species classification [18]. These methods have been validated in cooperation with the Swedish University of Agricultural Sciences (SLU), Department of Forest Resource Management and Geomatics.Single tree identification consists of three main steps. First, a surface model of the canopy of the trees is created using the same active contour method that is used to estimate the ground level. The active contour method is applied to a maximum elevation DSM, but this time from above. Second, the canopy surface is filtered using different degrees of smoothing and the resulting surfaces are segmented using watershed segmentation. Finally, single trees are identified by determining which of the surface segments that are actually trees. The position, height and diameter can now be estimated for each tree using the segment area and elevation data.  REF _Ref94431475 \h Figure 6 shows a result of tree identification and position estimation.For separating between spruce, pine, and hardwood trees, all laser points within a tree segment area are used to form a point cloud for the tree. Tree species classification is then performed based on different measures describing the canopy shape and point distribution in the point cloud.  REF _Ref94431475 \h Figure 6 shows tree point clouds and the result of classification of tree species. SHAPE  \* MERGEFORMAT Figure  SEQ Figure \* ARABIC 6. Tree species identification and tree positioning.Other featuresThe methods described here are used for extracting terrain features as a complement to extracting information about targets in the terrain. Target detecting and identification, although similar in nature, is another field of research which is not discussed here. However, knowledge about the targets and the environmental context that they operate in can give a better overview of the situation. SHAPE  \* MERGEFORMAT Figure  SEQ Figure \* ARABIC 7. “Layers” of extracted information are integrated to form a 3D model of an area.3D environment modellingThe methods discussed above can be used for producing data sets suitable for the construction of high-fidelity 3D virtual environment models, e.g. using commercial 3D modelling tools [19].The ground surface estimation is used to construct a DTM. The tree identification method can output a point vector layer, where the positions of the points represent the locations of the trees and the attributes describe their heights, crown diameters and species. The building reconstruction method can output a point vector layer where the positions represent the locations of the buildings and other attributes are used to link the points and the corresponding 3D building models. In addition, a high resolution orthophoto mosaic can be produced as a separate layer to be used as ground texture.  REF _Ref94431522 \h Figure 7 shows an example of a 3D virtual environment model produced using these methods on ALS elevation/intensity data and high resolution imagery. The area is approx. 450m x 300m. The DTM for the model has a post spacing of 0.25 m. The ground texture has a pixel size of approximately 5cm x 5cm on the ground. Each tree is represented by a 3D model. There are more than 50 buildings which are all automatically reconstructed from the laser radar data.ApplicationsThere are many military and civilian applications for high resolution topographic and feature data and for rapidly constructed geospecific environment models, for “live” use as well as for modelling and simulation applications.Command and control systemsWhen planning an operation, access to updated information about the current situation can be an important factor. In many situations, the geographic information about the area of operations that is taken “off the shelf” can be incomplete, inaccurate or outdated (if it is available at all). This accentuates the need for methods for updating the geographic information. For urban operations, this becomes particularly important, since such operations require reliable information about e.g.  intervisibility (status of buildings, LOS calculations), accessibility (road widths, road blocks, obstacles), etc. Access to an automated system for fast surveying and feature extraction is most valuable. The availability of reliable geographic information can be a key contributor to the success for mission planning for obstacle avoidance, routing, sensor and observer placement, etc. SHAPE  \* MERGEFORMAT Figure  SEQ Figure \* ARABIC 8. “Threat visulisation” using high resolution data.Training systemsThe time span from mission initialisation to operation can be very short. For the safety and increased chance of success in a mission, it can be important that the personnel be allowed to familiarise themselves with the environment in order to obtain knowledge about the locality. By using high resolution sensors and automated methods as described in this paper it is possible to create detailed geospecific virtual models of the areas of operations in short time. These models can be used in simulators for mission training or rehearsal.  SHAPE  \* MERGEFORMAT Figure  SEQ Figure \* ARABIC 9. City model made from LIDAR data, with tree models, reconstructed buildings and photo texture.Interoperability issuesModern operations are often executed by task forces of different origin, whether it is from different services or from different nations.  To facilitate interoperability, this puts an emphasis on the use of standardised terminology for describing the natural environment. To employ a consistent schema such as SEDRIS for environment description could prove important when developing methods for terrain feature extraction and sharing of such information.ConclusionsUpdated and detailed geographic information can be a key factor for the safety and success of a mission. This paper has shown how new methods for automatic feature and parameter extraction can process data from high resolution sensor systems. The extracted information can be used for updating the geographic information in C2 systems or for generating geospecific virtual environments for mission training and rehearsal in order to maximise the amount of training in the actual environment prior to an operation and to obtain a better situation picture.  ReferencesTurner, J. T., Moscoso, C.P. (2000): 21st Century terrain – entering the urban world, Interservice/Industry Training, Simulation and Education Conference (I/ITSEC), Orlando, Florida, USA.Torlegård, K. (Ed), (2001). Proceedings of OEEPE workshop on airborne laserscanning and interferometric SAR for detailed digital elevation models 1-3 March 2001; Royal Institute of Technology Dept. of Geodesy and Photogrammetry, Stockholm.Proceedings of the ISPRS working group III/3 workshop “Land Surface Mapping and Characterization using Laser Altimetry”, Annapolis, Maryland, USA, 22-24 October 2001, ISSN 0246-1840 , VOLUME XXXIV, PART 3/W4.Maas, H.G., Vosselman, G., Streilein, A., (Eds), (2003). Proceedings of the ISPRS working group III/3 workshop “3-D reconstruction from airborne laserscanner and InSAR data”, Dresden, Germany, 8-10 October 2003, VOLUME XXXIV, PART 3/W13Hug, C. (1997). Extracting artificial surface objects from airborne laser scanner data. In Gruen, A, Baltsavias E.P. & Henricson O., eds, “Automatic Extraction of Man-Made Objects from Aerial and Space Images (II)”, Birkhäuser Verlag, Basel.Maas H-G. (1999): The potential of height texture measures for the segmentation of airborne laserscanner data. Fourth International Airborne Remote Sensing Conference and Exhibition / 21st Canadian Symposium on Remote Sensing, Ottawa, Ontario, Canada, 21-24 June 1999.Elmqvist, M. (2002). Ground Surface Estimation from Airborne Laser Scanner Data Using Active Shape Models. Presented at Photogrammetric Computer Vision 2002, September 9-13 2002, Graz, Austria.Kass M., Witkin, A. & Terzopoulos D. (1998).  Snakes: active contour models. In Int. J. of Computer Vision, pp. 1:321-331.Cohen L. D. & Cohen I. (1993). Finite Element Methods for Active Contour Models and balloons for 2D and 3D Images. In IEEE Transactions on Pattern Analysis and Machine Intelligence, PAMI-15.Pfeifer, N. Köstli, A. & Kraus, K. (1998). Interpolation and filtering of laser scanner data - implementation and first results. In: International Archives of Photogrammetry and Remote Sensing, Vol. XXXII, Part 3/1, Columbus, pp 153-159.Axelsson, P. (1999): Processing of laser scanner data – algorithms and applications. ISPRS Journal of Photogrammetry & Remote Sensing, 54 (2-3), pp 138-147.Sithole, G. (2003): Comparison of Filtering Algorithms. Proceedings of the ISPRS working group III/3 workshop “3-D reconstruction from airborne laserscanner and InSAR data”, Dresden, Germany, 8-10 October, VOLUME XXXIV, PART 3/W13.Haala, N., Brenner, C. (1999): Rapid Production of Virtual Reality City Models. GIS 12(2), pp 22-28.Maas, H.G., Vosselman, G., (1999). Two algorithms for extracting building models from raw laser altimetry data. ISPRS Journal of Photogrammetry & Remote Sensing, 54(2-3), pp 153-163.Elaksher, A.F. & Bethel, J.S. (2002): Reconstructing 3D Buildings from LIDAR Data. Proceedings of Photogrammetric Computer Vision, ISPRS Commission III, Symposium 2002, September 9 - 13, 2002, Graz, Austria, pp102-107.Hyyppä, J., Næsset, E., Olsson, H., Granqvist Pahlén, T., Reese, H., (Eds), (2003). Proceedings of the ScandLaser Scientific Workshop on Airborne Laser Scanning of Forests. Umeå, Sweden, September 3-4, 2003.Persson, Å., Holmgren, J. & Söderman, U. (2002): Detecting and measuring individual trees using an airborne laser scanner, Photogrammetric Engineering & Remote Sensing, Vol. 68, No. 9, September, pp. 925-932.Holmgren, J. & Persson, Å. (2004): Identifying Species of Individual Trees Using Airborne Laser Scanner. In Remote Sensing of Environment, Volume 90, Issue 4, 30 April 2004, Pages 415-423.Söderman, U., Ahlberg S., Elmqvist, M.,  Persson, Å.: "Three-dimensional environment models from airborne laser radar data" in Proceedings of SPIE Defense and Security Symposium Vol. 5412: Laser Radar Technology and Applications IX, SPIE Defense and Security Symposium, Orlando, USA. 2004Author BiographiesSIMON AHLBERG is a scientist at the Swedish Defence Research Agency (FOI). His fields of research are environmental modelling, rapid visualization and computer graphics. He holds an M.Sc degree in Computer Science and Engineering from Linköping Institute of Technology and is currently a PhD student at Linköping University.ULF SÖDERMAN is a senior scientist at the Swedish Defence Research Agency (FOI). His research interest is modelling and simulation. He holds a PhD in Computer Science from Linköping Institute of Technology and an M.Sc. in Computer Science and Engineering, also from Linköping Institute. of Technology.ÅSA PERSSON is a research engineer at the Swedish Defence Research Agency (FOI). She received her M.Sc in Electrical Engineering at Chalmers University of Technology. Her research involves signal and image processing of laser radar data.MAGNUS ELMQVIST is a research engineer at the Swedish Defence Research Agency (FOI). He received his M.Sc in Applied Physics and Electrical Engineering at Linköping Institute of Technology. His research involves terrain modelling from laser radar data and signal processing on data from various laser and imaging systemsLasermätsystemDetectorLaserScannerStorageGPS/INS