Communication Effects Server Integration with OneSAF for Mission Level Simulation Benjamin D. Paz, Joshua A. BaerBAE Systems11487 Sunset Hills RoadReston, Virginia 20190703-668-4228 HYPERLINK "mailto:benjamin.paz@baesystems.com" benjamin.paz@baesystems.com,  HYPERLINK "mailto:joshua.baer@baesystems.com" joshua.baer@baesystems.comKeywords:Communications Effects Server, Integration, Visualization, HLA, Analysis ABSTRACT: Computer Generated Forces (CGF) provide a tactically robust environment for simulation experiments. The BAE Systems Communications Effects Server (CES) models tactical communications systems and networks. Federating these two components creates a richer environment where communications are modeled by the CES and kinematics is modeled by the CGF. Additionally, the CES provides 3D visualizations of communications. The increased fidelity of communications modeling coupled with visualization will be an effective environment for analysis.1. IntroductionBAE Systems is developing a simulation environment for operations analysis of mission-level simulations. The goal for this environment, being developed with High Level Architecture (HLA), is to enhance System of Systems (SoS) development for tactical capabilities. Tactical systems are developed using engineering-level simulation that considers the physics-based modeling aspects of the system under development and its environment. To develop advanced SoS, a simplified characterization for the modeling of each system must be incorporated into a mission-level simulation environment. The modeling of the systems can then be investigated in a common environment. The BAE Systems Communications Effects federation is a key component of this mission-level simulation capability. BAE Systems has developed advanced 3D communications visualizations to evaluate SoS during simulation executions. The company also is maturing operations analysis tools for post-execution analysis. These tools facilitate mission analysis of the systems under development. 1.1 Simulation EnvironmentThe premise used for this development of the simulation environment places Computer Generated Forces (CGFs) as the main environment provider for simulation. CGFs are constructive, providing force-on-force simulation. These constructive simulations may provide supportive, logistic, and neutral forces, and non-combatants. The CGFs of interest for our mission-level simulation capability are those that model the outward appearances of platforms, systems, and individuals, including kinematics and tactical behaviors, in addition to the infrastructure modeling for the physical environment. Typically these CGFs employ rudimentary models for communications to support the requirements of a virtual simulation environment. Via HLA, higher-fidelity communications modeling is available by federating with communications models. References [1], [2], and [3] are examples of federated communications effects modeling projects in a distributed computing environment, although each environment was constructed with different goals.This effort focuses on federating communications effects based on BAE Systems’ Communications Effects Server (CES), which can support mission analysis with high-fidelity (i.e., physics-based) communications modeling. The modeling will account for effects in mountainous terrain and urban zones. The high-fidelity modeling is anticipated to process much slower than real time. This CES is flexible to support modeling at different levels of fidelity that will facilitate experimentation to optimize performance. Our CES uses OPNET to enable reuse of our existing models, incorporation of commercial models, and experimentation [4].1.2 Communications Effects Federation This federation consists of commercial, off-the-shelf and BAE Systems components and federates as shown in Figure 1.1. In the figure the CES is highlighted by an arrow and an enlarged circle. The connectivity to all components is shown in the figure. HLA is utilized for simulation interoperation between federates. Communications modeling for this effort is provided by the BAE Systems Communications Effects Server (CES). The CES consists of OPNET components (modeler, wireless, and complementary modules) and BAE Systems communications models and interface. The CES simulation interface is compliant with HLA. The Federation Object Model (FOM) is based on the Real-time Platform Reference FOM (RPR FOM) Version 2 Draft 17 with extensions for communications interactions. The CES also creates visualization artifacts for the stealth view provided by OPNET 3DNV. These visualization artifacts are not part of the simulation interoperation and are passed via a proprietary interface. These artifacts are recorded and available during playback.Figure 1.1 Communications Effects Server FederationInitial development of the CES was performed using a commercial CGF product, MaK VR-Forces. Our objective for this simulation federation is to provide credibility when executing tactical behaviors. OneSAF was chosen as the CGF because of its sponsorship and wide use in many DoD programs [5]. In addition, the BAE Systems Operational Analysis Tools (OATS) is a federate composed of hlaResults, a commercial HLA logging tool, and BAE Systems components. This tool enables queries of mission results logged in a database. The tool facilitates exercise analysis with a set of predefined queries and also accommodates creation of custom queries that can be saved for future use. 2. Modeling CommunicationsThe CES is a federate that calculates closure and propagation delay for simulated transmissions between entities based on high-fidelity models of their equipment, connectivity, and signal propagation. Communications is supported by a client-server architecture in which the CES responds to requests from other federates. A federate sends a communications request for an entity with a communications system. The CES processes the request, determining if the transmission is successful and, if so, the time received at the destination. After determination the CES responds with a communications acknowledgment containing the result. Knowing the physical location of communications systems is relevant to modeling the propagation of wireless signals. The CES subscribes to the spatial attribute of the entity state object corresponding to a communication system. A scenario is created in OPNET that maps the communications system models to their physical representations in a corresponding federate. The mapping is managed by the CES.For example, an entity object represented in VR-Forces as a tank could be represented within OPNET as a subnet containing several crew workstations connected through a router to a radio, with each workstation using a separate channel to transmit and receive on. The network model is encapsulated in OPNET as such the internal details of the network models are not exposed to the federation. This does not limit access to the subnet of the tank. Registration of physical communications system representations can be to the individual workstations. Federate entity objects can be registered at any point desired for experimentation.2.1 Communications Handling Modes There are two types of communications handling modes supported by the CES. The CES has the capability to determine communications between entities in one federate or in multiple federates. For one federate, both the sending and receiving entities are in the same federate. While in the multiple-federate case, the sending entity and receiving entity are located in different federates.Figure  SEQ Figure \* ARABIC 1.1 Single Federate Communications Modeling SequenceFigure 2.1 shows the interaction sequence for communications between entities in a single federate. The first interaction, identified by oval number one, indicates an UpdateAttributeValue for the spatial attribute from the sending entity in a federate. The position of the sender’s communications node in OPNET is updated with that information. This also occurs in the same manner for the receiver entity from the same federate to receiver’s node in the CES. Initiation of CES includes receiving the initial position for each entity prior to any communications. The remaining interactions are independent of the first and deal with the communications flow in the federation. The remaining interactions are sequential. The CommsRequest HLA interaction from the federate identifies the source (i.e., sender), the message sent time, the destination (i.e., receiver), the message size, and a communications request identifier. Internally to the CES, the CommsReqInit interaction sends the pertinent information to the sender’s node in OPNET, which then sends a TCPPktTransfer interaction to the receiver’s node. At this point, the network modeling in OPNET uses the pipeline stages in performing the communications. If this interaction successfully reaches the receiver node, then the communications effects of the transmission are calculated. The communication effects are the sum of the delays at each node. The diagram of Figure 2.1 does not include the intermediate nodes as the number of intermediate nodes will vary depending on the scenario. If this TCPPktTransfer interaction fails, the sender’s node sends an interaction back to the CES node indicating the failure. The CES node sends a CommsAck HLA interaction with the results back to the federate. As shown in oval number four, the sender entity sends the actual message data internally to the receiver entity in the federate.Figure 2.2, Communications Modeling Sequence for Different Federates, shows the interaction sequence for communications between entities in different federates. In this sequence, the CES is responsible for sending the actual message content. The significant difference regards oval number two in both figures. In Figure 2.2, the commsRequestData HLA interaction includes all of the information of the commsRequest interaction and the actual data to be transmitted in the message. As before the CES internal interactions are the same; however, the CES actually transmits the data to the receiver entity in a second federate. This transmission occurs via the CommsAckData HLA interaction that is analogous to the CommsAck interaction with the actual message data.This communications mode is used when two or more federates are involved in a federation instantiation. For implementation where the same federate is instantiated multiple times, this can support communications by adding interactions back to the source entity federate the acknowledgment to send the message to the receiver entity federate. In the case of multiple federates with disparate simulation message formats for communications, the CES can be used to reconcile these differences by mapping one format to another format and vice versa. This allows disparate federates to have interoperable communications modeling while being oblivious to the simulation message formats of other federates. 2.2 Entity State ConsiderationThe CES considers entity state by subscribing to the DamageState attribute. If the entity is damaged, the CES node sends an interaction to disable the respective damaged communications node or nodes as appropriate. Of course, a disabled node will not be able to send or receive transmissions but also that node will not be an intermediate hop in the transmission of a message. If the DamageState attribute changes to reflect a communications system as operational, the CES will reactivate the respective node.2.3 Creating Message TrafficThe CES can generate message traffic in addition to communication requests. The additional traffic is useful to augment communication requests for analysis under a heavy load. This mechanism adds to the realism without the labor-intensive process of manually creating messages.The format for the create traffic mechanism identifies a source and the intended receiver. To represent a message type, the message size and message inter-arrival time can be set according to distributions. The distributions available include Bernoulli, binomial, chi-squared, exponential, normal, gamma, geometric, Laplace, Poisson, triangular, and uniform, as well as others supported by OPNET.There are two mechanisms for creating communications traffic. One mechanism is via a createTraffic HLA interaction. With this interaction, the CES will create traffic representing one message type per interaction. The other mechanism is via a script that provides for as many message types as desired. The complete createTraffic format is required for each message type. In addition, the script supports generating traffic for each message type according to a scheduled start time.2.4 Time Management Policy The CES supports the four time management schemes for a federate of time-regulating, time-constrained, time-regulating and time-constrained, and neither time-regulating nor time-constrained. Communications modeling in a distributed environment with the CES can benefit from time regulation to insure messages are received at the time determined by the CES and not late due to processing delays.Figure 2.2 Communications Modeling Sequence for Different Federates3. OneSAF Integration into the Communications Effects FederationThe integration of OneSAF into the Communication Effects Federation requires development of a new radio model in OneSAF, implementing a time management policy for the new federation, and reconciling terrain representations. The new radio model will need to handle the CES HLA interactions for communications.  Both the CES and OneSAF support the time management schemes defined by HLA. Terrain representation in the CES federation will be expanded to operate with geocentric databases for interoperation with OneSAF. Once OneSAF is fully integrated the revised CES Federation will be as depicted in Figure 3.1. The CES will operate as in the original configuration with VR-Forces. The advantage of using OneSAF is the potential to use U.S. Army-developed behaviors and tactics for mission analysis.Figure 3.1 Revised CES Federation with OneSAF3.1 CES Interoperation with OneSAF The new radio model will support the communications interactions as defined in the sequence diagram of Figure 2.1. The source and destination position updates are implemented by an HLA attributeUpdate interaction that updates the spatial attribute for object instances inherited though the BaseEntity class. The definitions for these objects and their interactions are obtained from the Real Time Platform Reference Federation Object Model (RPR FOM) Version 2 Draft 17. These interactions are handled by the CES node, which then updates the spatial location of the nodes representing the communications systems in OPNET. Both the CommsRequest and CommsAck HLA interactions are added to OneSAF thus extending its simulation object model. The new radio model will send the CommsRequest, wait for a CommsAck, and transmit the message according to the results in the acknowledgment interaction.3.2 Synchronization between CES and OneSAF For credible execution of the federation, the CES and OneSAF must be synchronized. OneSAF will operate in its synchronization mode, enabling simulation time coordination with other HLA federates. The CES will use optimistic time advances. Upon receiving a commsRequest, the CES will calculate the result and check for entityState updates to determine if an entity was destroyed in a timeframe affecting the communications result. If the result may be affected by the loss of the destroyed entity, the commsRequest will be calculated again. Of course, the mechanisms of the CES will have disabled the corresponding communications system for that destroyed entity prior to the recalculation. 3.3 Terrain RepresentationOneSAF and the CES currently have significant differences in terrain representation. OneSAF has support for multi-elevation surfaces in which building interiors such as walls, doors, floors, and ceilings — in addition to externals apertures (e.g., doors and windows) — are modeled. OneSAF refers to structures as ultra-high-resolution buildings. The CES will need to address this capability for urban areas. The CES will need to make communications calculations based on the surfaces and apertures of such buildings. In addition, OneSAF terrain is geocentric — resembling curved earth terrain — while the CES uses projected, or flat-earth, terrain. The CES will incorporate changes for geocentric databases to solve this problem.4. Future InvestigationThis project will continue integrating OneSAF until the integration challenges have been resolved. The resulting federation must be able to support both urban and rugged mountainous zones. Scenarios from OneSAF will be utilized to provide the employment of communications in both these zones. Robust communications modeling based on the physics of the environments will be performed in both zones. For each area, characterization techniques will reduce the processing needed while still providing reasonable communications effects. This Communications Effects Federation will evaluate communications modeling characterization techniques (i.e., simplifications). With a tactical scenario, simulation executions will be performed with trials to obtain a set of varied results. Simplifications to the communications modeling will be applied and the trials repeated again with the same scenario. Comparisons will be made between the higher-fidelity and more simplified modeling results to determine if the varied results are consistent. The goal is to reduce the simulation execution time to expedite mission analysis.OneSAF version 1.5 was utilized in the current effort. Future investigation will benefit from use of OneSAF version 2.1 enhancements.5. References[1]	T. J. Bailey, MAJ M. W. Dunlop, et. al.: “Aggregate Level Communications Effects Server” MILCOM 2004, pp. 867-873, 2004. [2]	R. Bagrodia, K. Tang, S. Goldman “An Accurate, Scalable Communications Effects Server for the FCS System of Systems Simulation Environment” Proceedings of the 2006 Winter Simulation Conference, pp. 1226-1233, 2006.[3]	D. Rhodes, B. Epstein: “Scalable Urban Network Simulation” Presented at OPNETWORK 2007, August 2007.[4]	 HYPERLINK "http://www.opnet.com/" http://www.opnet.com[5]	 HYPERLINK "http://www.onesaf.net/community/" http://www.onesaf.net/community/Author BiographiesBENJAMIN DAVID PAZ is the chief engineer for BAE Systems’ Modeling, Simulation, Visualization, and Operations Analysis initiative. Mr. Paz has more than 20 years of experience in developing distributed simulations both in government and industry. JOSHUA A BAER is a modeling, simulation, and software engineer for BAE Systems' modeling and simulation group in Reston, Virginia. He has extensive experience in CGF development and integration in distributed simulation environments.