Removing Artifacts from Digital Elevation DataJames M. BardeenDepartment of PhysicsUniversity of WashingtonBox 351560Seattle, WA 98195206-685-2394bardeen@phys.washington.eduDale D. MillerAdvanced Simulation LaboratoryLockheed Martin Information SystemsKeywords:digital elevation, artifact, cornrows, photogrammetryABSTRACT:  Techniques for removing cornrow and other types of artifacts from digital elevation data are discussed.  At each point along a profile the elevation data are convolved with a set of one-dimensional filter functions which both have a finite range and are sharply peaked around discrete wavelengths in Fourier space.  By properly choosing the spacing of the filter wavelengths (uniform in the logarithm of the wavelength), the height variation along the profile in the vicinity of the point in question is represented as a sum over the discrete set of filter functions.  For each filter wavelength there is a "phase" and "amplitude" of the filter response defined from the responses to the local “cosine” and “sine” filters.  Linear artifacts which are oriented roughly perpendicular to the profiles are identified from coherence in the phase of the response at points at the same position along several neighboring profiles as a function of the perpendicular distance from the central profile, and removed accordingly.  When irregular artifacts dominate the data over a certain range of wavelengths in a certain region of the dataset adaptive smoothing can be done.  The techniques have been refined and tested on selected cells and applied to the final production version of the Southwest Asia Terrain Data Base developed by Lockheed Martin Information Systems fot he STOW Advanced Concept Technology Demonstration.  Evidence for their success will be presented.1.	IntroductionDigital elevation data obtained by photogrammetric techniques is often plagued by prominent by quasi-regular linear artifacts known as “cornrows” or “striping”.  In United States Geolological Survey (USGS) Digital Elevation Model (DEM) data these cornrows, when present, are usually oriented precisely east-west, and have rather uniform spacing within a given quadrangle, though the amplitude can be quite patchy, and the phase of the cornrows often jumps by 180 degrees crossing a ridgeline or a valley bottom.  The standard explanation [1] for the origin of these artifacts is a systematic horizontal registration offset as stereo photos are scanned manually, which depends on whether the elevation of the terrain surface is increasing or decreasing along the scan direction.  Scanning in opposite directions along adjacent profiles then produces the cornrow pattern on sloping terrain.  The amplitude of the cornrows depends on the care and skill of the operator, and the particular procedures used in processing the DEM data, and the spacing, a few times the point spacing of the DEM, is twice the spacing of the scans.Previous attempts to remove cornrows from digital elevation data have generally relied on simple low pass filters [2,3] or discrete wavenumber filters [4], but these do not distinguish between cornrow artifacts and natural landscape features and are appropriate only if the artifactscompletely dominate natural features over a certain range of wavelengths.The localized filtering techniques described in this paper were originally developed, in a simplified form assuming a fixed cornrow wavelength, to remove or reduce in amplitude cornrows from USGS DEMs.  The techniques were refined and generalized in response to the need to deal with the artifacts present in DTED Level 1 DEM data for southwest Asia being used in the Southwest Asia Terrain Data Base [5] which has been developed by Lockheed Martin Information Systems for the Synthetic Theater of War (STOW) Advanced Concept Technology Demonstration, under contract from the Defense Advanced Research Projects Agency and the US Army Topographic Engineering Center.  While classic cornrow artifacts are present in parts of the dataset, other areas contain prominent artifacts of sometimes quite different character.  Often there are linear features with a consistent orientation, sometimes consisting of short broken ridge segments and sometimes consisting of long ridges or swells with very irregular spacing up to 20 or 30 times the DEM point spacing.  Sometimes arrays of “pits” or “pockmarks”, are associated with the long swells.  Much of the terrain in this data base has very little natural relief, so that the artifacts can dominate the relief over scales from the point spacing of the DTED data, about 90 meters, up to a few kilometers.  The artifacts can vary dramatically in wavelength, orientation, and degree of coherence, as well as amplitude, from one part of a given one degree by one degree DTED cell to another or from one cell to the next.  The amplitude of the artifacts, sometimes over 10 meters, is often large enough to seriously impact applications such as war game simulations.  The challenge is to remove as much of possible of the artificial features while doing minimal damage to what natural features are present in the data.  Also, since a large amount of data is involved, the procedures should be largely automatic and computationally efficient.The USGS and DTED DEM data consists of elevations on a rectangular lattice of points with uniform spacings in either Universal Transverse Mercator (UTM) coordinates or geographic coordinates (seconds of longitude and lattitude).  The data is organized in south-to-north profiles.  The cornrows and other linear features are usually oriented at least roughly perpendicular to these profiles, though in the southwest Asia DTED data the orientation is more commonly west-northwest to east-southeast than precisely west to east.  The data file for one one-degree by one-degree cell of the DTED data contains the elevations of about 1.4 million points, spaced by 3 seconds of arc, or about 90 meters, in longitude and lattitude.The basic assumption behind our procedures is that the “natural”  terrain is rather irregular, without coherent repeated linear features.  The analysis looks for a cornrow “signal”, which consists of locally enhanced power over a certain range of wavlengths and coherence at least over a limited spatial region.  To an extent which depends on the apparent strength of a coherent cornrow signal at each wavelength in comparison with the incoherent background “noise” of the natural terrain, the elevations are corrected to remove at least part of the cornrow signal.  The procedures are adjustable through a number of parameters which control how aggressive the cornrow removal is to be, the range of wavelengths to be examined, the distance over which coherence is tested, etc.  These parameters are normally set separately for each cell (i.e., quadrangle) of the DTED or DEM data based on an evaluation of the nature of the corn rows in that cell and the type of natural features to be protected.An outline of the basic procedure follows, on the assumption the corn rows are oriented roughly west-east.  The procedure is applied to each point in the quadrangle.  The elevations along several south-north profiles including and adjacent to the profile containing the point in question are convolved with a set of filter functions of the lags, the displacements along the profiles from the same north-south position as the point.  The filter functions are chosen to have Fourier spectra rather sharply peaked about a set of discrete wavelengths while still going smoothly (C1 continuous) to zero at a finite value of the lag.  The spacing of the wavelengths is chosen so that the set of filter functions constitute an approximate basis for the function space of the local variations in elevation along a profile.  For each wavelength there are “cosine” and “sine” filters which are even and odd functions of the lag, respectively, and the “amplitude” of the filter response is the square root of the sum of the squares of the responses to the cosine and sine filters, while the “phase” of the filter response is the inverse tangent of the ratio of the sine filter response to the cosine filter response.  The phase of the filter response for several profiles near the central profile containing the point is least-squares fitted to a linear function of (east-west) distance perpendicular to the profiles, with weights which depend on the amplitude of the filter response and the distance from the central profile.  The root-mean-square (rms) residual to this linear fit is used as a measure of the coherence of the corn-row signal.  If the residual is less than a certain threshold the cosine filter response at the point on the central profile being considered is assumed to be at least in part a corn row signal and depending on the magnitude of the residual a variable fraction of the cosine filter response is subtracted from the elevation of the point.  The residuals are calculated and the corrections made independently for each filter wavelength.  The minimal filter wavelength possible is the Nyquist wavelength of twice the point spacing along the profiles.  The maximum filter wavelength can be varied depending on the maximum wavelength of the cornrows present and computation time considerations.  The computation time increases roughly as the square of the maximum filter wavelength.A different way of imposing a coherence requirement has recently been suggested by Oimoen [6], who uses a one-dimensional low pass filter along rows of points parallel to the cornrows followed by a high pass filter along columns perpendicular to the cornrows to isolate the cornrow signal, which is then subtracted from the original data.  He shows this method can be effective for the fairly regular cornrows in USGS DEMs.Sometimes very irregular artifacts are present on small scales which are not amenable to detection by a coherence criterion, in which case it may be desirable to smooth over these small scale wavelengths.  The need for smoothing can be judged based on the amplitudes of the filter responses at wavelengths less than a certain smoothing wavelength compared with the ampitudes at somewhat larger wavelength.  When and where the amplitudes at the smaller wavelengths are excessive, height corrections based on the filter responses can be made to at least reduce the amplitude of the small scale artifacts.  Filtering along east-west profiles as well as along north-south profiles is necessary when the artifacts have no preferred orientation.  The locality of the filter analysis means the smoothing will take place only where it is appropriate.These procedures should not be viewed as making the terrain elevation data more accurate in an absolute sense, since experience shows that absolute errors in elevations when substantial corn row artifacts are present usually exceed any corn row signal.  However, corn rows can dominate local slopes, local drainage, and the visual appearence of rendering done from the elevation data when the natural relief is not large, and removing them can improve the relative accuracy of the data.The methods described in this paper have been implemented in a computer program titled "FilterUSGSDEM", which has been licensed to all U.S. government agencies and their contractors.  The program operates on DEM files which are in the USGS DEM format.2.	Filter FunctionsWe choose our filter functions to have a simple analytic form consistent with our goal of localization in both real space and Fourier space.  The localization in real space is absolute, for efficiency in doing the convolution integrals numerically, and approximate localization in Fourier space is achieved by taking cosine and sine functions with the desired wavelength and multiplying by envelope functions which go smoothly to zero over a number wavelengths.  Explicitly, the filter functions for one of a discrete set of wavelengths  EMBED Equation.2   as functions of the lag  EMBED Equation.2   are one even function of  EMBED Equation.2  , the “cosine” filter EMBED Equation.2  and one odd function of  EMBED Equation.2  , the “sine” filter EMBED Equation.2  ,where the envelope function  EMBED Equation.2   is characterized by two parameters, a half-width  EMBED Equation.2   and an edge width  EMBED Equation.2  , with  EMBED Equation.2  , such that EMBED Equation.2  .The normalization factor  EMBED Equation.2   is chosen to make EMBED Equation.2  ,which gives EMBED Equation.2  .Note that the envelope function is continuous and has a continuous first derivative. The Fourier spectra of the filter functions can be calculated analytically.  We get EMBED Equation.2  ,and  EMBED Equation.2   is the above expression times  EMBED Equation.2  .  Note that the above expression is perfectly regular at  EMBED Equation.2  .  The Fourier amplitudes fall off as  EMBED Equation.2   with oscillations about zero once  EMBED Equation.2   is larger than both  EMBED Equation.2   and  EMBED Equation.2  .  This suggests that the optimal choice for the ratio  EMBED Equation.2   is 2/3, as is borne out in numerical tests.If the filter wavelengths are chosen so that EMBED Equation.2  and  EMBED Equation.2   and  EMBED Equation.2   are both at least moderately large compared with one, then the entire set of filter functions satisfies to fairly good accuracy the completeness relation EMBED Equation.2  for any reasonably smooth function  EMBED Equation.2  .  In particular, when  EMBED Equation.2   the error in the completeness relation is less than 2.8% for all  EMBED Equation.2   and  EMBED Equation.2   when  EMBED Equation.2   and  EMBED Equation.2  , and less than 0.7% when  EMBED Equation.2   and  EMBED Equation.2  .In our application we must perform the convolution integrals numerically, using the trapezoidal rule, from evenly spaced values of the elevations along a profile.  This implies a minimum  EMBED Equation.2   equal to the Nyquist wavelength of twice the point spacing, and one would not expect accurate numerical results for the convolution integral until  EMBED Equation.2   is substantially larger than the Nyquist wavelength.  Actually, the errors are substantial only when the ratio of the difference of the filter wavelength and the Nyquist wavelength to the Nyquist wavelength is less than about  EMBED Equation.2  , and for the cosine filter convolution integral which is used directly in adjusting the heights the normalization of the filter function can be adjusted to compensate for the errors at least crudely right down to the Nyquist wavelength.  The phase information obtained from the sine filter convolution integral is inescapably lost near the Nyquist wavelength, since at the Nyquist wavelength the sine filter function is zero at the lags where the height elevations are available.  The results of applying the cosine filters to a cosine signal and the sine filters to a sine signal with integrations done numerically are plotted in  REF _Ref407509722 \* MERGEFORMAT Figure 1 for the case  EMBED Equation.2   and  EMBED Equation.2   and the lowest filter wavelength equal to the Nyquist wavelength. EMBED ExcelChart  Figure  SEQ Figure \* ARABIC 1.  Cosine and Sine Filters Acting on Cosine and Sine SignaThe larger w, the more closely spaced the  EMBED Equation.2  , and the more accurate the representation of  EMBED Equation.2   by a sum over filter functions.  However, the larger  EMBED Equation.2  , the larger the range of the convolution integrals, the greater the computational overhead, and the less effectively the filter functions are able to deal with localized patchy signals.  We have found that the choice  EMBED Equation.2   and  EMBED Equation.2   seems reasonably optimal, though the results are not highly sensitive to the precise values.Normally the lowest filter wavelength,  EMBED Equation.2  , should be taken equal to the Nyquist wavelength.  The maximum filter wavelength should be at least two or three steps above the last filter wavelength at which there is a significant cornrow signal, or at least about 30% larger for  EMBED Equation.2   and  EMBED Equation.2  , so that successive filter wavelengths increase by 13.4%.  Then the completeness relation should be reasonably well satisfied for the cornrow signals.3.	Detection and Removal of Artifacts3.1  Cornrow and Other Linear Artifacts of Arbitrary WavelengthThe details of how the information from the filter convolution integrals is used to detect and correct cornrows or more general linear features are presented here.  The convolution integrals are calculated at each point along several adjacent profiles for N+1 successive  EMBED Equation.2  ,  EMBED Equation.2   to  EMBED Equation.2  , covering the range of wavelengths required to catch the cornrow signal reasonably accurately.  An indication of the range of cornrow wavelengths can be obtained from visual inspection of shaded relief images of the terrain with enough vertical exaggeration to bring out the corn rows.  The convolution integral results are stored in memory so that they need to be done only once for each profile.  The number of profiles held in memory should be such that they span a distance from a central profile the order of the maximum filter wavelength to either side of a central profile.  Where heights are not available because the profile is completely outside the cell being processed, the filter response is set to zero, and when a convolution integral extends beyond the edge of the cell along a profile the elevations are assumed to be constant at the elevation of the last point in the cell.  While ideally real elevations from adjacent cells should be used to extend the convolution integrals, any systematic offsets in elevations from one cell to the next resulting in a ficticious boundary “cliff” should be dealt with first, since the corn row algorithms are not designed to remove cliffs effectively.Let the coordinate along the profiles be  EMBED Equation.2   and the coordinate perpendicular to the profiles be  EMBED Equation.2  , both in units of the respective point spacings.  Consider the calculation of a corn row correction at the point with coordinates  EMBED Equation.2  .  The coherence of a possible corn row signal is tested for each filter wavelength separately, using the amplitude (the square root of the sum of the squares of the cosine and sine convolution integrals) and the phase (the inverse tangent of the ratio of the sine convolution integral to the cosine convolution integral divided by  EMBED Equation.2  ) at  EMBED Equation.2   and 7 values of   EMBED Equation.2   centered at  EMBED Equation.2  , with an integer separation  EMBED Equation.2   which is set to approximate a certain fraction of the filter wavelength.  Larger values of   EMBED Equation.2   are appropriate when the cornrow ridges and troughs extend over distances several times their wavelength, but in some cases the corn rows come in short broken segments.  The default value of   EMBED Equation.2   in FilterUSGSDEM is 0.4 times the wavelength.  The value should not be less than about 0.2 times the wavelength for the coherence test to be meaningful.  The phases  EMBED Equation.2   of the filter responses at these 7 points is fit to a linear function of  EMBED Equation.2   by minimizing the residual EMBED Equation.2  with respect to the parameters  EMBED Equation.2   and  EMBED Equation.2  .  The weights  EMBED Equation.2   are the amplitudes of the filter responses, enhanced by a factor 2 for  EMBED Equation.2   and  EMBED Equation.2   and by a factor 1.5 for  EMBED Equation.2  .  Ideally, straight coherent cornrows without any irregular natural relief should have zero residual, so if the residual  EMBED Equation.2   is very small compared with one, the entire signal found by the cosine filter convolution integral at  EMBED Equation.2   should be subtracted from the height at  EMBED Equation.2  .  As the residual gets larger the raw height correction should be reduced.  If the residual is large enough to indicate little phase coherence, no height correction should be made.  We set this final cutoff to be when  EMBED Equation.2  .  For smaller  EMBED Equation.2   we divide the raw height correction by  the rather ad hoc quantity  EMBED Equation.2  , where  EMBED Equation.2    is 256 times  EMBED Equation.2   times a “relief protection parameter”.  The height correction becomes small very quickly as  EMBED Equation.2   becomes larger than one.  The relief protection parameter can be adjusted depending on how aggressive one wants to be in removing cornrows at the risk of smoothing off natural hills or ridges.A defect of the basic procedure above is that the phase residual can sometimes be very small just because one or two of the weights  EMBED Equation.2   are much larger than the others.  Therefore, we also calculate the quantity  EMBED Equation.2   which appears in the formula for  EMBED Equation.2  , the angle brackets indicating averages using the same weights  EMBED Equation.2  .  If this quantity is less than 1.9 the quantity  EMBED Equation.2   is increased from its nominal value, decreasing the height correction, and if this quantity is less than 0.9 no height correction is made.3.2	Cornrow Artifacts of Known WavelengthThe procedure of Section 3.1 works well when the amplitude of the artifacts exceeds or is comparable to amplitude of the natural relief present and does not require any but the crudest previous knowledge of the cornrow wavelengths.  However, there are problems  in mountainous terrain where the amplitude of natural relief is substantially larger than the cornrow amplitude.  Then the coherence criterion may not be satisfied even when substantial cornrows are present, and/or natural mountain ridges oriented roughly perpendicular to the filter profiles may come close enough to satisfying the coherence criterion for some wavelengths that they will be rounded off significantly.   When the cornrows do have a single predominant wavelength, that information can be used in an alternative procedure in which the cornrow removal is predicated on the amplitude of the filter signal right at the cornrow wavelength exceeding the average of the amplitudes of the filter signals at the two neighboring wavelengths scaled up and down by the factor of Equation (x.x).  This alternative may be useful in dealing with USGS DEMs, but is irrelevent for the southwest Asia dataset.3.3	SmoothingIn some of the cells of the southwest Asia dataset small scale features were present, such as pits and very small ridge segments, which were clearly artificial, because they were associated with longer wavelength corn rows, but did not have enough linear coherence in themselves to satisfy the corn row criteria of the last section.  When these features dominate the small scale relief, it seems desirable to eliminate them by smoothing.  The filtering analysis of Section 2 is used, though it may be necessary to filter along west-east profiles as well as along south-north profiles when the features have no definite orientation.  The amplitude of these features can be patchy, and we do not want to smooth when there is substantial natural relief present.  A smoothing distance is specified which is the maximum wavelength at which full smoothing, reducing the height by the full amount of the cosine convolution integral at a filter wavelength, can occur.  Ideally the artificial features will contribute strongly to the filter response only for wavelengths less than the smoothing distance.  As a criterion for when there is too much natural relief on small scales to justify smoothing, we compare the mean square amplitude of the filter response at the point being considered for wavelengths between 1 and 1.5 times the smoothing distance to a pre-set “smoothing threshold”.  The smoothing correction as a fraction of the cosine filter convolution result at these and smaller wavelengths is reduced as the filter response over this larger range of scales exceeds the smoothing threshold.  The smoothing corrections are tapered to zero as the filter wavelength increases from 1 to 1.5 times the smoothing distance.   The larger of the reduced smoothing height correction and the cornrow height correction at each wavelength less than 1.5 times the smoothing distance is applied to modify the height of the point in question.  This procedure is a real kludge, but it does seem to be moderately effective when appropriate parameters are used, based on inspection of the quadrangle before processing and some trial and error experimentation.3.4	Pit FillingThe pit artifacts present in the some of the southwest Asia DTEDs are difficult to deal with just by smoothing.  The pits come in arrays oriented along the usually irregular cornrows, whose wavelengths are usually at least somewhat larger than the diameter of the pits.  The pits are small, with each depression often containing  only a few data points, and can be quite deep, 10 or 15 meters even when the overall landscape is very smooth.  Of course, there can be natural sinkholes which in a desert climate will not be filled in by sediment or water,  but these are usually somewhat larger and do not appear in quasi-regular arrays.  Therefore, an option in the FilterUSGSDEM program is to fill in at  least the smaller pits.  This is done in a separate pass through the dataset before undertaking the corn row and smoothing filtering, since the pits would otherwise tend to obscure the weaker corn rows and are more susceptible to smoothing after the amplitude of the small scale relief has been reduced by the filling.  A “pit range” is specified, usually just a few times the point spacing.  A local depression which lies within the pit range radius from a point in the landscape and contains less than a certain number of points is levelled out to the height of the lowest point on the rim of the pit.3.5	Lake ProtectionLakes and to a considerable extent rivers have perfectly level surfaces, and the elevation corrections associated with cornrow or other artifact removal should not disturb this property in the DEM data.  On the other hand, due to the finite height resolution of the DEM there are likely to be adjacent points with exactly the same height on land surfaces even when these are not extremely flat.  The simple procedure of preserving elevations of points with some adjacent points of exactly the same height can result in new artifacts being produced as small clumps of points with identical heights are left behind as the surrounding terrain is lowered or raised as the result of removing cornrows whose wavelength is large compared with the size of the clump.  While feature data could be used to identify the flat regions which are true lakes or rivers, this may be absent or inaccurate.  Therefore, as the profiles are being filtered for cornrows, we keep track of contiguous regions which have the same elevation, using a tree structure to follow  “mergers” as initially disjoint regions become connected.  Such a potential “lake” is treated as one, and the heights of points belonging to it preserved, if the number of points it contains exceeds a certain continuously adjusted minimum value tied to the the largest wavelength at which there is locally a substantial cornrow amplitude.  The height corrections are smoothly reduced from their normal values as the number of points approaches the number for total protection.4.	Application and EvaluationThe application of the above algorithms is not entirely automatic.  Several parameters must be adjusted to balance the conflicting objectives of the removal of artifacts as completely as possible versus not over-smoothing natural hills and ridges.  Also, some of the special procedures such as smoothing and pit-filling should not be used in all circumstances, only when the nature of the artifacts is such that these procedures will favorably influence the final result.  Viewing various 3-d or 2-d representations of the landscape, either shaded relief images with sun angles and viewpoints chosen to maximize the contrast of the artifacts or color-coded maps of elevations, can reveal what artifacts are present, the appropriate range of wavelengths needed to capture the artifacts, and suggest the best strategies for applying the tools discussed above.  The pattern recognition abilities of the human eye are remarkable and difficult to match with canned algorithms.  Fine tuning can be done by examining the heights of individual points in certain small patches and how they change under filtering, particularly when it comes to verifying that certain key natural features are not modified excessively.What we focus on here is a statistical measure of the presence of artifacts, the “variance” defined as EMBED Equation.2  .The average is done over the central positions  EMBED Equation.2   for a fixed displacement  EMBED Equation.2   which is either in the west-east direction, giving the east-west variance, or in the south-north direction, giving the north-south variance, both of which can be plotted as functions of the lag distance  EMBED Equation.2  , the magnitude of the vector displacement.  Usually the average is calculated over 1/9 of a one-degree by one-degree quadrangle.  A strong indication of the presence of linear structures or cornrows oriented roughly west-east is when the north-south variance is substantially larger than the east-west variance for some values of  EMBED Equation.2  . This is particularly striking in  REF _Ref407510377 \* MERGEFORMAT Figure 2, which plots the north-south variance for the southwestern corner of the cell of the southwest Asia database at 47 degrees east longitude and lattitude 30 degrees north.  This region is dominated by fairly regular west-to-east cornrows with an average wavelength a little less than 3 times the point spacing, a crest to trough range of about 6 to 8 meters, and very little relief otherwise. EMBED ExcelChart  Figure  SEQ Figure \* ARABIC 2.  N-S Variance for Section 00 of E047N30The variance for the original data has peaks when the lag  EMBED Equation.2   is a half-integral number of wavelengths, so when  EMBED Equation.2   is at a trough of the cornrow oscillations,  EMBED Equation.2   and  EMBED Equation.2   are at crests and vice versa, and minima when the lag  EMBED Equation.2   is an integral number of wavelengths, so all three points are at the same phase of the cornrow oscillation.  For  EMBED Equation.2   equal to 1 or 2 point spacings the north-south variance is about 5 times the east-west variance.  Applying only the standard cornrow filtering to the data brings the north-south variance down to about 30% larger than the east-west variance and the oscillations as a function of  EMBED Equation.2   are gone, indicating that the filtering has been very effective in almost totally eliminating the cornrows.  This is confirmed when 3-d images of the vertically exaggerated terrain are examined.  The east-west variance is almost unaffected by the filtering.  Adding smoothing to the filtering has a relatively minor effect, since the filtering is so efficient by itself.  The same filtering parameters which are very effective in eliminating the corn rows leave the one prominent natural feature in the entire cell, a hill in the south-central part of the cell, largely unaffected.  The height changes on the hill, which is about 140 meters high, are everywhere less than 3 meters and almost everywhere less than about 2 meters.The east central part of the same cell has only short broken segments of cornrow ridges oriented roughly west-northwest to east-southeast.  The north-south variances are displayed in  REF _Ref407510509 \* MERGEFORMAT Figure 3.  The original east-west variance when  EMBED Equation.2   equals the point spacing is about 20.  Here filtering by itself has some effect, but is limited by the lack of cornrow coherence, even though the coherence requirements as controlled by the relief protection parameter have been reduced somewhat.  Adding smoothing largely equalizes the north-south and east-west variances, but the residual level is higher than the previous case.  The real terrain, in the delta of the Tigris-Euphrates river system, is almost certainly extremely flat in both cases. EMBED ExcelChart  Figure  SEQ Figure \* ARABIC 3.  N-S Variance for Section 21 of E047N30Finally, the variances for the west-central region of the cell at 47 degrees east longitude and 28 degrees north lattitude are displayed in Figure 4.  Here again there are almost no features not associated with artifacts.  There are rather long wavelength irregularly spaced cornrows with a west-northwest to east-southeast orientation and arrays of pits with widths of a few point spacings associated with them.  The filtering is done with very small relief protection parameter, so the coherence requirements are not very strict.  The cornrows are removed quite effectively, but residual evidence of the pits remains in the bump in the variance plot at small values of  EMBED Equation.2  .  Adding smoothing largely removes this bump, but has little effect on larger scales.  Using pit filling along with filtering and smoothing removes almost all the artifacts.  EMBED ExcelChart  Figure  SEQ Figure \* ARABIC 4.  N-S Variance for Section 01 of E047N285.	ConclusionThe techniques described in the paper were applied to the Southwest Asia Terrain Data Set, and in regions without a great deal of natural relief were quite effective in removing most of the artifacts without disturbing unduly the relatively minor or isolated natural features.  In other parts of the data set, such as the Zagros mountains in southwestern Iran, where cornrows, while present in many areas, are rather irregular and dominated by natural height variations, these techniques are less successful, though cornrows in the flatter portions could still be largely eliminated.  The filtering techniques are also not successful in dealing with elevation offsets between different regions.A certain amount of expertise and experimentation is necessary to analyze the data for artifacts and to set the filtering parameters in an optimum way, but this expertise can be developed fairly quickly given appropriate visualization tools.  About 1/2 of the 35 cells of the Southwest Asia Data Set were processed in a single weekend by a group of several people, most of whom had no previous experience with the FilterUSGSDEM program.  Still, it would be desirable to make the program smarter about choosing a filtering strategy based on the type of signal it finds locally.The authors would like to thank Tim Miller of Lockheed Martin, whose expertise in the geomorphology of southwest Asia and assistance in putting the datasets into the proper format for processing was invaluable.  One of us (JMB) would like to acknowledge helpful conversations on the nature of cornrows with Ralph Haugerud of the USGS and Dave Montgomery of the University of Washington.6. References[1]	E. B. Bronson and R. W. Olsen: "Data Digital Elevation Model Systems" Proceedings of the Digital Terrain Models Symposium, ASP, St. Louis 1978.[2]	D. G. Brown and T. J. Bara: "Recognition of Reduction of Systematic Error in Elevation and Derivative Surfaces from 7.5-Minute DEMs" Photogrammetric Engineering and Remote Sensing, Vol. 60, pp. 189-194, February 1994.[3]	J. Garbrecht and P. Starks: "Note on the Use of USGS Level 1 7.5-Minute DEM Coverages for Landscape Drainage Analyses" Photogrammetric Engineering and Remote Sensing, Vol. 61, pp. 519-522, May 1995.[4]	J. J. Pan: "Spectral Analysis and Filtering Techniques in Digital Spatial Data Processing" Photogrammetric Engineering and Remote Sensing, Vol. 55, pp. 1203-1207, August 1989.[5]	Southwest Asia Terrain Data Base Design Document Synthetic Theatre of War.[6]	M. J. Oimoen: "An Effective Filter for Removal of Production Artifacts in USGS 7.5-minute DEMs", available in preliminary form at the following: edcwww.cr.usgs.gov/pub/edcuser/oimoen/.Author BiographiesJAMES M. BARDEEN is Professor of Physics at the University of Washington.  Mainly known for research in relativistic astrophysics and cosmology, he has cultivated a side interest in computer modeling of fractal and real landscapes.