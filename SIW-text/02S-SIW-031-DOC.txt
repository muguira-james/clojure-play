Using Multiple Representations and Resolutions to Compose Simulated METOC EnvironmentsRobert A. Reynolds, Haig Iskenderian, Steve O. OuztsNorthrop Grumman Information Technology, TASCReading, MA HYPERLINK mailto:rareynolds@tasc.com rareynolds@tasc.comKeywords:environment, SNE, ocean, atmosphere, HLA, simulation, OASES, TAOS, composable, resolution, representationABSTRACT:  In GFY'01, the DMSO-sponsored Environment Federation project, leveraging on the previous year's efforts, expanded an entity-level simulation set in the Camp Pendleton area to include shallow water mine hunting, aircraft carrier operations and chemical warfare.  As a result, several additional requirements were levied on the OASES system for providing atmospheric and oceanic state to the JSAF-based Federation.  To provide full coverage of the larger 200km by 100km playbox while maintaining high spatial-resolution over the area where chemical transport and diffusion were being modeled, a three-level nested atmospheric grid was required.  To support a near-shore water column environment for the mine hunting operations required the curvilinear representation used by HydroQual's Estuarian Coastal Ocean Model.  This paper describes the challenges associated with composing these complex METOC environments using the OASES system.  Modifications made to the OASES architecture to support multiple resolutions and representations across all of its subsystems (Ingestor, Transformer, Visualizer, Editor and Publisher) are discussed.  Also described are associated changes made to the OASES internal object model and the external Simulation Object Model (SOM) that defines the interface between OASES and the HLA Federation that it serves.IntroductionThe OASES system [1], an evolution of TAOS [2], is a suite of applications for constructing, extending and tailoring METOC run-time databases, and for publishing METOC state to an HLA Federation.   OASES does not itself model atmosphere and ocean physics – it looks to authoritative, validated, external models for the datasets that encapsulate correctly-correlated, four-dimensional METOC environments.  OASES models the datasets output by these models.  This paper describes this modeling and how new requirements imposed by the GFY’01Environment Federation (EnviroFed) project have led to signifiant extensions to  OASES.  These extensions  result in the capability to create and distribute considerably more complex METOC environments than was previously possible.Regime, Representation, ResolutionThe primary characteristics of an external model and its output data that are considered in this paper are regime, representation and  resolution.  OASES defines four environmental regimes: atmosphere, ocean surface, ocean volume and space.   Atmospheric models that OASES has been used with include NOGAPS, NORAPS, COAMPS, MM5 and OMEGA.  Ocean surface (wave) models include WAM, RWAM, STWAVE and NSSM.  Ocean volume (circulation) models include TOPS, OTIS and ECOM.Representation in this context refers to the way that a given model expresses the spatial and temporal variation of its output state variables.  All of the models that have been used with OASES represent temporal variation in terms of an evenly-spaced sequence of date/time values, and the real discriminator is the spatial representation.  The most common spatial representation is a rectangular grid of data values, in some convenient coordinate system.  An alternative spatial representation, used by the ECOM model [4], is that of a curvilinear grid.  The most exotic spatial representation is that of the OMEGA model: an unstructured triangular mesh that allows for arbitrary horizontal and vertical placement of mesh vertices and which also supports temporal variation of the mesh.  Figure 1 illustrates the gridded, curvilinear and triangular mesh representations.Figure 1:  Spatial Representations: a) Rectangular Grid, b) Curvilinear Grid, c) Triangular Mesh.Resolution in this context refers specifically to the data spacing of models that output a gridded representation.  It is of interest primarily for models that employ a nested gridded representation such as that illustrated in Figure 2.  In fact, most atmospheric models do use a nested grid representation.Figure 2:  Nested Grid RepresentationData, Object and System ModelsThe structure of environment model output data has influenced the design of OASES at three levels.  The design of the internal object model is  strongly driven by the structure of the input data because the intent is to preserve the fidelity (resolution, precision, geospatial referencing) of this input data.  The OASES object model preserves the input data content while augmenting this data with methods to facilitate persistence and run-time accessibility.  The design of the OASES Simulation Object Model (SOM) should be influenced primarily by the data requirements of the client Federates and their effects models, however our experience is that the capability to deliver METOC data has generally been in place before capabilities to consume this data have been developed.  Hence, the design of the SOM for METOC data has been significantly influenced by the structure and content of the data available versus what a client Federate might require or desire.The third level of OASES design influenced by external model data characteristics is the system level and its Concept of Operations (CONOPS).  As discussed more completely in Sections 4 and 5, the major issue here is decid ing what environmental data transformations and modifications are acceptable to apply in order to support extension, tailoring and visualization.Pre-GFY’01 METOC Environments The requirements placed on OASES for composing run-time METOC environments prior to EnviroFed’01, and how the OASES data models have supported these requirements, is the subject of this section.Prior to GFY’01 the external model output data available to OASES, and the run-time METOC environments required of it, could be characterized as follows.    One model per regime – a single external model is used to supply the environmental state data for a given regime.  As a result, a given state variable is always associated with a single representation.Primarily gridded representations – while OASES has maintained the ability to “dumb down” a gridded representation to support uniform (i.e., spatially invariant) client atmosphere and ocean models, OASES run-time databases have, with few exceptions, included data only on rectangular grids.One resolution per regime – if an external model provided data on more that one nested grid, then the  requirements of the Federation could be met by publishing data over a single nest.  As a result, a given gridded state variable is always associated with a single resolution.These data availability and run-time requirements led to the development of the OASES models described below.  In Section 5 these models will be compared to the models that are the result of the GFY’01 extensions.Internal Object ModelThe relevant portion of the internal object model that supports the requirements described above is shown in Figure 3.Figure 3:  Pre-GFY’01 Internal Object ModelThe central abstraction is the Field class, which manages the common temporal representation for all specialized field types.  Derived classes support varied spatial representations.Simulation Object ModelThe SOM which has supported the publication of primarily gridded objects for both the atmosphere and ocean regimes is shown (at the class level) in Figure 4.  The class hierarchy is designed to factor the dependent data for a gridded field into a base class with derived classes providing the attributes which are needed to geospatially locate the dependent data.  This aspect of the SOM design facilitates extensions of the SOM to accommodate multiple coordinate systems for gridded objects.Figure 4:  Pre-GFY’01 Simulation Object ModelSystem Model and CONOPSThe OASES system model that has met the requirements prior to those imposed by the GFY’02 EnviroFed project is illustrated in Figure 5.  The important features of this model are that all input data is represented on single-resolution grids and that the Ingestor converts all input data to the Geodetic coordinate system.  The significant advantage to working with data in a single representation and on a common coordinate system is that the development of the OASES subsystems dedicated to extending (Transformer), tailoring (Editor) and visualizing (Visualizer) METOC data is greatly simplified.  Efficient algorithms for working with uniformly-spaced gridded data abound and are readily encapsulated in the GriddedField class where they can be shared by all subsystems.  Geodetic coordinates do not have the problems with discontinuities and distortion that coordinates based on map projections such as UTM and Lambert Conformal do, and they are natural to geospatially locating environmental data.Figure 5:  Pre-GFY’01 System ModelEnviroFed-01 METOC EnvironmentSeveral new requirements were levied on the OASES system for providing atmosphere and ocean state to the GFY’01 Environment Federation.  To provide full coverage of the larger 200km by 100km playbox while maintaining high spatial-resolution over the area where chemical transport and diffusion were being modeled, a three-level nested atmospheric grid was required.  To support a near-shore water column environment for the mine hunting operations required the curvilinear representation used by HydroQual's Estuarian Coastal Ocean Model.  Regional Wave Action Model (RWAM) data was to be used to provide a gridded ocean surface representation for use in deep water.  These grids are illustrated in Figure 6.  In parallel OASES was being extended under DTRA funding to support use of the OMEGA model, with its triangular mesh representation, for the simulated atmospheric environment.Given these new requirements, the OASES object, data and system models needed to be extended.  The subsections below describe the extensions made to each type of model in order to support the expanded requirement set.  The sections below describe these extensions and the relative difficulty of developing them.Extended Internal Object ModelFigure 7 illustrates the OASES internal object model extended to support multiple representations and multiple gridded data resolutions.  Note that now a Grid object is a specialized Mesh, as are Curvilinear Grids and Triangular Meshes.  The Curvilinear and Triangular Field classes are natural extensions of the Field abstraction, providing two new spatial representations joined with a common temporal representation and public interface.  The extension of the internal object model was straightforward.  Figure 6:  METOC Grids for GFY’01 Pendleton ScenarioExtended Simulation Object ModelFigure 8 illustrates the OASES SOM extended to support publication of multiple representations and resolutions.  The extensions are the three classes indicated with a heavy outline: Water_Column_Curvilinear, Tide_Level_ Curvilinear, and Wave_Spectrum_Curvilinear. Figure 7:  GFY’01 Internal Object ModelHere too the extension was natural, with the new classes providing geospatial locating data via a curvilinear grid.  While it was decided to publish triangular meshes from the OMEGA model as a collection of vertical profiles, it would be straightforward to extend the SOM to directly support triangular meshes.Figure 8:  GFY’01 Simulation Object ModelExtended System Model and CONOPSFigure 9 illustrates the system model that supports the full set of extended requirements associated with multiple representations and resolutions.  All subsystems must now be “multi-representation and multi-resolution aware”.  This turned out to require considerably more  development work than anticipated!  While the Ingestor only required simplification by removing the functions that supported coordinate conversions, the Transformer became more complex due to its expanded duties with respect to supporting both coordinate transforms and representation transforms (the latter is still under development.)  Figure 9 indicates the current capabilities of each subsystem with respect to providing support for multiple representations and resolutions.ConclusionThe EnviroFed-01 requirements for a multi-resolution gridded atmosphere and a curvilinear shallow water environment suggest that the modeling and simulation community is moving towards more complex simulated natural environments, which is encouraging.  Multi-resolution environments have been the subject of study by the JSIMS Advanced Simulation Technology Thrust and a multi-resolution environment is required per the OneSAF Operational and Technical Requirements Documents (ORD/TRD).  Hence, the extensions required of OASES in GFY’01 are the “right” ones.  The fact that the internal object model and the SOM were easily extended while the system model was not is interesting and was the primary “lesson learned” for the OASES development team.  Clearly the new system model is superior, with the Ingestor now responsible only for format conversion and the Transformer responsible for all types of data transformation.  But why has it taken seven years of development to arrive at this model?  One conjecture, based on the observation that the internal model and the SOM are both object models, while the system model is not, is that object-oriented design methodologies and/or experience are needed at the system level for systems comprised of multiple, interacting component applications.Figure 9:  GFY’01 System ModelReferences[1]	R. A. Reynolds, et. al., “The Ocean, Atmosphere and Space Environmental Services (OASES) System”, Paper 01S-SIW-047, Proceedings of the Spring 2001 Simulation Interoperability Workshop, March 2001[2]	D. A. Whitney: “TAOS: Dynamic METOC Environmental Simulation Services”, TASC Technical Report TR-07601-10, Final Technical Report to the STOW-97 program, 30 January 1998[3]	R. A. Reynolds, et. al., “TAOS in Space”, Paper 99S-SIW-101, Proceedings of the Spring 1999 Simulation Interoperability Workshop, March 1999[4]	ECOM referenceAuthor BiographiesROBERT A. REYNOLDS is a Principal Member of the Technical Staff at TASC and has been the system architect and lead developer for TAOS through the STOW-97/98 program, the PSM+ program, and the ongoing EnviroFed project.  His primary professional interests remain focused in the areas of software engineering, object-oriented modeling, visualization, distributed simulation and synthetic environments.  He has a BS degree in Physics from the Massachusetts Institute of Technology and an MS degree in Nuclear Engineering from Carnegie-Mellon University.HAIG ISKENDERIAN is a Senior Member of the Technical Staff at TASC.  He has been involved in the generation of synthetic environments for Envirofed II.  His professional interests are in atmospheric modeling and applied meteorology.  He received a B.S and M.S. in Atmospheric Science from the State University of New York at Albany, and he received a Ph.D. in Atmospheric Science in 1995 from the same institution. STEVE O. OUZTS is Program Manager, Applied Sciences, TASC, Reading MA, and has been the program manger on numerous modeling and simulation programs since joining TASC in 1996.  He has led the TAOS development effort since 1999 and the EnviroFed I, II and on-going III projects.  He also led the DARPA ASTT sponsored development of JETS (now being transitioned into OASES as the ETS).  He is a retired colonel from the United States Air Force with 27 years experience in meteorology, systems acquisition, intelligence applications, and modeling and simulation of atmospheric effects.  He has a BS degree in Mathematics from Auburn University, an MS degree in Atmospheric Dynamics from the Navel Post Graduate School and an MBA from the University of Nebraska in addition to numerous military courses in systems acquisition and program management.  METOC: METeorological and OCeanographic. While OASES has been used to model the space environment [3], the focus of this paper is the atmosphere and ocean. OASES defines an environmental state variable to be a regime-dependent physical quantity that defines one attribute of the total state of that regime (e.g., air temperature and pressure for the atmospheric regime, or wave height, period and direction for the ocean surface regime.PAGE  PAGE  1PAGE  PAGE  2