TAOS in SpaceRobert A. ReynoldsTASCReading, MA HYPERLINK mailto:rareynolds@tasc.com rareynolds@tasc.comNori M. ShoharaSAICTorrance, CA HYPERLINK mailto:nori.m.shohara@cpmx.saic.com nori.m.shohara@cpmx.saic.comKeywords:Synthetic Environment, SNE, environment, space, ionosphere, models, ionosphere, GPS, scintillation, visualizationABSTRACT: The Total Atmospheric and Oceanographic System (TAOS), developed under DARPA's Synthetic Theater of War (STOW) program as a suite of software tools for the creation and management of realistic, correlated 4D Synthetic Natural Environments (SNEs), has been enhanced under the sponsorship of the Space Warfare Center (SWC) and USSPACECOM to support modeling of the space environment.  To highlight this significant step forward in environmental modeling capabilities for distributed simulation, the acronym TAOS will henceforth be expanded to the Total Atmospheric, Oceanographic and Space system.  This paper overviews the technical issues associated with the integration of two publicdomain spaceregime models: the Parameterized Ionospheric Model (PIM) and the WideBand Model (WBMOD) of the ionospheric scintillation phenomena, as well as the Mesoscale Model 5 (MM5) numerical weather prediction program, run operationally out of the Air Force Weather Agency (AFWA), for modeling terrestrial weather affects on spacebased systems.  The paper describes a number of significant enhancements made to the TAOS system to support spaceregime modeling, including architectural improvements made to the TAOS Integrator to support internal models such as PIM and WBMOD, the development of a query/response protocol and an associated TAOS Client API for querying the environment (space and/or terrestrial), and support for environmental effect models that can be executed at runtime on a perquery basis.  Visualization of the 4D space weather environment is also provided by the enhanced TAOS system.IntroductionThe Total Atmospheric and Oceanographic System, a simulator of the natural atmospheric and oceanographic environment developed by TASC for the Synthetic Environments component of the STOW-97 program, has recently been extended to model the near-space environment under the sponsorship of SPACECOM and the Space Warfare Center (SWC).  This paper describes the space-environment features and effects that have been modeled in TAOS to date, motivating a revised expansion of the TAOS acronym to: Total Atmospheric, Oceanographic and Space (TAOS) System.  For additional descriptions of the TAOS system, see [1], [2].Space Environmental Effects on Military Systems	With the 11 year solar cycle peaking over the next 2-3 years, bringing with it more frequent and increasingly violent geomagnetic storms and ionospheric disturbances, the impacts of the near-space environment on increasingly complex space-based military systems will receive a great deal of scrutiny.  One important way in which awareness and preparedness can be increased is through simulation and large-scale training exercises based on simulation.  The SWC has funded concurrent, complementary developments of space-regime simulators at TASC, SAIC and JNTF in order to provide a first-generation capability for modeling environmental impacts on space-based military systems.  These developments focus on two distinct operational satellite-based systems: the Global Positioning System (GPS) for providing high-precision navigation data to terrestrial vehicles and infantry equipped with GPS receivers, and the Early Warning System for detecting Theater Ballistic Missile (TBM) launches from Space-Based InfraRed Satellites (SBIRS).  The modeling and software development associated with the “Navigation function” (GPS) has been worked in a collaborative effort between SAIC and TASC and was first exercised at the 1998 Expeditionary Forces Experiment (EFX-98) this past September.  The modeling and software development associated with the “Warning function” is a more recent effort and is planned to be included in the EFX-99 exercise, currently planned for late July, where enhanced Navigation functions (described below) will also be components of the total simulation.NavigationThe environmental features that affect the GPS system and which are now modeled by TAOS include free-electron density distributions in the ionosphere and a phenomenon known as scintillation. These features and the effects they produce on the GPS system are described below.Electron Density and Total Electron CountWhen a GPS signal travelling between a satellite and a terrestrial receiver encounters free electrons such as exist in great numbers in the ionosphere, the signal experiences a phase delay.  This delay, when propagated through the receiver electronics and associated navigation algorithms, results in a position error.  As any given receiver requires that at least four satellites be visible, and each line-of-sight (LOS) between receiver and transmitter encounters different electron distributions due to the highly irregular structure of free electrons in the ionosphere, the resultant total position error is a complex function of the transmitter and receiver geometries (LOSs) and the time of day.  Figure 2.1 is a visualization of ionospheric electron density, rendered as a color-mapped spherical slice at an altitude of 350 km above the ellipsoid, where free electron density typically peaks.  The six frames shown are spaced 4 hours apart and illustrate the diurnal variations of the ionosphere.The model employed by TAOS for generating scientifically correct 3D electron distributions is the public domain Parameterized Ionospheric Model (PIM), Version 1.7 [3].  While this model directly computes 3D electron density for a single day-of-year and time-of-day, enhancements to the TAOS Integrator described in this paper provide for the automatic sequencing of PIM model executions over a user-specified interval of time and timestep.The input to the navigation error calculation is a single parameter known as Total Electron Count (TEC), defined as the line-integral of electron density along the LOS between transmitter and receiver, in units of electrons-per-square-centimeter, and normalized by a factor of 10-12.  While the PIM model will calculate TEC for a given LOS, computing TEC for all possible LOSs and times-of-day quickly becomes intractable due to the size of the resulting database and the difficulties associated with reducing the input parameter space.  The approach taken by TAOS has been to compute TEC on-demand in real-time, which presents its own challenges as detailed later in this paper.ScintillationA complex, poorly-understood phenomenon known as ionospheric scintillation, resulting from turbulence in the ionosphere at an altitude of approximately 350km, causes random phase and amplitude variations in GPS signals.  If the amplitude or phase variations are large enough, the GPS receiver can lose lock on the signal.  The phenomenon is especially prevalent near sunset at equatorial latitudes.  While a GPS receiver can be susceptible to either or both of amplitude and phase scintillation, the current modeling effort focuses on amplitude-sensitive receivers, and the parameter used to express the effect of scintillation on the received signal is fade depth, measured in dB of amplitude loss.  Figure 2.2 provides a visualization of scintillation-induced fade depth for a GPS transmitter frequency of 1575 MHz in the equatorial region, at intervals of 2 hours.  The pair of elliptical “blobs” are areas of maximum fade depth, where the GPS signal is unreceivable.The model used to compute fade depth for a given transmitter frequency, LOS, day-of-year and time-of-day is the Wide-Band MODel (WBMOD, V13) of ionospheric scintillation [4].  This model, based on measured scintillation levels and climatological in nature, combines an ionospheric feature model and a signal-attenuation effect model, and as a result poses an integration challenge for TAOS, which is designed to model environmental features primarily in the form of gridded fields stored in a database, leaving effects to be computed from this 4D state at run-time either by the TAOS Query Server or by the client simulators.  The initial integration approach selected uses the TAOS Integrator to stage executions of WBMOD over an input parameter space consisting of receiver location (with altitude fixed at 0.0) and time-of-day, and with the transmitter always located directly above the receiver at a fixed altitude above the turbulent zone of the ionosphere.  The resultant database (a portion of which is visualized in Figure 2.2), is then used at run-time in the manner illustrated in Figure 2.3: for a given LOS the “pierce-point” lat/lon is computed at the turbulent layer and then used to look-up the scintillation effect (fade depth) assuming a vertical LOS at the pierce-point lat/lon.WarningThe environmental features affecting the Warning function are atmospheric water vapor, cloud water and cloud ice distributions; atmospheric water is the primary absorber of the IR radiation generated by a rocket plume.  Furthermore, although water vapor along the LOS is an important contributor to signal attenuation, the IR signal of a rocket plume is completely scattered by as little as 1 meter of cloud water and the current effort is focused specifically on modeling cloud water effects on the Warning function.Cloud modeling and algorithm development for the Warning function is an ongoing effort, and the details of the technical approach are still under development.  However, the basic approach will be to select a 14-day interval of tactically significant weather (clouds) from recent MM5 operational forecast model runs made at AFWA.  Using an MM5 Receiver developed for TAOS under this effort, an atmosphere/space database will be constructed for EFX-99 that will include gridded cloud fraction, cloud base and cloud top over the exercise area.  The client to the cloud data will be JNTF’s Portable Space Model (PSM).  This legacy model currently simulates TBM launches and SBIR-based responses (warnings) based on a very simple internal model: when the missile reaches a certain, fixed altitude, it is 100% detectable, while below this altitude it is undetectable.  Including a model of 4D cloud fields at even a coarse resolution will greatly increase the realism of PSMs Warning function and its value as a training simulation.System Architecture for NavigationIn a computer-aided military exercise, much or all of the battle is “fought” between simulated entities. Among the factors that determine the bomb damage that occurs when a simulated munition is expended against a simulated target is the accuracy of the munition or its “miss distance.” That is to say, the damage is inversely proportional to the distance between the target and the actual impact or detonation point of the munition. In the case of GPS-guided weapon systems such as cruise missiles, a major source of location error (the difference between the aim point and the impact point) is the performance of the GPS navigation subsystem incorporated into the weapon system. The characteristics of the space environment that affect the performance of GPS, TEC and scintillation, therefore indirectly affect the outcome of a simulated battle by influencing the accuracy of GPS and hence the ability to successfully execute precision strike missions against fixed targets. The combination of TAOS with the GPS Performance Model allow these affects to be incorporated into computer-aided exercises using existing simulation protocols, DIS, or via a custom interface with JCAS (Joint C2 Attack Simulation), the Air Force-standard simulation for modeling attacks against fixed command and control targets. The architecture for this system is illustrated in Figure 3.1.  Consistent with its role in simulating the 4D state of the atmosphere and ocean, the TAOS subsystem is responsible for simulating the 4D space weather environment.  The primary client to TAOS is the SAIC-developed GPS Performance Model that computes various GPS performance factors at a point and time.  Performance factors include such items as GDOP (Geometric Dilution of Precision) and CEP (Circular Error Probable), among many others. A simulation operator controls the configuration of the GPS Performance Model and can selectively enable or disable the various interfaces. The GPS Performance Model receives either a Detonate PDU directly from a DIS entity or it receives an aim point from JCAS. Given a point in space and time, the model then determines the geometry of the location relative to the satellites in the GPS constellation that are above the local horizon. For each line of sight, TAOS is queried and the TEC and scintillation are returned. Given the geometry, receiver type, constellation state, and the space environment, statistical parameters characterizing the location error are computed.  If JCAS provided the aim point as the original input, then a random draw is performed and a simulated impact point is returned to JCAS for further processing. If a Detonate PDU was the original input, then the model generates a report according to parameters set by the BDA (Bomb Damage Assessment) cell that is supporting the exercise. In both cases the characterization of the miss distance, based on GPS location error, is used as one of the factors to determine the effect of the weapon detonation.Figure  STYLEREF 1 \s 3. SEQ Figure \* ARABIC \s 1 1: System Architecture for Navigation	To support modeling of the space regime, many existing functions of TAOS V1.0 have been directly reused.  The database labeled as “SpaceWx” in Figure 3.1 fully reuses the object model and C++ implementation developed for storing METOC data as required by the STOW program, and it is now possible to use TAOS to generate multi-regime databases that include atmospheric, oceanographic and space environmental scenarios.  The visualization system remains an invaluable tool for inspecting the contents of space weather databases as well as METOC databases; examples of visualizations of 4D ionospheric electron density and scintillation-induced signal attenuation are included in this paper.	In order to widen the range of environmental modeling services provided by TAOS while developing support for the space regime, one TAOS subsystem was extensively re-engineered – the Integrator – and a second subsystem was consciously not reused – the Distributor.  For the Navigation function, the Distributor is replaced by a new TAOS subsystem known as the Query Server.  The remainder of this section describes these enhancements in more detail.Reengineering the TAOS Integrator: Internal and External Models	The Integrator developed for TAOS V1 is designed around the assumption that all environmental models providing inputs to TAOS are external to TAOS; such operational codes are typically run out of military forecasting centers such as the Navy’s FNMOC (e.g., NOGAPS, WAM, NORAPS) or the Air Force Weather Agency (e.g., MM5).  However, the space-regime models PIM and WBMOD (and the ocean-surface regime’s Tide model as well) are public-domain research models which would have to be individually configured and run by the user, on his local workstation, if the external-model paradigm were to be preserved in adapting TAOS to the space regime.  Both PIM and WBMOD are legacy FORTRAN codes, are driven via console input and/or ASCII input files, and produce large volumes of ASCII output; the process of consistently configuring and running these models would be tedious and error-prone.  Furthermore, neither PIM nor WBMOD directly output the 4D dataset required by TAOS; PIM only computes a snapshot of the electron density and must be run once for each timestep in the target scenario, while in a single execution WBMOD only computes fade depth for a single LOS.  To illustrate the need for support in TAOS for automatic execution of environmental models in support of multi-regime database construction, the EFX-98 space-weather database generated by the reengineered TAOS Integrator, with its support for internal models, required 24 sequenced executions of PIM (one for each hour in a 24 hour interval) and 64,800 executions of WBMOD (one 24-hour history of fade-depth for 360 x 180 vertical LOSs on a 1x1 degree horizontal grid).TAOS V2 provides a framework that allows environmental models to be executed automatically on a local workstation for the purposes of building an environmental database.  The greatly expanded object model is shown in Figures 4.1 and 4.2.  Figure 4.1 illustrates the classes that comprise the “backbone” of the V2 Integrator.  An Assimilator object manages an extensible set of Source and Transform objects.  Source objects may have an associated Receiver for retrieving data generated externally or internally.  The Integrator is no longer data driven as it was in V1 but is based on a Scheduler object that provides a non-preemptive multi-tasking mechanism similar to that used in the JointSAF simulation.  This greatly facilitates adding new Sources to the system, and also directly supports the internal model framework.Figure  STYLEREF 1 \s 4. SEQ Figure \* ARABIC \s 1 1 Reengineered Integrator Object Model (Part 1) EMBED Word.Document.8 \s Figure  STYLEREF 1 \s 4. SEQ Figure \* ARABIC \s 1 2 Reengineered Integrator Object Model (Part 2)Figure 4.2 illustrates the class hierarchy of Sources.  The Observer class provides a base for derivation for sources of observed data such as is provided by the MEL/AFWA Automated Weather Network (AWN).  The Model base class provides methods of utility to all derived classes, such as projection and vertical coordinate conversion, quality control procedures, and land-sea data masking.  The ExternalModel class provides a base for derivation for environmental models run external to TAOS.  Each model is associated with a ProductDefinition object which encapsulates attributes of the model needed by TAOS at run-time, including vertical and horizontal grids, vertical coordinate type and horizontal projection, mappings from external state variable IDs to TAOS IDs.  Changes in the product definition of external models such as NOGAPS, WAM and COAMPS occur periodically at FNMOC (for example) and in the past have often required corresponding TAOS source code changes in order to preserve interoperability.  In TAOS V2, ProductDefinition objects encapsulate data that is stored in an ASCII file easily updated by the user when a change is made to a model’s operational output dataset.  The InternalModel class provides a base for derivation for locally-run models.  The Process object owned by an InternalModel is bound to the legacy code executable to control its execution, and virtual methods are provided by InternalModel to allow derived classes to define a sequence of model stages (executions) that are automatically stepped through via the base class.  Per-stage prepare_input and collect_output virtual methods allow model-specific input encoding and output decoding to be performed by the derived object.  The end user never sees the legacy code’s I/O directly as it is created and destroyed by TAOS on a per-stage basis.  The abstraction of a model stage has turned out to be particularly useful, meaning something different to each specialized InternalModel:PIM – each stage generates 3D electron density for a single timestep in the target scenarioWBMOD – each stage generates fade depth for a single transmitter/receiver LOS over timeTide – each stage generates tide level for a single seaport over timeFigure 4.2 includes two InternalModels indicated with dashed-lines – ASTRAL and MM5 – which while not currently funded for integration with the V2 framework are nevertheless excellent candidates for this framework.  ASTRAL, an underwater acoustic propagation code, generates transmission loss for a single frequency, source depth, and receiver depth; the JSIMS Maritime program is exploring the use of ASTRAL to generate transmission-loss databases where a large number of coordinated executions of the model would be required.  Also, TASC is exploring the use of the Mesoscale Model 5 (MM5) for generating atmospheric forecasts internal to TAOS – the MM5 model explicitly defines six model stages:Terrain – generates digital representation of the mother grid and all nests for subsequent stagesAnalysis – generates the boundary conditions for the run using a global analysis fieldObservations – performs optimal blending of observed data into the analysis fieldsInterpolation (front-end) – converts vertical coordinate to sigma level from pressure-heightIntegration – computes the forecast by evolving the atmospheric equations of stateInterpolation (back-end) – converts sigma levels back to pressure-heightEach stage is driven by outputs of the previous stage and a considerable burden is placed on the user for the correct and consistent configuration of all six stages; a framework for automating the execution of MM5 would greatly facilitate its usability within the M&S community.Expanded TAOS Client Services: Roles of the Distributor and Query ServerThe discussion in the previous section focused on the pre-exercise activity of environmental database generation, using the “front end” of TAOS, the Integrator.  This section shifts attention to the “back end” of TAOS, where the emphasis is on giving a distributed simulation client run-time access to the environmental state in a TAOS database.  The solution developed for the STOW-97 program, employing a TAOS process known as the Distributor, is illustrated in the upper half of Figure 5.1.  The lower half of the figure illustrates an alternative access mechanism which, while developed for the space regime, is available to a simulator requiring environmental data for any of the regimes supported by TAOS.Effectively, when using the Distributor-based service the environment is sent to the clients to be queried locally, while the Query-Server-based solution has clients sending queries to the environment.  The STOW JointSAF simulation and AFRL/PL’s Atmospheric Effects Server are examples of TAOS clients that utilize the Distributor-based service.  Clients to the Distributor-based service are required to support either a DIS or HLA network interface and also to implement some type of field constructor to reassemble network objects into queriable data structures in the client simulator’s address space.  The space-regime client simulation for the Navigation function utilizes the Query-Server-based Figure  STYLEREF 1 \s 5. SEQ Figure \* ARABIC \s 1 1  TAOS Client Architecturesservice.  The client does not require a field constructor or a DIS or HLA interface – a C++ API provided by TAOS establishes an IPC link with the Query Server.  Specifically, the client simulation instantiates a TAOS SpaceEnvironment object and, after invoking its configure method, which connects the client to the server via the reliable-UDP-based TAOS messaging system, invokes methods defined by either SpaceEnvironment or its base class, Environment.The Environment base class of the TAOS client API provides methods to:Query a scalar or vector environmental field at a client-specified location and timeQuery a scalar or vector environmental field along a client-specified line in 3-space and at a specified timeQuery line statistics (e.g. min, max, mean, line integral) for a scalar field along a client-specified line in 3-space and at a specified timeMulti-location and multi-line versions of the aboveThe multi-line version of the third query type is used to compute TEC: the client performs a query of the line integral of electron density by sending the end-points of lines-of-sight between a receiver and the GPS satellites visible to it, along with current simulation time to the Query Server.  The QueryServer, using performance-tuned methods on gridded field objects, can currently compute TEC for a set of 12 satellites in approximately 160 msec, which includes network delay.The SpaceEnvironment class inherits all of these methods from Environment, and adds queries specific to the space regime.  These currently include single- and multiple-line versions of a method for querying scintillation-induced signal-attenuation parameters, including fade depth, along a client-specified LOS and at a specified time.  The Query Server, using performance-tuned algorithms, currently determines the pierce-point at the turbulent layer and does the database lookup in approximately 40 msec for 12 LOSs.Near Term Development Plans	In addition to completing the development of a first-generation Warning function that includes the effects of 4D cloud fields, the following enhancements will be made to TAOS in the area of supporting the Navigation function for the EFX-99 exercise:The PIM and WBMOD internal models will be enhanced to support scriptable space-weather scenarios.  In particular, these models as incorporated into TAOS will allow the user to specify a time history of sunspot number and 3-hour geomagnetic activity index so that a scenario can be constructed to include virtual ionospheric storms.An improved treatment of scintillation will be pursued to eliminate the need to use the pierce-point approach.  Specifically, the WBMOD model will be executed at run-time, on-demand, to compute scintillation effects along a client-specified line-of-sight.Version 2.0 of TAOS, planned for release in the summer of 1999, will include the space-regime enhancements described in this paper.References[1] D. A. Whitney: “TAOS: Dynamic METOC Environmental Simulation Services”, TASC Technical Report TR-07601-10, Final Technical Report to the STOW-97 program, 30 January 1998[2]    R. A. Reynolds, et. al., “The Total Atmospheric and Oceanographic System (TAOS), Object-Oriented Simulation of the Natural Environment for Modeling and Simulation Applications”, Proceedings of the Object Oriented Simulation Conference (OOS-98), January 1998, San Diego, CA[3] 	The Parameterized Ionospheric Model (PIM) is freely distributed via Computational Physics, Inc. or via the Internet.  At time of writing, the model software and documentation may be downloaded from an AFRL anonymous FTP site at andersun.plh.af.mil (146.153.4.202)[4]  The Wide-Band Model (WBMOD) of ionospheric scintillation was developed by Jim Secan, currently at Northwest Research Institute.  At the time of writing, the model source code and documentation may be purchased via Northwest Research for a fee of $200.[5]	TAOS Version 1.0 is available to Government programs via the Topographic Engineering Center (TEC) in Alexandria, VA, c/o Jack Huntley.  Version 1.0 is baselined on the IRIX5.3 platform; Version 2.0 will be baselined on IRIX6.5.  A User’s Guide and Developer’s Guide are also available from TEC.Author BiographiesROBERT A. REYNOLDS is a Principal Member of the Technical Staff at TASC and has been the system architect and lead developer for TAOS through the STOW-97 and -98 programs.  His primary interests are in object-oriented modeling and simulation in a distributed environment.NORI M. SHOHARA is a senior software engineer at Science Applications International Corporation and has 20 years experience in the industry.  He is currently the chief engineer for space modeling and simulation in the Information Systems and Simulation Division. When he's not working, you can find him sitting somewhere in the California sunshine reading science fiction. All environmental data visualizations appearing in this paper were produced by TAOS It is known that this approach is suboptimal and generally results in under-prediction of the effect, as the effect is a function of the angle-of-incidence of the LOS at the turbulent layer.  Work is ongoing to improve on this approach. The STOW-98 program is funding the development of a global METOC database featuring four 14-day scenarios, centered on the Spring solstice, the Summer equinox, the Fall solstice and the Winter equinox, to benefit both the STOW and JSIMS programs.  The JSIMS program is anticipating adding corresponding space-weather segments to complement these scenarios in the spring of 1999. While all of the methods listed here have been prototyped and reviewed at TASC and SAIC, only those actually required by the Navigation function have been implemented and tested. For example, air temperature, salinity, significant wave height, or electron density. For example, current, wind or magnetic field strength.Figure  STYLEREF 1 \s 2. SEQ Figure \* ARABIC \s 1 2  Pierce-point Approach to Computing Scintillation EffectFigure  STYLEREF 1 \s 2. SEQ Figure \* ARABIC \s 1 1:  Scintillation-induced Fade Depth (2-hour intervals)Figure  STYLEREF 1 \s 2.1:  Electron Density Distribution in the Ionosphere (at 4-hour intervals)