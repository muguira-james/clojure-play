Master Environmental Library and Secure AccessLouis A. HembreeMarine Meteorology DivisionNaval Research Laboratory7 Grace Hopper Ave.Monterey, CA 93943831.656.4787Craig KunitaniMarie E. WhitePangaea3032 Sherman RoadPebble Beach, CA 93953-2853831.656.0130Keywords:MEL, Data Discovery, PKI, SecurityABSTRACT: The Master Environmental Library (MEL) is a web-based data discovery, ordering, and delivery system that was developed under funding from Defense Modeling and Simulation Office.  Data providers place metadata records in MEL; these records are then searchable via a query interface.  The end user places a query for data and then browses the metadata records returned.  When the user finds a data set that they want, they place an order via a web-based order form.  Recent modifications to MEL enhance MEL’s functionality.  Support for other metadata record formats than FGDC was added.  Also support for DoD Public Key Infrastructure (PKI) is being incrementally implemented.  PKI Enabling in MEL requires that an end user has a DoD PKE Identity Certificate to access any restricted metadata records.  It is further required that to access restricted metadata records, the end user must be authorized by the data provider.  This allows the data provider to control access to the metadata and hence the data.IntroductionThe Master Environmental Library (MEL) is a web-based data discovery, ordering, and delivery system.  MEL enables an end user to perform queries for different kinds of data, review the query results, and order the data.  The Defense Modeling and Simulation Office (DMSO) under the Environmental Representation Technology Area Program has sponsored the development of MEL. MEL has been providing this service for several years.  For the most part, data that was orderable online was available to anyone.  There were few restrictions as to who could view the metadata and order the data.  The only restriction in the past has been for a small set of access-controlled data sets whose access was granted on a per request basis and controlled by secret URLs.  Recently MEL began implementing features of Public Key Infrastructure (PKI).  PKI will allow the data providers to more tightly control who has access to data sets, and will allow data providers to make available access-controlled data sets that were not available through MEL prior to PK-Enabling (PKE).BackgroundPeople are always looking for some particular type of environmental data, be it terrain, ocean, atmospheric, or space data.  However, one of the basic problems with finding the data is that data sets are widely distributed and are not readily discoverable.  MEL's objective was to provide a central location were users could go to discover data sets that might meet their needs, review description of the data sets, and when the desired data set was found, to order it.  The central point of access is known as the MEL Access Site and the data suppliers are known as MEL Resource Sites.  The Resource Sites maintain complete control over their data sets, determining which data sets to make available and which not to make available.  There are two types of MEL resource sites.  One uses the MEL Resource Site Software (MRSS) and the other does not.  Those resource sites that use the MRSS allow their data to be ordered and delivered online through the MEL interface.  Those that do not use the MRSS, known as Alternative Access Sites, require the end user to place their order via another means, usually by filling out a form for review by the resource site.  The PK-Enabling of MEL will allow some of the Alternative Access Sites to make data sets available online by providing authorization capabilities.  The current MEL Resource Sites are listed in Table 1.  There are two resource sites located on the SIPRNET, (DoD’s Secret Internet Protocol Router Network).Resource SiteNetworkUses MRSSAir Force Combat Climatology CenterNIPRNETNoAir Force Weather Information NetworkNIPRNETYesArmy Research LaboratoryNIPRNETYesEnvironmental Scenario GeneratorNIPRNETYesFleet Numerical METOC DetachmentNIPRNETNoMSU Engineering Research CenterNIPRNETYesNational Geophysical Data CenterNIPRNETYesNational Geospatial-Intelligence AgencyNIPRNETYesNational Geospatial-Intelligence AgencySIPRNETYesNaval Oceanographic OfficeNIPRNETYesNaval Research LaboratoryNIPRNETYesSimulation DataBase FacilityNIPRNETNoU.S. Army Topographic Engineering CenterNIPRNETNoU.S. Army Topographic Engineering CenterSIPRNETNoMEL OperationEach resource site describes the data sets that they are making available through MEL in a metadata record.  Currently, the metadata must be in the FGDC 1998 Metadata Standard. The metadata records are uploaded to the MEL Access Site where they are then searchable.  To use MEL, a user first goes to the MEL home page at http://mel.dmso.mil.  They then go to either the HTML Query page or the Java Query page.  The user can perform the same type of queries on both pages, the only difference is one uses HTML and the other Java for the presentation.  On the query page, users can specify a geographic area, time period, keywords, and resource sites to query.  When the query is executed, the user is returned a list of the data sets that met their query criteria.  The query results are organized by resource site.  The user can then browse the metadata records and determine which data sets best meet their needs.  If the resource site providing the data uses the MRSS, the end user can then go to the MEL order page to place an order.  The order page is customizable by the resource site for their particular data sets. In their profile, the user specifies whether data is delivered to their ftp site or picked up from the resource site.  After submitting an order, the user receives an order number.  When their order is either ready for pickup or was delivered, the user is sent an email.  Delivery is typically either by File Transfer Protocol (ftp) pickup from the resource provider’s anonymous ftp site, or by ftp push to the user’s anonymous ftp site.  If the user wishes to have a standing order for data sets that are updated frequently, such as weather forecast model runs, they place subscription order for the data set. The user can also request to be informed via email when a new data set is available.  Often the ordered data sets are ready for pickup in a manner of minutes after placement of the order.  If the resource site is an alternative resource site, a link from the MEL query results web page takes the user either to the order page for that resource site or to another type of informational page.   Recent Additions to MELThe next release of MEL will contain several new features.  These include:Expansion of supported metadata formats,Modification of the query page to support quantitative searching of attributes, andSupport for Public Key Infrastructure (PKI).Metadata SupportIn the past the only metadata format that MEL supported was the Federal Geographic Data Committee Content Standard For Digital Geospatial Data, FGDC_STD_001-1998 [1]. The next MEL release will provide generic support for metadata records.  The metadata presented by MEL is divided into two components: 1) the core metadata, and 2) the supplemental metadata.  When a user browses the metadata record, only the core metadata elements are presented and a link is provided to the full metadata record.  Mappings from the FGDC and ISO 19115 [2] formats currently exist.  When a resource site uses a different metadata record format, they have to provide a mapping from their metadata format to the MEL core metadata elements.  This only has to be done once for each format type.  Query Page ModificationThe MEL HTML and Java Query pages were modified to allow searching for quantitative values of attributes, when metadata records allow for it.  This required some adaptation of the metadata record.  Currently, there are no metadata records or corresponding data sets that can satisfy this type of search.  This capability was added to able to support projects like SNE Virtual Data Repository (SVDR), which is scheduled to become a MEL Resource Site in the future.  Figure 1 shows the revised section of the HTML Query Page.PKI SupportPublic Key Infrastructure (PKI) IntroductionPublic Key Infrastructure (PKI) is the framework and services that provide the generation, distribution, control, tracking, and revocation of digital certificates.  The purpose of a PKI is to manage keys and certificates in a way whereby an organization can maintain a trustworthy networking environment.  The PKI framework is comprised of personnel, policy, procedures, components, and facilities and is used to bind user names or identities to electronic keys so that applications can provide the desired security services.  PKI provides four main services: 1) data confidentiality, 2) identification and authentication, 3) data integrity, and 4) non-repudiation.  Encryption is the enabler for data confidentiality while digital signature is the enabler for the remaining three services.PKI technology is being incorporated into MEL in compliance with DoD policy, [3] and [4], and to provide the resource sites with more control over their data sets.  DoD policy is requiring all unclassified "private" web sites to support PKI.  In this context, private basically means any web site that limits or attempts to limit access to a particular audience.  PKI support encompasses the use of both client and server certificates.DoD Client Certificates All users who wish to access restricted parts of the MEL web site will be required to have a DoD issued or DoD External Certificate Authority (ECA) issued PKI identity certificate.  This certificate serves as a means to verify that the user is whom they say they are when they connect to the MEL web site (identification and authentication). However, the PKI identity certificate does not grant the user authorization.  The MEL resource site responsible for the data will grant the user authorization to access the restricted metadata and data.  The MEL Access Site will maintain a database of previously granted authorizations.  There are two forms of the PKI identity certificate:  software and hardware.  A DoD Registration Authority (RA) issues Software ID Certificates.  If the user is a DoD employee, the Local Registration Authority (LRA) issues the software certificate.  If the user is a DoD contractor, under defined conditions, they will be able to get the certificate through the LRA at the DoD office that they are supporting.  Otherwise, the contractor can get their software certificate from an External Certificate Authority (ECA).  There are currently three ECAs: Digital Signature Trust (DST), Operational Research Consultants (ORC), and VeriSign, Inc.The hardware form of the PKI identity certificate is included on the DoD issued Smart Cards called Common Access Cards (CAC).  As of April 2004, DoD employees and onsite contractors will be required to use CACs to access DoD networks.  Using CACs for network access, requires that a Smart Card reader be connected to the user’s computer system.Server CertificatesA PKI server certificate is a certificate that is presented to another computer to identify the originating computer.  A web server presents a web server certificate to a client’s web browser.  Any web server that offers secure connections (e.g., https or SSL/TLS) must have a server certificate.  To the end user, the web server certificate certifies the identity of the web server and assures that another web site is not spoofing the web server.  In the next release of MEL, the MEL web server will present a mel.dmso.mil server certificate.  If the certificate of the issuing Certificate Authority (CA) has been imported into the client web browser, no dialog window will be displayed.  However, if the root CA certificate has not been imported into the client web browser, then a dialog window like the one in Figure 2 will be displayed.  The user can view the server certificate to assess its validity.  Then they can either accept or reject the certificate.  If the user rejects the certificate, they will not be connected to the web site.Client AuthenticationOnce a user accepts the MEL Server Certificate, they will then be prompted to provide a DoD or ECA PKI Identity Certificate.  Note that if the user has only one identity certificate loaded in their browser, they may not be prompted but rather their browser may provide the certificate automatically.  If the user does not have a DoD or ECA PKI Identity Certificate, they will still be allowed to use the MEL web site, however, they will be restricted to seeing only metadata records that are publicly available, as in the current MEL release.As part of the client authentication by the web server, the user’s PKI identity certificate will be verified that the certificate is valid and is not expired.  If the certificate passes both of these tests, the revocation status will then be checked.  If the certificate fails any of these tests, the user will not be granted access to MEL.   If the certificate passes all of the tests, the end user will be authenticated.   The process described above in paragraphs 4.3.3 and 4.3.4 are illustrated in Figure 3.MEL Authorization for Restricted MetadataIn the next release of MEL, resource site authorization will be required for users to view restricted metadata and hence order restricted data sets.  After a user places a query, a customized query results page will be returned with the content dependent upon the user’s authorization.  If a user is authenticated to MEL, the MEL system will determine what restricted metadata the user is authorized to view and then automatically display both the restricted and unrestricted metadata.  Alternatively, if a user has not been authenticated, the MEL query results page will indicate if a resource site has restricted metadata.  If it does, the user will be instructed that to access the restricted metadata, they will need a DoD or ECA PKI Identity Certificate and then authorization from the resource site.  The user will be given a link or contact information to apply for authorization.The resource site will then use their procedures to decide if authorization should be granted to the user.  The resource site may require that a user submit a written request describing the need to access the restricted data and additional verification information.  If the resource site determines that authorization is to be is granted, the appropriate staff at the resource site will connect to a restricted MEL management web page using their PKI identity certificate and https, and then grant the user authorization to access the restricted metadata.  The authorization may be granted for a specific time period and/or revoked at a later time.  The time required to receive authorization will vary depending on the resource site’s requirements.  Granularity of Restricted AccessIn the next release of MEL, access control granularity will be resource site wide.  That means that when a user is granted authorization to access restricted metadata for a given resource site, they will have access to all of the restricted metadata for that site.The MEL development plan calls for a finer granularity, specifically for a resource site to able to grant authorization at several levels of granularity.  These include:Resource site wide (next release implementation),By data set (metadata record),By group, andAutomatic with PKI certificateThe resource site wide access is what will be included in the next release.  The remaining categories are to be included in a future release.  With the "by data sets" level, resource sites will be able to grant authorization on a data set by data set level.  This will allow the resource site to maintain the highest level of control over access to their data sets.  With the "by group" level, the resource site will grant access to predefined groups of data sets.  This is useful when there are groups of data sets that are of interest to a particular community of interest.  The "automatic with PKI certificate" will be the least restrictive level.  A user will be able to access the restricted data sets if they have a DoD or ECA issued identify certificate.  Signing Email and Secure FTPAn additional DoD PKI requirement is that all email sent within the DoD will be digitally signed using DoD PKI email certificates.  Hence in a future release of MEL, servers will be assigned PKI email certificates for signing of email notifications.  If the email notifications contain sensitive data, the email may also be encrypted.Furthermore, in order to protect the confidentiality of data sets in transit, a future release of MEL will utilize a secure version of ftp, such as sftp that is provided by the open source OpenSSL package. This will require both MEL and the end user to utilize the same sftp software.ConclusionMEL provides an established means for the discovery, ordering, and delivery of distributed data sets.  It is used by a number of data providers to make their data available.  With the implementation of PKI more data sets can be made available to qualified end users and the resource sites can exercise greater control over who has access to their data.References Content Standard for Digital Geospatial Metadata (CSDGM).  Federal Geographic Data Committee, FGDC-STD-001-1998, June 1998, http://www.fgdc.gov/metadata/contstan.htmlISO/DIS 19115:2003 Geographic information — Metadata, May 2003,  HYPERLINK "http://www.iso.org" http://www.iso.orgDoD Directive 8500.1, “Information Assurance (IA)”, October 24, 2002DoD Instruction 8500.2, “Information Assurance (IA) Implementation”, February 6, 2003.Author BiographiesLOUIS HEMBREE, Ph.D., is a Meteorologist at the Naval Research Laboratory Marine Meteorology Division, Monterey, CA.  He is the MEL project lead.  He has been involved with M&S for 13 years.  Dr. Hembree has advanced degrees in Meteorology.CRAIG KUNITANI, is a Principal of Pangaea, a consulting firm specializing in providing computer services to the DoD.  He has been a MEL developer for over five years.  Mr. Kunitani holds degrees in Statistics and Meteorology and has extensive experience in meteorological and oceanographic numerical modeling, high performance computing, computer programming, software engineering, and web site development.MARIE WHITE, Ph.D., is a Principal with Pangaea, a consulting firm specializing in providing computer services to the DoD.  She has been a MEL developer since 1997.  Dr. White has advanced degrees in Oceanography.  She has focused on computer programming and web site development since 1993. Table 1: MEL resource Sites EMBED Word.Picture.8  Figure 1:  Quantitative search input box.Figure 2: Server certificate dialog box.  Note that the appearance of the dialog box depends on the web browser.  EMBED Word.Picture.8  Figure 3:  Handshaking process in establishing secure connection. EMBED PowerPoint.Show.8  