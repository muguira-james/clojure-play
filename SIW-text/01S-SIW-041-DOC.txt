Building on the Realtime Platform Reference and EnviroFed FOMsMichael J. O'ConnorITT Industries600 Boulevard South, Suite 208Huntsville, AL 35802256-650-2732michael.oconnor@itt.comDennis L. JonesITT Industries2560 Huntington AvAlexandria, VA  22303703-329-7181dennis.jones@itt.comJames GerdingDefense Threat Reduction Agency6801 Telegraph RoadAlexandria, VA  22310703-325-1138james.gerding@dtra.milRobert ReynoldsLitton/TASC55 Walkers Brook DrReading, MA781-205-7579rareynolds@tasc.comKeywords:Federation Development, BOM, RPR FOMABSTRACT: Since the inception of HLA, there has been much discussion on how to create interoperable federates.  Much of the early HLA work focused on creating new federations starting from scratch.  In practice, this is rarely the case.  Creating a federation is a labor- and money-intensive process.  This paper discusses the approach used to create a new federation using existing federates with different FOMs.  Our approach draws on the work performed by the Simulation Interoperability Standards Organization (SISO) Reference FOM Study Group and the SISO's ongoing Base Object Models Study Group.  Under DTRA sponsorship, ITT and Litton/TASC created a new federation and resulting FOM using the Nuclear, Chemical, Biological, and Radiological Environment Server (NCBR) and Ocean, Atmosphere, and Space Environmental Services (OASES meteorological server).  The NCBR and OASES use the SISO Real-time Platform Reference and DMSO's EnviroFed FOMs, respectively.  The merged FOM allows the NCBR and OASES to maintain their current level of interoperability with other federates while adding the new capability.1. BackgroundThe Defense Threat Reduction Agency (DTRA) has developed a suite of models and simulations to represent/predict the effects of weapons of mass destruction (WMD).  For decades, the DoD has used these models for analysis, training, advanced war fighting experiments, and advanced concept technology demonstrations.  The DTRA Weapons Effects Models – High Level Architecture Conformation (WILCO) program is an initiative to implement HLA compliance in DTRA’s WMD models to enable participation in a broader range of activities.  DTRA’s goal is to make the models operable across a variety of existing, developmental, and future federations—to the extent possible. Figure 1.0-1One of the first efforts at model interoperability involved the development of a new federation (and resulting FOM) of the Ocean, Atmosphere, Space Environmental Services (OASES) meteorological server and the NCBR Environment Server, see Figure 1.0-1.  At the beginning of the effort, each federate used a different FOM.  The models were not able to communicate with each other via HLA.  Therefore, ITT and Litton/TASC developed a new FOM supporting both federates using the SISO Base Object Model design approach.  1.1 Numerical Weather Prediction and HLA ComplianceDTRA has made substantial investments in developing and/or using high-fidelity numerical weather prediction (NWP) models. Models such as OMEGA, RAMS, MM5 and COAMPS produce 3D and 4D weather data formatted for input to applications such HPAC and the SCIPUFF transport model. DTRA has also developed the Meteorological Data Server (MDS) system for distribution of meteorological (met) data to a variety of models. Litton/TASC developed the Total Atmosphere Ocean Space (TAOS) environmental services software system to provide high-fidelity, dynamic 3-D environmental data and derived features and effects to a broad range of modeling and simulation applications. Under Defense Modeling and Simulation Office (DMSO) and, now, DTRA support, Litton/TASC evolved TAOS into a new set of applications bundled in the Ocean, Atmosphere, Space Environmental Services (OASES) system, to provide a High Level Architecture (HLA) compliant system leveraging the power of the HLA Run Time Infrastructure (RTI) and Distributed Interactive Simulation (DIS) networking protocols. 1.2 OASESThe Environment Federation (EnviroFed) project, a component of the Integrated Natural Environment program sponsored by DMSO, is developing object models of the synthetic environment, including natural and man-made phenomena, for use in a distributed simulation based on the HLA.  The primary project goals are 1) to develop a reference FOM with sufficient expressive power to support interest management of environmental data using HLA Declaration Management (DM) and Data Distribution Management (DDM) services, 2) to explore use of the Synthetic Environment Data Representation and Interchange Specification’s (SEDRIS) Environmental Data Coding Standard (EDCS) for object attribution and classification, and 3) to develop a federation based on the Joint Semi-Automated Forces (JSAF) simulation that demonstrates application of the synthetic environment technology developed by the program.OASES is a composable suite of applications for creating and managing synthetic atmosphere, ocean and space environments.  OASES includes the Environmental Data Server (EDS) application that is the EnviroFed federate responsible for creating and updating run-time objects that encapsulate the state of the ocean, atmosphere, and space environments.  The EDS federate complements the suite of Dynamic Terrain and Object (DTO) simulations developed by Lockheed Martin Information Systems under the Synthetic Theater of War (STOW) and EnviroFed programs.The EnviroFed FOM, by definition, is the union of the System Object Models (SOMs) of the JSAF, EDS and DTO Federates.  The OASES SOM defines the object classes that encapsulate the ocean, atmosphere, and space environmental state; this class hierarchy is shown in Figure 1.2-1 as a screen-capture from the DMSO Object Model Development Tool.Figure 1.2-11.3 Nuclear, Chemical, Biological, and Radiological Environment ServerThe NCBR is an existing simulation developed by ITT Industries for a consortium led by DTRA and the Army’s Edgewood Chemical Biological Center.  It provides hazard clouds, doses, and depositions for distributed simulation. In real time, the NCBR calculates a high-fidelity, 3D hazard environment as a function of hazard delivery system (source term), meteorological conditions and complex (i.e., 3D) terrain. The DTRA SCIPUFF and the Naval Surface Warfare Center’s VLSTRACK Gaussian puff models provide the means for the NCBR to calculate CBR hazard environments. The NCBR makes the data available to other simulations via full 3D representations of the environments (instantaneous air concentration), 2D grids (dose, deposition, air concentration, and lethal dose, or LD, contours), and at a point via a subscription process.  Figure 1.3-1 portrays a sample 2D conformal (to terrain) NCBR instantaneous air concentration calculation showing the effect of complex terrain on the cloud. SBCCOM has served as the proponent for configuration control and release of the NCBR and the DTRA WMD Analysis and Assessment Center supported the migration of the tool to the DoD’s High Level Architecture (HLA) standard for distributed simulation.Figure 1.3-1ITT (and co-authors) has discussed the NCBR in previous SISO papers including “Transferring Ownership of ModSAF Behavioral Attributes” 99S-SIW-097 [2], Use of Virtual Environments to Support Developmental Testing of the Biological Aerosol Warning System (BAWS)” 99F-SIW-033, and “Developing Biological Hazard Detection Tactics, Techniques, and Procedures Using Distributed Simulation” 98F-SIW-140 [1].2. BOMsSISO proposed the Base Object Model (BOM) as part of the Reference FOM Study Group Final Report in March of 1998 [8].  Since that time, a number of papers have been written describing the BOM concept, including  98F-SIW-034 [7], 99S-SIW-115 [5], 99S-SIW-185 [6], 99F-SIW-112 [4].  SISO’s Simulation Technology Magazine Volume 2, Issue 4 [9] has an informative article by Paul Gustavson and Larry Root on the promise of BOMs for interoperability.2.1 BOM ConceptThe previously cited references provide extensive details on the BOM concept.  In this section we will discuss the BOM concepts as they were applied to this effort.BOMs are divided into two categories:  interface BOMs (IF BOM) and encapsulated BOMs (ECAP BOM).  An IF BOM represents a “pattern of interoperability” contained within a FOM or SOM that can be inherited within other FOMs or SOMs [10].  An ECAP BOM represents a “component” of a federate or federation that can be leveraged within other federates or federations [10].  This effort used the Interface BOM concept.The IF BOM is further classified as an interaction IF BOM or object/attribute pair IF BOM.   This effort used the object/attribute pair IF BOM.  The object/attribute pair IF BOM is built around one or more objects and there associated attributes.2.2 BOM SelectionThere are several different approaches that could have been used to establish HLA interoperability between OASES and the NCBR.  The approach had to support the immediate interface goals and the future needs of other DTRA federates to receive meteorological data.  The options included creating a new FOM from scratch, modifying an existing FOM, or using the BOM concept.  Creating a new FOM was rejected because of the expense and time required.  Additionally it would make interoperability with other simulations more difficult.  Modifying an existing FOM was not selected because the NCBR and OASES used different FOMs.  Modifying an existing FOM would require one of the federates to change FOMs.  The BOM concept enabled both federates to use their existing FOMs by simply adding the new objects, attributes, and interactions of the intersecting FOMS.The Object/Attribute IF BOM was selected because the met data to be shared was represented as a class in OMT format, and there was not a need to represent behavior supported by the ECAP BOM.Creating the meteorological interface as a BOM supports another ongoing effort on the WILCO contract to create a FOM for WMD effects.  Creating a BOM to represent the meteorological interface between the NCBR and OASES allows the interface to be reused as part of the WMD FOM effort.  BOMs are also being considered to support the WMD FOM.3. Building the BOMThere are two approaches to building a BOM:  1) extracting one from an existing FOM,  or 2) building one from scratch.  For this effort it was determined the best approach was to extract the BOM from the Defense Modeling and Simulation Office’s (DMSO) EnviroFed FOM.  Analyses of the interoperability requirements for OASES and the NCBR determined that the Vertical Profile class from the EnviroFed FOM would support all NCBR meteorological requirements.The Vertical Profile BOM is a simple BOM, containing only one leaf class.  The level 1 class, Atmosphere, does not contain any attributes and is used for grouping the EnviroFed FOM.  The level 2 class, Atmosphere_1D, has six attributes.  The level 3 class, Vertical_Profile, has four attributes.  The interface between the NCBR and OASES did not require all of the attributes in the EnviroFed FOM (e.g., EAC_Dewpoint_Depression).  One option would have been to eliminate this attribute from the BOM.  This was not done to maintain compatibility with the EnviroFed FOM.  It would have reduced the future reuse potential of the BOM for non NCBR federates.  The class structure of the EnviroFed was maintained for the same reasons.3.1 Merging the FOMs Under this effort, ITT and Litton/TASC added the Vertical Profile BOM to the RPR FOM.  This addition did not compromise any existing RPR FOM classes or interactions.   There were no conflicts between Vertical Profile BOM names and RPR FOM names.  3.2 Changes to NCBRThe NCBR is internally divided into several components.  Two of these components were affected by the addition of meteorological data from OASES.  The first was the Network Communications Interface (NCI).  The NCI handles all HLA and DIS interactions for the NCBR.  The new information from OASES can only be received via HLA.  VR-Link from MaK Technologies is used by the NCBR as a middleware layer.  VR-Link provides direct support for the RPR FOM.  It also provides classes that can be extended to support new classes or interactions.  New C++ classes had to be created to support the Vertical Profiles in the merged FOM.  This effort was relatively straightforward and was accomplished in approximately two manweeks.The second NCBR module modified was the Terrain and Meteorological Processor (TMP).  As part of a previous effort, the NCBR had been modified to handle meteorological data from TAOS using DIS Gridded Data PDUs.  The grids had to be divided into several PDUs because of the PDU size limit.  This required the TMP to reassemble the grids.  The Vertical Profile BOM does not require breaking the data into Ethernet packets—and hence no reconstruction of the data within the NCBR is required.  The overall changes to the NCBR were not extensive.  The data representation used by the Vertical Profile BOM provided the NCBR with new capabilities.  Using the DIS Gridded Data PDUs provided meteorological data at regular locations (intervals).  The vertical profile allows the NCBR to receive data from an irregular set of locations, accommodating easy incorporation of met data from adaptive gridding met codes and individual met stations.  With DIS, the only way to change the met was to receive the complete grid.  With HLA, OASES can update an object or delete the object when the met is no longer valid.3.3 Changes to OASESThe Atmosphere-1D and Profile classes indicated in Figure 1.2-1 were added to support the NCBR and Weapons Assessment Lethality Toolset (WALTS).  A requirements analysis led to the conclusion that the best way to provide atmospheric state to the NCBR and WALTS simulations was as a set of vertical profiles associated with an unstructured, triangulated horizontal grid.  An unstructured triangulated grid (UTG) is used by SAIC’s Operational Multiscale Environment model with Grid Adaptivity (OMEGA) –a primary requirement of the system development sponsored by DTRA is that it support use of OMEGA as the source of the synthetic atmospheric environment.  Note that a rectangular horizontal grid, such as used by MM5, RAMS or COAMPS, is a special case of a UTG where the horizontal grid is in fact structured.The OASES SOM extensions to support NCBR simulations maintain consistency with the original design goal that the SOM naturally support multiple coordinate systems for gridded environmental data.  Specifically, the base class Atmosphere_1D maintains 1-D arrays of the dependent atmospheric attributes (e.g., U and V wind components, temperature, pressure, relative humidity) while derived classes provide attributes that describe the geospatial location of the dependent data.  Specifically, the derived class Vertical_Profile defines a latitude and longitude for the array such that the dependent data associates with elevation.  Additional derived classes could conceivably be useful for describing atmospheric state along a meridian, a parallel or, more likely, along the line-of-sight between a sensor and a target.  The attributes of the Atmosphere_1D and Vertical_Profile classes, including additional Complex Data Types required by these classes, are shown in Figure 3.3-1.Figure 3.3-14. Challenges and Lessons LearnedThe primary challenge was making two existing federates interoperable—without adversely affecting their participation in their current federations.  The use of HLA and BOMs simplified this challenge.  At the time this work was initiated, the BOM Methodology Specification was not complete.  It was possible to use the approach using the previously published works listed in Section 2 and the unpublished work of the BOM Study Group.  Because of the relative simplicity of the BOM, this effort was not impacted by the lack of a formal methodology.  However, a larger and more complicated effort would be more difficult without a formal methodology.5.  Summary/ConclusionThe BOM concept is a good option to increase interoperability between federates.  This effort was a very limited test of the concept.  However, the positive results should apply to a larger effort as well.This effort was begun in the fall of 2000 while the BOM Methodology Specification was still being developed.  The process to create the Vertical Profile BOM was not as formal as it could have been if the BOM Methodology Specification was complete.  A formal Federation Development Process (FEDEP) was not followed for this effort because of the relative size of the new interface as compared to the size of the two federates.  Not using a formal FEDEP did not affect the current product.  However the additional products produced by a FEDEP would have aided future efforts.DTRA is pursuing the creation of a WMD Effects FOM.  One possibility is the use of a series of BOMs that could be added to federations that DTRA supports with modeling and simulation.  The Vertical Profile BOM has demonstrated the usefulness of the concept.5. References:[1]	O’Connor, Michael J., et al. “Developing Biological Hazard Detection Tactics, Techniques, and Procedures Using Distributed Simulation” 98F-SIW-140, Fall 98 Simulation Interoperability Workshop, September 1998.[2]	LaVine, Nils., et al.  “Transferring Ownership of ModSAF Behavioral Attributes” 99S-SIW-097 Spring 99 Simulation Interoperability Workshop, March 1999.[3]	O’Connor, Michael J., et al. “Use of Virtual Environments to Support Developmental Testing of the Biological Aerosol Warning System (BAWS)” 99F-SIW-033 Fall 99 Simulation Interoperability Workshop, September 1999.[4]	Gustavson, Paul L., et al. “Use Cases – A Blueprint Approach for Federation Development, Testing, and Analysis” 99F-SIW-112 Fall 99 Simulation Interoperability Workshop, September 1999.[5]	Gustavson, Paul L., et al. ”Object Model Use Cases: A Mechanism for Capturing Requirements and Supporting BOM Reuse” 99S-SIW-115 Spring 99 Simulation Interoperability Workshop, March 1999.[6]	Hancock, John, P, et al. “A Structural Description of Base Object Models (BOMs)” 99S-SIW-185 Spring 99 Simulation Interoperability Workshop, March 1999.[7]	Gustavson, Paul L., et al. ” Base Object Models (BOMs): Reusable Component Objects for Federation Development” 98F-SIW-034 Fall 98 Simulation Interoperability Workshop, September 1998.[8]	Hancock, John, P, et al. “Reference FOM Study Group Final Report” SISO Reference Product March 1998.[9]	Gustavson, Paul L., et al. ” BOMs: The Promised Land?” Simulation Technology Magazine Vol. 4 Issue 2 January 4 2001.[10]	Gustavson, Paul L., et al., “BOM Methodology Strawman Specification” Unpublished draft.Author BiographiesMICHAEL J. O’CONNOR is a Senior Software Engineer for the Simulation and Training department of ITT Industries.  In this role he is responsible for system level requirements, software design architectures, and distributed simulation implementations.  Mr. O’Connor has 13 years experience in the development and deployment of distributed systems for training, analysis, system development.  Mr. O’Connor is an elected member of the SISO Standards Activities Committee and serves on SISO’s Base Object Model Study Group and RPR FOM Product Development Group.  He received a Masters of Science in Computer Science from the University of Alabama in Huntsville and Bachelors in Computer Engineering from Auburn University.DENNIS L. JONES is the Manager in ITT Industries’ Simulation and Training Department in Alexandria, VA.  He manages programs dealing with modeling and simulation tool development and application for WMD environments, effects, and sensor systems.  He has a 15-year background in strategic and theater missile defense, counter proliferation, system engineering and integration, and weapons of mass destruction effects.JAMES GERDING is a Program Manager in DTRA's Weapons of Mass Destruction Assessment and Analysis Center, Technology Development Directorate.  He has served in several research and operational support positions in his 15 years at DTRA and predecessor organizations, the Defense Special Weapons Agency and Defense Nuclear Agency.  Prior to joining DTRA, Mr. Gerding served in the US Navy as a nuclear submarine officer.  He received a Master's Degree in Organic Chemistry from Johns Hopkins University and a B.S. from the US Naval Academy.ROBERT A. REYNOLDS is a Principal Member of the Technical Staff at TASC and has been the system architect and lead developer for TAOS, and its evolution into OASES, through the STOW-97/98 program, the PSM+ program, and the ongoing EnviroFed project.  His primary professional interests remain focused in the areas of software engineering, object-oriented modeling, visualization, distributed simulation and synthetic environments.  He has a BS degree in Physics from the Massachusetts Institute of Technology and an MS degree in Nuclear Engineering from Carnegie-Mellon University.