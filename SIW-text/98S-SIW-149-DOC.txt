Many Sources, One Database:  Data Fusion Techniques Developed for the STOW Southwest Asia Terrain Database Charles R. Cornish Ph.D.Tim MillerMike McInnisDale Miller, Ph.D.Lockheed Martin Information SystemsAdvanced Simulation Laboratory (LMIS-ASL)3605 132nd Ave. SE.  Suite 400Bellevue, WA   98006-1323   USA425-957-3272, 406-777-6939, 425-957-3248, 425-957-3259ccornish@lads.is.lmco.com, tmiller@lads.is.lmco.com, mmcinnis@lads.is.lmco.com, ddmiller@lads.is.lmco.comKeywords:Terrain database, GIS, digital feature data, terrain features Synthetic Natural EnvironmentABSTRACT:  The Southwest Asia terrain database (TDB) developed for the Synthetic Theater of War (STOW) Advanced Concept Technology Demonstration (ACTD) is one of the largest and most complex TDBs for the Synthetic Natural Environment (SNE) built to date.  Fusing  geospatial data from multiple sources, scales, and formats presented numerous challenges.  Data were merged, generalized and synthesized using geographical information system (GIS) applications to produce a self-consistent and integrated dataset for database construction.  The data fusion process provided a digitial elevation model (DEM) model representing terrestrial and ocean regions, and generated features for integrating high and low tide marks, streams with river banks and water surfaces, cut-and-fill roads, and obstacles into the 3D terrain surface.  GIS analyses provided attribution of the terrain surface and for runtime databases from multiple imagery and digital data sources.  This paper presents the approaches developed for the SW Asia TDB using GIS.IntroductionThe Synthetic Theater of War (STOW) Southwest Asia terrain database was developed for the STOW Advanced Concept Technology Demonstration (ACTD) efforts to provide increased fidelity and realism in the Synthetic Natural Environment (SNE). Constructing the STOW Southwest (SW) Asia terrain database (TDB), one of the largest and most complex TDBs for the Synthetic Natural Environment (SNE) built to date, presented many challenges.   A major challenge in developing the SW Asia TDB was the assimilation of data from many sources into a unified and integrated data model. An overview of the STOW SW Asia TDB is presented in a companion paper [1]. This paper presents details of the data fusion process undertaken using a geographical information system (GIS) for the STOW SW Asia TDB.The SW Asia TDB features a integrated digital elevation model (DEM) for land and ocean areas derived from DTED Level 1 (DTED1) elevation and 2-arc-minute DBDB (DBDB2) bathymetric data.  The TDB coastline and synthesized high and low tide marks are derived from integrated Interim Terrain Data (ITD), Planning Interim Terrain Data (PITD) and World Vector Shoreline (WVS) coastline data and coastal slope profiles.  Rivers and wadis have trapezoidal cross-sections and water surfaces and are cut into the terrain skin using surface lines derived from drainage feature attributes in ITD and PITD source data.  Using ITD, PITD, and Digital Chart of the World (DCW) source data, road and rail networks are cut-and-fill and have multi-level overpasses and bridges with approaches integrated into the terrain surface.  Obstacles including berms, embankments, escarpments, moats and trenches are integrated into the terrain skin.  Surface material and landform characterization as well as texture application for terrain attribution are derived from Landsat TM imagery data. Areal abstracts representing ocean surfaces, river surfaces and mobility are extracted and used in Compact Terrain Database (CDTB) compilations used by Semi-Autonomous Forces (JointSAF) applications.  The methods used to construct these TDB features using ARC/INFO GIS are explored in subsequent sections. Early SIMNET terrain surfaces were built from uniformly diagonalized right triangles on a regular grid. As simulation technology matured, it became important to represent key terrain features such as concealed routes, rivers and coastlines with higher fidelity. This gave rise to the incorporation of microterrain, manually constructed local triangulated irregular terrain (TIN) insets within a right triangulated background. Next, automatically generated TIN and integrated TIN (iTIN) capabilities were developed for generating fully TINned terrain surfaces containing integrated features such as cut and filled road beds, rivers, and coastlines. All approaches which integrate features into the terrain surface fuse a DEM of low spatial frequencies with feature data containing high spatial frequencies. As with any other fusion of imperfectly correlated source data, conflict resolution is required so that, for example, rivers do not flow uphill, filled roadbeds do not sit hundreds of meters above valley floors, and near-shore inland elevations are not lower than the high water mark.Two approaches have been used for fusing these low and high frequency data sets.  One approach is to fuse the data in an integrated, single step process.  The other is to first build a low resolution terrain surface from the DEM and then augment it by locally adding higher resolution TINs for the high frequency feature data. The latter approach was taken for the SW Asia TDB.  It is generally agreed that a properly TINned terrain surface yields a higher ratio of terrain fidelity to polygon density than a gridded approach.  Whereas existing integrated TIN software packages assume a single Cartesian coordinate system for the full extents of the data base, adapting them to the Global Coordinate System (GCS) used by STOW posed an unacceptable schedule risk.  Hence, an alternative process of GIS processing of terrain features for GCS databases was developed.  Using ARC/INFO, source data was processed to generate  surface lines (lines of constraint for the TIN generation process).Generation of an Integrated Gridded Terrain SurfaceCreation of a terrain surface for land and ocean regions required the integration of data from terrestrial elevation and bathymetric data into a single digital elevation model (DEM).  Source DEM data are DTED1 and DBDB2 for the land and ocean regions, respectively.   Integration of the two data sets was facilitated using ARC/INFO GRID to:Remove anomalies from the DTED1 (cornrows and cliffs along DTED cell boundaries) for each 1 degree x 1 degree cell.  A description of the filtering and edge seaming process is presented in a companion paper[2].Merge the filtered DTED1  into one ARC/INFO grid.Resample the DBDB2 data from 2 arc minute to the same 3 arc second resolution as the DTED1, using a cubic interpolation.Offset the DEM to assure littoral zone functionality in the runtime and visual databases. Since much of the Persian Gulf coastline has shallow relief, elevations in the DTED1 are reset to a minimum of 1 m.  Depths in DBDB2 are reset to a minimum depth of 2 m.Convert DBDB2 depths to negative elevations.Create land, water and coastline masks are using a coastline feature cover from ITD, PITD and WVS sources.Apply land and water masks to the DTED1 and DBDB2 data sets, respectively.Combine the coastline mask, masked DTED1 and masked DBDB2 datasets into one grid.The integrated DEM is broken up into 1 degree x 1 degree cells for export to S1000, the 3D terrain assembly and TIN generation tool.GIS Processing of Integrated Terrain FeaturesThe integration of terrain features into the terrain skin requires conversion of abstract source data (geometry and attributes) into breakline geometry to constrain the TIN generation process.  The breaklines represent components of a terrain feature, e.g. the rim of a river, the river bottom , the river water surface.  For the SW Asia TDB, these breaklines are modeled as surface lines, which represent terrain features,  and have  3D coordinate geometry, whose elevation coordinate values are fixed or variable, and are absolute or relative with respect to the terrain surface.Littoral RegionThe SW Asia littoral region is represented with higher fidelity than any other previous SNE TDBs.  Coastline feature data was extracted from ITD, PITD, and WVS sources  to form a continuous coastline over the SW Asia TDB region.  This coastline and beach profiles from 1:250,000 JOG maps and supplemental NIMA source data for Kuwait were integrated to create a high water mark, mean sea level, low water mark, and other coastal features, such as sea walls and coastal escarpments for representation in the TIN.  The correct representation and integration of these features is critical since the dynamic ocean surface incorporating waves and tide would otherwise inappropriately flood inland areas.Mean Sea Level (Coastline)Mean sea level (MSL) was constructed from ITD, PITD, and WVS linear features attributed as such. The coastlines from these data sources were merged and generalized.EMBED UnknownFigure  SEQ Figure \* ARABIC 1.  Littoral surface lines (constant absolute elevation) distribution from foreshore to backshore with elevations relative to MSL (figure not to scale).Low Water MarkThe tidal range in the Persian Gulf is about 3 m. The low water mark (1.5 m. below MSL) was constructed from the following three sources: NIMA Kuwait Coastline profiles, 1:250,000 ADRG, and WVS. The coastline profiles and 1:250,000 ADRGs were measured to find the mean distance between mean sea level (coastline) and the low water mark. At the measurement location, a point was added and attributed with the distance to the low water mark. The points were then interpolated into a continuous grid along the coastline. The coastline was then split into 250 m. long segments and assigned the distance attribute from the interpolated grid. The segments were then buffered, smoothed, and generalized to create the low water mark. Where the WVS provided a low water mark,  it was used.High Water Mark and Sea WallsThe high water mark and sea walls (1.5, 3.0 m.  above MSL, respectively) were created by buffering the coastline, or extracting them from the ITD surface material thematic layer ( REF _Ref401973222 \* MERGEFORMAT Figure 1). For example in  REF _Ref401119012 \* MERGEFORMAT Figure 2, buffering the coastline (30 m. for high water mark and 3 m. for sea walls) was used to create the high water mark. The area between the coastline (blue) and high water mark (red) is attributed as tidal mud flats and was extracted from the ITD surface material thematic layer.Figure  SEQ Figure \* ARABIC 2.  Littoral surface lines in the sandy beach area of southern Kuwait, high water mark (red), mean sea level (blue), and low water mark (blue) overlaid on Controlled Image Base (CIB) (10 m. SPOT). Figure  SEQ Figure \* ARABIC 3.  Example view of a resulting inter-tidal area and associated man-made structure (sea wall).Coastal EscarpmentsCoastal escarpments were extracted from the ITD obstacle thematic layer, adjusted to be 3 m. inland from the high water mark, and generalized to match the geometry of the high water mark ( REF _Ref401973443 \* MERGEFORMAT Figure 3).Inland HydrographyDrainlines, wadis, and river/canals were integrated into the terrain using elevation variable absolute surface lines (i.e., nodes have varying but absolute elevations). Drainlines, the simplest form of hydrographic feature, are constructed from a single surface line tagged with elevations reflecting a downstream slope. Wadis (arroyos/washes) are constructed from four sets of surface lines: left bank, left wadi bottom, right bank, and right wadi bottom. Rivers and canals are constructed from six sets of surface lines: left bank, left water level, left river bottom, right bank, right water level, and right river bottom ( REF _Ref401973776 \* MERGEFORMAT Figure 4).The initial step in creating surface lines is the construction of the hydrographic centerlines for polygonal ITD/PITD river/canal features that are merged with existing ITD/PITD linear segments. The hydrographic centerlines are manipulated so that all segments have down-stream topology.  Nodes are placed along the centerlines at road intersections. Elevations are attached to centerline nodes and manipulated so that the hydrographic features continuously slope downstream. Hydrographic features under 2m. in width remain as linear segments and are integrated as drainlines. The ITD/PITD linear features are expanded into surface lines according to the following ITD attributes: WDA, GWD, BHR, BHL, BGR, and BGL. The generalized ITD/PITD polygonal hydrographic features are used as the water line surface line and then expanded using ITD attributes (WDA, BHR, BHL, BGR, and BGL) to create the upper bank and river/canal bottom surface lines. The expanded linear and polygonal ITD/PITD surface lines are merged, and elevations are taken from the centerline and attached to the expanded surface lines. Surface lines vertices that are not associated with a node on the centerline will not have elevation. During the S1000 import process, these vertices will have their elevation derived (interpolated). The hydrographic surface lines are then exported to an S1000 pole-set file from ARC/INFO, and the poles’ elevations are derived via linear interpolation.Integrated Obstacle Features: Berms/EmbankmentsThe PITD/ITD obstacle thematic layer contains linear features that indicate the location of berms/embankments and point features identify where the berm can be crossed. These features are common throughout the region, often located in urban areas and around petroleum storage facilities. The berm/embankment feature was constructed from two surface lines:  (1) the base of the berm was created with no elevation surface lines that conform to the existing terrain; and (2) the top of the berm was constructed from elevation constant relative surface lines set to 2.5 m. above the existing terrain surfaces ( REF _Ref401974802 \* MERGEFORMAT Figure 6,  REF _Ref401119717 \* MERGEFORMAT Figure 7). The point features in the PITD/ITD obstacle layer were used to clip out sections of the surface lines allowing access through the obstacle.EMBED UnknownFigure  SEQ Figure \* ARABIC 4.  A.  A cross-section configuration of drainline, wadi, and river/canal surface lines with respect to the ITD/PITD attributes.  B. A plan view spatial configuration of drainline, wadi, and river/canal surface lines. EMBED Word.Picture.6  Figure  SEQ Figure \* ARABIC 5.  An example of a drainline merging with a wadi constructed from two sets of bank and bottom elevation variable absolute surface lines.Figure  SEQ Figure \* ARABIC 6  Berm/embankment surface lines.Figure  SEQ Figure \* ARABIC 7.  The resulting berm created from elevation constant relative and no elevation surface lineIntegrated Obstacle Features: Moats/TrenchesThe PITD/ITD obstacle thematic layer contains features indicating the locations of moats/trenches. These features are most common around the Kuwait and Saudi ArabiaEMBED UnknownFigure  SEQ Figure \* ARABIC 8.  Trench/moat surface linesborder, and are used to control blowing sand. The moat feature was constructed from two surface lines:  (1) the rim of the trench was created with no elevation surface lines that conform to the existing terrain; and (2) the bottom of the trench was constructed from elevation constant relative surface lines set to –2.5 m. ( REF _Ref407467292 \* MERGEFORMAT Figure 8).Cut and Fill RoadsThe PITD/ITD obstacle thematic layer contains features indicating when a road has been constructed on a filled or cut roadbed. The PITD/ITD indicated that nearly all roads attributed as a cut or a fill were filled roadbeds. The cut and fill roadbeds were integrated into the TIN with elevation variable absolute surface lines ( REF _Ref401977015 \* MERGEFORMAT Figure 9). Optionally, a roadbed base can be constructed from no elevation or variable absolute surface lines.EMBED UnknownFigure  SEQ Figure \* ARABIC 9.  Cut-and-Fill roadbed surface line configuration.The roadbed construction process uses the generalized road network used to create the 3D-appliquÈ road network polygons. The elevation manipulation process is controlled by an AML that requires the following principal parameters:Network linear coverage;Width item in network coverage;DEM;Elevation check distance along the network;Maximum cut;Maximum fill; andBed shift elevation.Elevation processing starts by calculating elevations for vertices and checkpoints along the vector. At each vertex where the elevation exceeds the maximum cut or fill tolerance, the elevation on the centerline is adjusted to fit within the tolerance. At check locations, set by the check distance, where the elevation exceeds the maximum cut or fill tolerance, vertices are inserted on the centerline and the elevation is manipulated to fit within the tolerance. The centerline is then expanded to the width item in the ARC/INFO coverage and elevations from the centerline are attached to the roadbed (anchor poles). The vertices, or poles, on the roadbed that do not receive elevations are derived poles whose elevations are interpolated by S1000.  REF _Ref401142091 \* MERGEFORMAT Figure 10 shows the resulting 3-D roadbeds.Figure  SEQ Figure \* ARABIC 10. Filled roadbeds in the swampy Tigris-Euphrates floodplain.A.  Wireframe viewB.  Same view texturedFigure  SEQ Figure \* ARABIC 11.  The resulting bridge platform and integrated river/canal.PlatformsPlatforms in the region include runway, freeway overpass, single and dual span bridges over rivers and canals, and long causeways from the mainland to several islands and over swamps. Runway platforms were used to create constant elevation areas where runway appliquÈ polygons are placed. To properly place the freeway overpass it is essential that the terrain elevation is constant and placement of bridge models requires that both sides of a river or canal have identical elevations. The platforms integrated into the TIN surface ensure the proper placement of the freeway overpass model, dual span bridge models, and long causeway models.Platforms are constructed from elevation constant absolute surface lines. The constant elevations for the runway and overpass platforms are derived by finding the mean elevation around the perimeter of the platform. The bridge platform elevation is assigned by finding the closest river/canal bank or high water mark surface line and assigning the elevation of the surface line incremented by one meter.  REF _Ref407467476 \* MERGEFORMAT Figure 11 shows wire frame and textured viewsTerrain Surface AttributionThematic Mapper Regional AnalysesRegional image analyses of the Persian Gulf were conducted and published by Dr. Jack Rinker of USATEC in 1990.. These analyses evaluated ground conditions from 1:250,000-scale hardcopy Landsat Thematic Mapper (TM) images for seven TM scenes.  The hand-drawn mapping units constructed by Rinker's analysis delineate major landform associations and contain information on geology, geomorphology, and soils, with an emphasis on how these attributes effect cross-country mobility. These hand-drawn overlays were digitized on orthorectified digital Landsat TMs (see) and were composited with attribution data from other digital sources (PITD, ITD, DCW, and WVS). Forty-seven different landforms types were delineated on the data base and are present in the landform overlay.Feature Attribute Coding Catalog (FACC) and Other AttributesFeature Attribute Coding Catalog (FACC) and other attributes were assigned to Dr. Rinker's regional analyses terrain mapping units (Landform Overlay) with the following attributes: SIMNET soil type,CCTT mobility index,Texture ID,SMC (FACC: Surface Material Category), SWC (FACC: Surface Water Content),STP (FACC: USCS Soil Type),VEG (FACC: Vegetation), andSRD (FACC: Surface Roughness Descriptor).The attributes were applied to each landform-mapping unit and linked to the polygon attribute table (PAT) through a unique identifier (PAT-ID) for the runtime TDB.  Texture ID refers to a set  of realistic desert terrain textures (25 total) developed to represent landforms (e.g. gravel plains, coppice dunes, sabkahs, beaches, etc.). EMBED Word.Picture.6  ABFigure  SEQ Figure \* ARABIC 12.  A.  1 x 1 degree Landsat TM, Bands RGB 7, 4, and 2, with extents: 47° east, 28° 45' north, to 48° east, 29° 45' north.  B. Landform Overlay based on Dr. Jack Rinker's Regional Landsat TM Image Analyses.Generation of Area Features for SAFAreal abstracts of thematic feature layers are used by JointSAF for mobility calculations, long-range planning and Planning View Display (PVD).  REF _Ref401481874 \* MERGEFORMAT Error! Reference source not found. shows an example of the landform and ocean areal abstracts, as displayed by the JointSAF PVD. The figure shows areal abstracts for regions of sandy soil, no-go mobility, rivers (unpassable water), and ocean surface. EMBED Word.Picture.6  Figure  SEQ Figure \* ARABIC 13.  SAF PVD view of showing areal abstracts for landforms and ocean surface.The areal abstracts are derived from source data processed during the TDB construction process and are input during the CTDB compilation process. CTDB compilation efforts prior to STOW SW Asia required areal abstracts for soil type (actually S1000 mobility codes). The SW Asia TDB has the additional need for an ocean feature areal abstract for additional reasoning regarding the ocean surface boundary. The CTDB compiler requires the areal abstract geometry, thematic attributes for the areal abstract (soil mobility, ocean), and topological attributes for areal containment or polygonal complexity (number of holes, hole geometry, level of nesting or defrag level). The nesting level and hole geometry are used for proper display within the SAF PVD.Prior to STOW SW Asia, areal abstracts were generated via S1000. The S1000 terrain data base was searched for adjacent, like-attributed polygons (based on soil type, texture-id, and other attributes) and merged into larger areal abstracts. The S1000 defragmentation process constructed a simple wing-edge topology of the terrain skin polygons, removed edges between like-attributed polygons, discarded the topology, calculated defrag levels, and then stored them in a separate containment tree. The CTDB compiler accessed the areal abstract (or “defrag”) geometry and attributes (S1000 soil mobility type, number of holes, defrag level) from the S1000 data base via the S1000 API. Major drawbacks to this approach include:  (1) the defragmentation process in S1000 is computationally intensive and requires extensive periods of CPU and wall time; (2) defragmentation is an inefficient process since the source data is initially in an areal abstract format and then is subsequently imported into S1000, fragmented, and then defragmented to generate a CTDB-compilable areal abstract.For the SW Asia TDB, a new approach for generating CTDB-compilable areal abstracts was developed. Since the source data for the ocean and landform area abstracts are originally constructed in a GIS data base using ARC/INFO, design decisions changed focus from S1000 to ARC/INFO for areal abstract generation. The ocean abstract cover is generated with polygonal topology using the high tide mark derived from original coastline source data. The landform abstract cover is generated with polygonal topology from a landform cover that is a composite of surface materials and geomorphological source data.  The level of nesting (“defrag” level) is assigned based on the topological relations inherent in the ARC/INFO vector georelational data model.Future Directions for GIS Applications to Terrain Database GenerationThe STOW SW Asia TDB is an example of how vector, imagery and DEM source data can be converted, merged and assimilated into a single, coherent and unified data model for representing the Synthetic Natural Environment.  It demonstrates the capabilities and flexibility of GIS systems to assimilate and synthesize data from many sources and resolve conflicts arising from utilizing data from multiple sources at different resolutions and of differing data quality.  Forthcoming programs such as the Joint Simulation System (JSIM) Enterprise will encompass larger regions than STOW SW Asia with similar requirements for terrain database features and functions.  The availability of source data in a timely and cost effective manner is a challenge in terrain database development.  GIS offers the capabilities of assimilating and integrating the best available data for a geographic region of interest while meeting the appropriate programmatic requirements for representing of the Synthetic Natural Environment.AcknowledgmentsNumerous individuals and organizations contributed to the development of the SW Asia terrain database.  Organizations include, DARPA, US Army Topographic Engineering Center, TASC, SAIC, University of Washington, Mitre, and BDM International.  Special thanks are due to George Lukes (DARPA), Karl Koklauner, Nancy Gardner, Dr. Jack Rinker and Jack Huntley (USATEC), Glenn Goodman, Steve Haes, Kimberly Neff  and Barron Gibson (BDM), Farid Mamaghani (IDA), Tom Stanzione and Forrest Chamberlain (TASC), Dr. James Bardeen (University of Washington), and Dr. Paul Birkel (Mitre).ReferencesD. Miller, ,T. Miller, C. Cornish, J. Rourke, and K. Cauble: “STOW Southwest Asia Terrain Data Base”, Proc. Simulation Interoperability Workshop, paper number 98S-SIW-165, Orlando, March 1998J. Bardeen and D. Miller: “Removing Artifacts from Digital Elevation Data”, Proc. Simulation Interoperability Workshop, paper number 98S-SIW-176, Orlando, March 1998.Author BiographiesDr. Charlie Cornish is a staff software engineer with Lockheed Martin Information Systems Advanced Technology Center in Bellevue, WA. He was responsible for evaluation and configuration management of the source data, integrating the terrain and bathymetry DEMs, generating the coastline feature, developing an automated bridge placement procedure, and clipping landforms in ARC/INFO.Timothy Miller is a staff software engineer with Lockheed Martin Information Systems Advanced Technology Center in Bellevue, WA. He was responsible for the GIS processing and surface line development for all integrated terrain features.Michael McInnis is an engineer at the Advanced Simulation Laboratory, Lockheed Martin Information Systems.  He contributed with the development of GIS processing of road and obstacle networksDr. Dale D. Miller is the manager of the Advanced Simulation Technology group at Lockheed Martin Information Systems Advanced Technology Center in Bellevue, WA. He was the principal investigator and program manager of this terrain data base technology development project. Water Depth Average (WDA), Gap Width Distance (GWD), Bank Height Right (BHR), Bank Height Left (BHL), Bank Gradient Right (BGR), Bank Gradient Left BGL).