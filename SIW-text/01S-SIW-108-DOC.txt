In-stride Computations of the Marine Environment in Support of FBE-H B. Nicholas Kim, Alan F. Blumberg, Ph.D., and Sean O’NeilHydroQual, Inc.One Lethbridge PlazaMahwah, NJ 07430(201) 529-5151nkim@hydroqual.comChristopher ScannellNaval Research Laboratory4555 Overlook Ave, SWWashington, DC 20057(202) 767-1127scannell@ait.nrl.navy.milKeywords:SNE, FBE-H, JSAF, Data Assimilation, Hydrodynamics, In-stride Computations, Ocean Environment, ForecastingABSTRACT: This paper describes a system developed to provide a consistent “real-time” Simulated Natural Environment (SNE) for the Joint Semi-Automatic Forces (JSAF) architecture, in support of the Naval War College’s Fleet Battle Experiment-Hotel (FBE-H) in August-September 2000.  The experiments were conducted in the coastal ocean off the coast of Panama City, Florida in the Gulf of Mexico.  In past exercises the rapidly varying and three-dimensional structure of the coastal ocean environment has been pre-calculated, or presented as a static environment.  A new system has been developed which allows for in-stride simulations of the complex interactions between the atmosphere, ocean and the regional bathymetry.The new system automatically retrieves and processes modeled atmospheric data, preparing it for use by a coastal ocean model.  The input to the ocean model is checked to insure that there are no gaps or errors in the data. The ocean model then simulates the complex structure of temperature, salinity and currents in the water column as well as the sea surface elevation (tide), surface waves and turbidity.  The results of the ocean model simulation are also compared with field data when possible and then served by an HLA-compliant environmental data server to a network of JSAF stations.  Serving in-stride environmental parameters allows for a level-playing field between live players, man-in-the-loop participants and simulated entities.  In addition to the in-stride ocean simulation, the coastal environment was also forecast since atmospheric forcing data was predicted forward in time as well as in-stride.  Such forecasting capabilities will allow future tactical decision aids and planning tools to factor dynamic environmental conditions into fleet operations.1.	IntroductionThe Fleet Battle Experiments (FBE’s), run by the Navy Warfare Development Command (NWDC) augment live forces with a virtual environment.  The virtual environment includes simulators and a simulation that stimulates live C4I systems through a special purpose interface.  The virtual environment includes a synthetic natural environment composed of ephemoral, terrain, atmosphere, and oceanography effects.  The current state of the art in ocean environmental representation is static look-up tables.  Static environments lack utility for operational experimentation that combine live and virtual forces, such as FBE’s, because it is simplistic and highly idealized.  In order to better support operational experimentation, an appropriate ocean environment must be delivered to the undersea sensors and systems of interest to the experiment.  The objective of this effort is the establishment of a system to produce Synthetic Natural Environments (SNE) based on specific standards in which effective simulations could be conducted.The natural environment is to include data and environmental models.  In terms of data and environment, we mean oceanographic conditions, including sea state, water depths, turbidity, and the three-dimensional fields of salinity, temperature, and velocity.  This includes the use of wave and ocean circulation models to provide these data.Focus/PurposeIn this paper, we describe the construction of a utility for providing an SNE to the Joint Semi-Automatic Forces (JSAF) in support of Fleet Battle Experiment-Hotel (FBE-H) conducted by the Naval War College for mine hunting sonar modeling in August-September 2000.  It is to provide realistic, “in-stride”, simulations of the three-dimensional sea state including temperature, salinity, currents and water levels in the offshore region in the Gulf of Mexico off Panama City, Florida.3.	Hydrodynamic Model SetupGrid DesignThe FBE-H area is concentrated on the shallow waters off the coast of Panama City, FL. An orthogonal curvilinear computational grid is designed as such to achieve the high resolution in the area of interest and maintain low resolution elsewhere (Figure 3.1). One of the distinctive advantages of the use of the orthogonal curvilinear grid system is the economy of the computational resources [1]. The grid has 81 cells in offshore direction and 105 cells in the along-shore direction. The grid system also includes the approaches to the Panama City harbor and the three embayments within St. Andrew Bay. The horizontal grid spacing ranges from 200 meters in the narrow shipping channels in St. Andrew Bay to about 5 km in the offshore areas. The grid spacing in the nearshore FBE-H area is about 500 m. The model domain covers an area approximately 150 km by 100 km. The vertical resolution is achieved with 11 sigma levels to account for the important physical processes in the vertical plane. The model grid depth is configured with 3 arc second resolution (approx. 160m) gridded bathymetry data. 3.2	Numerical Models3.2.1	Hydrodynamic ModelTo predict the actual variations in ocean circulation patterns and the salinity and temperature structures, we must utilize models that formulate the conservation of momentum, salt, heat, and mass in their most basic forms.  For this work, we use a version of the Princeton Ocean Model (POM), known as ECOM (Estuarine and Coastal Ocean Model). This three-dimensional, time-dependent hydrodynamic model POM, developed by Blumberg and Mellor [2], is being used by over 500 research groups around the world and has been applied to estuarine [3], [4], coastal [5], [6], [7], [8] and oceanic [9] bodies of water.  In ECOM, differential equations are used that account for local variations of a parameter, changes due to non-linear advective and turbulent diffusion, pressure effects due to the three-dimensional differences of density (i.e., salinity and temperature), and the temporal and spatial changes in the free surface height (tides, wind-induced setup or setdown, etc.) [2].ECOM accounts for many sources and sinks in the various variable equations.  These include time-varying river inflows, surface fluxes of momentum (rainfall), and heat fluxes through sea-air interface. The ECOM model has also been adapted to include the major wave effects ([10], [11]). By providing wave model results (wave amplitude, wave period, and direction of propagation), ECOM can account the wave-enhanced bottom friction (above and beyond the typical bottom friction), currents induced by wave breaking, and currents resulting from the fact that wave motion is not entirely circular (referred to as Stokes drift).  The model includes a free surface, a split mode time step, and solves the following equations for the estuarine velocity Ui = (U,V,W), temperature T, and salinity S: EMBED Equation.3  	(1) EMBED Equation.3  	(2) EMBED Equation.3  	(3) EMBED Equation.3  	(4)The vertical mixing coefficients, KM and KH ,in (2) - (4) are calculated using the Mellor and Yamada [12] turbulence closure scheme as modified by Galperin et al. [13], whereas the horizontal diffusion terms FU, FV, FT and FS in (2) - (4) are calculated using a Smagorinsky [14] horizontal diffusion formulation [15].  The formulation uses coefficients AM and AH which are embedded into the horizontal diffusion terms (AM from FU and FV; AH from FT and FS).  They are taken to be equal and are modeled according to the Smagorinsky formulation involving a coefficient, CS., which relates the horizontal eddy coefficients with the horizontal deformation of the flow field.  The hydrostatic approximation is used to provide the pressure for Equations (1) and (2).  It is written as: EMBED Equation.3  	(5)where P is pressure, Patm is the atmospheric pressure, z is water depth, ((x,y) is the free surface elevation, (0 is a reference density, and ( = ((T,S) is the density.  The basic equations, (1) through (5), are cast into a bottom-following sigma coordinate system and solved with finite difference approximations as detailed in Blumberg and Mellor [2]. The adjustable parameter in the model, set by the problem at hand, is the Smagorinsky coefficient, CS. It is selected based upon model validation simulations.3.2.2	Wave ModelSurface wave fields are significantly different in coastal regions.  Deepwater wave models commonly assume a fully developed sea under the wind conditions at a given time, but the physics of wave generation in deep water typically cannot be directly applied to littoral regions.  In shallower water, we also must consider dissipation, diffraction, and refraction.  At the same time we must take into account that deepwater waves translating into a shallow water region will steepen and eventually break, modifying the wave field while transferring energy from the wave field to the water column.  Wave-generated flow fields result, sometimes including strong longshore and offshore jets of water.ECOM incorporates a wave model developed by the NOAA Great Lakes Environmental Research Laboratory [16]. This is a parametric-type model based on the conservation of momentum applied to deep water waves (ratio of water depth to wave length greater than 0.5). Output from the model is the directional wave spectra, at each grid point, from which is derived significant wave height, peak period and peak direction.3.3	Incorporation of DataIn order to operate a numerical model, various forcing data are required: sea surface elevations, temperature, and salinity along the open boundaries, surface wind data, and sea/air heat exchange parameters. For sea surface elevations, the Grenoble Ocean Tide Model [17] data are utilized along the boundaries. This tidal model generates the predicted hourly tidal heights for each of the boundary cells. The Gulf of Mexico Model (GOM) data archives are used to prescribe time varying temperature and salinity boundary conditions. The GOM archive provides daily horizontal and vertical temperature and salinity data along the boundary locations.  As for the surface wind stress and sea/air heat exchange parameter, the Coupled Ocean/Atmosphere Mesoscale Prediction System (COAMPS) output is used. The COAMPS output comprised of 3 hourly nowcast/forecast data of wind speed and direction, air temperature, barometric pressure, and relative humidity (Figure 3.2).An automated input data processing protocol is developed to operate the ocean nowcasting/forecasting system for the Panama City area during the FBE-H. Since all the input data except the COAMPS output are readily available, most of the scripting procedure deals with the assimilating COAMPS data into ECOM input format. The NAVOCEANO office at Stennis Space Center provides a set of 60 hours worth of nowcast/forecast of COAMPS output. These data are automatically delivered to HydroQual's FPT data server every morning around 5 o'clock during the FBE-H. The detailed flow-chart of the data assimilation processes are shown in Figure 3.3. 4.	Calibration and ValidationEvery model result should be verified to ensure the validity of the computations. Systematic skill assessment procedures are developed to monitor the daily computation of ocean environment in the FBE-H area. Time series of sea surface elevations, salinity and temperature computations at depth from selected locations are plotted routinely. NOAA provides real-time sea surface elevations at numerous tidal monitoring sites around the coastal U.S. (http://co-ops.nos. noaa.gov/data_res.html). There are two NOAA monitoring stations within the modeling domain: one inside St. Andrew Bay and the other one near Panama City Beach which is on the Gulf-side. Time series of model computed sea surface elevations and NOAA's real-time data at these two locations are compared every day (Figure 4.1).  The computed and observed sea surface elevations agree very well at both locations during the FBE-H. There is no real-time data on currents, temperature or salinity in the area during the demonstration period. The verification of the model results of these ocean parameters is yet to be done.  4.1	Data Transfer to JSAFAt the completion of the daily nowcast/forecast of the ocean environment, the model output, which is stored in netCDF format, is electronically transferred to the Joint Training, Analysis and Simulation Center (JTASC) in Suffolk, VA to be implemented in JSAF. The netCDF format was selected for the output format because of the easy access of the data and the platform independent data structure.The environmental server, Total Atmosphere, Ocean, Space (TAOS) Environmental Services, was used to ingest the ECOM model output and distribute it to RTI compliant federates.  TAOS, developed in the Synthetic Theater of War (STOW) Advanced Concept Technology Demonstration (ACTD), was designed to support Live Mode Operation, regularly monitoring an FTP site for new environmental data for ingestion into its internal environmental database while simultaneously publishing data on a fixed schedule to the DIS/HLA federation.  The Integrator portion of TAOS was extended by adding a Decoder object to read netCDF formatted data and a Receiver object to manage ECOM model output ingestion into the TAOS database.  JSAF stations, as federates participating in the simulation, received the In-Stride model output, and mine-warfare entities within JSAF used this high resolution, dynamically changing environmental data to calculate the probability of detection of nearby mines.5.	Impacts/Lessons LearnedA stand-alone AVS-based application was used during FBE-H to visualize the temporal and spatial high-resolution ECOM model output.  This three dimensional animation of the in-stride computations of the marine environment off Panama City attracted a great deal of attention throughout the fleet battle experiment and emphasized the importance of providing a consistent, real-time synthetic natural environment for simulation-supported operations.  Graphs comparing measured sea surface elevations with model calculations were instrumental in demonstrating the accuracy of the in-stride computations.  However, the lack of real-time observed data for currents, temperature, and salinity limits the full validation of the model results.Of particular note was the interest many fleet officers demonstrated in the tactical significance of the ECOM model calculations.  While the in-stride computations were used in FBE-H to ensure that simulated entities were seeing conditions consistent with those impacting real fleet platforms and systems in the same exercise, many visitors pointed out that the forecasting capabilities of the model could be very valuable for tactical mission planning. Suggested applications included tactical decision aids for covert mine laying and deployment of underwater, unmanned vehicles. Development of the three-dimensional animations of the in-stride computations highlighted the importance of careful attention to the values of the model output at the boundaries and a clear delineation of the grid cells that fall outside the water region.  In addition, future visualizations of the ocean environmental parameters would be much improved by the addition of a graphical representation of the coastline to provide the audience with a spatial point of reference, even though this terrain is outside the data being modeled.Future participation in Fleet Battle Experiments will require switching from TAOS to its successor, the Ocean Atmosphere Space Environment System (OASES) as this is the only available environmental data server that is RTI 1.3NG compatible.  Making this transition is partially jeopardized by the current lack of support in OASES for Live Mode operation and may require extending the integrator portion of OASES, EDI, to permit the reading of netCDF-formatted input files.Support for curvilinear orthogonal grids could be added to the environmental data server.  The lack of such support in TAOS required the predistribution of the latitude and longitude of each ECOM grid cell to all JSAF stations.  The in-stride model output was then ingested by TAOS as if the parameters were modeled on a uniform rectilinear grid and distributed to the JSAF stations as gridded weather data.It will also be necessary to begin considering issues of bandwidth usage.  Distributing all the ocean parameters of interest for the simulation each hour in a single burst was only possible in FBE-H because the area of interest was sufficiently small.6.	References[1]	Blumberg, A. F. B.N. Kim, S. O'Neil, J.K.Lewis, P.J. Stein, S.D. Rajan, R.L. Schaffer, M.T. Calef, T. Curtin, S.K. Numrich, W. Smith, P. Maassel, Use of Orthogonal Curvilinear Grids for the Representation of the Littoral Ocean Environment SIW Spring 2000, Paper No. 00S-SIW-118[2]	Blumberg, A. F. and G. L. Mellor, 1987.  A description of a three-dimensional coastal ocean model. Three Dimensional Coastal Models. Coastal and Estuarine Sciences, 4, N.S. Heaps (ed.), Amer. Geophys. Union, Geophysical Monograph Board, 1-16. [3]	Blumberg, A. F. and D. M. Goodrich.  1990.  Modeling of Wind-Induced Destratification in Chesapeake Bay.  Estuaries 13:1236-1249.[4]	Blumberg, A. F. and D. W. Pritchard.  1997.  Estimates of the Transport Through the East River, New York.  Journal of Geophysical Research 102:5685-5703.[5]	Blumberg, A. F., R. P. Signell and H. L. Jenter.  1993.  Modeling Transport Processes in the Coastal Ocean.  Journal of Marine Environmental Engineering 1:3-52.[6]	Chen, C. and R. C. Beardsley.  1995.  A Numerical Study of Stratified Tidal Rectification over Finite-Amplitude Banks.  Journal of Physical Oceanography 25:2090-2128.[7]	Chen, C. and R. C. Beardsley.  1998.  Tidal mixing and cross-frontal particle exchange over a finite amplitude asymmetric bank:  A model study with application to Georges Bank.  Jour. of Marine Research 56:1163-1201.[8]	Allen, J. S., P. A. Newberger and J. Federiuk.  1995.  Upwelling Circulation on the Oregon Continental Shelf.  Journal of Physical Oceanography 35:1843-1889. [9]	Mellor, G. L. and T. Ezer.  1991.  A Gulf Stream Model and an Altimetry Assimilation Scheme.  Journal of Geophysical Research 96:8779-8795.[10]	HydroQual, Inc., 1999.  “Hydrodynamics, Sediment Transport and Sorbent Dynamics in Green Bay”, submitted to Remediation Technologies, Inc. for Wisconsin Dept. of Natural Resources.[11]	Lewis, J. K., A three-dimensional ocean circulation model with wave effects. Estuarine and Coastal Modeling V (M. Spaulding and A. F. Blumberg, eds.). Am. Soc. Civil Eng., 584-600, 1998.[12]	Mellor, G.L. and T. Yamada, "Development of a Turbulence Closure Model for  Geophysical Fluid Problems," Rev. Geophys. Space Phys., 20, 851875, 1982.[13]	Galperin, B., L. H. Kantha, S. Hassid and A. Rosati.  1988.  A Quasiequilibrium Turbulent Energy Model for Geophysical Flows. Journal of Atmospheric Science 45:5562.[14]	Smagorinsky, J.  1963.  “General Circulation Experiments with the Primitive Equations, I.  The Basic Experiment.”  Monthly Weather Review, 91, 99-164.[15]	Mellor, G. L. and A. F. Blumberg.  1985.  Modeling Vertical and Horizontal Viscosity and  the Sigma Coordinate System.  Monthly Weather Review 113:13791383.[16] 	Donelan, M.A. 1977. A Simple Numerical Model for Wave and Wind Stress Application. Report, National Water Research Institute, Burlington, Ontario, Canada, 28pp[17]	Blayo, E., T. Mailly, B. Barnier, P. Brasseur, C. Le Provost, J. M. Molines and J. Verron, Complementarity of ERS-1 and Topex/Poseidon altimeter data in evaluating the oceanic circulation: assimilation in a model of the North Atlantic, Journal of Geophysical Research, submitted, 1996.7.	AcknowledgmentsAuthors are greatly indebted to the support of Thomas Curtin of ONR, S. N. Numrich, William Smith of NRL, Paul Maassel of VisiTech, Inc. during the study. Special thanks extend to Carl Szczechowski of NAVOEAN for providing real-time COAMPS output and Dynalysis of Princeton for the use of Gulf of Mexico model data archive. 8.	Author BiographiesNICHOLAS KIM is a Project Manager at HydroQual, Inc.  He has over 10 years of experience in the field of environmental modeling. He has performed three-dimensional modeling exercises in New York Harbor as well as conducted thermal plume studies in Lavaca Bay, Texas and Mamala Bay, Hawaii.  He also has experience modeling the thermal power plant discharge and employee training in Korea.ALAN F. BLUMBERG, Ph.D. is a principal scientist and senior vice president at HydroQual, Inc.  Dr. Blumberg has been involved in estuarine and coastal hydrodynamic circulation modeling, as well as the analysis and interpretation of oceanographic data for over 15 years.  He is the author of over 80 peer-reviewed journal articles and reports and is currently and associate editor of the American Society of Civil Engineers’ Journal of Hydraulic Engineering.SEAN O’NEIL is an engineer in the hydrodynamic modeling group at HydroQual, Inc.  He has several years of experience with hydrodynamic and sediment transport models in large lakes, estuaries and the coastal ocean.CHRISTOPHER SCANNELL works at the Naval Research Laboratory in the Information Technology Division studying parallel processing and distributed simulation systems as well as virtual reality applications.  He also has experience within the acoustics division and has participated in experiments involving ship and airplane deployed sonar devices. (footnote continued)Figure 4.1.  Comparison of observed and computed sea surface elevation.Figure 3.3.  Flow diagram of data assimilation and execution of procedures used during in-stride computation of SNE in support of FBE-H.Figure 3.2.  A sample plot of COAMPS data assimilated on ECOM grid.  This plot shows the barometric pressure and surface wind.Figure 3.1  Model Grid and FBE-H Naval Exercise Areas