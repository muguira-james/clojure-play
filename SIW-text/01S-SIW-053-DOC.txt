Advanced Technique for MRM (multi-resolution models)Satoshi SekineMakoto KanouTOSHIBA Corporation, System Integration Technology Center3-22 Katamachi Fuchu Tokyo 183-8512 JAPAN+81-(0)42-340-6418, +81-(0)42-340-6356satoshi.sekine@toshiba.co.jp, makoto2.kano@toshiba.co.jpMichihiko OgataAkira HigashideTOSHIBA Corporation, Hino Operations3-1-1 AsahigaokaHino, Tokyo 191-8555JAPAN+81-(0)42-585-3529miki.ogata@toshiba.co.jp, akira.higashide@toshiba.co.jpKeywords:MRM (multi-resolution models), multi-resolution simulation ABSTRACT: It is called multi-resolution model (MRM) that represents various kind of resolution depends on the simulation condition. A multi-resolution simulation system has multi-resolution models. This system is very useful to analyze an operation of huge and complex system. Multi-resolution simulation chooses the detailed resolution (entity-level) models in order to analyze the micro phenomenon, and uses the low resolution (aggregate-level) models to analyze the macro one. This technique saves the computer resources such as memory, and improves the calculation time. It was very difficult for the simulation to choose his resolution automatically and appropriately depending on transition of time and position. This paper presents a method to change the resolution of models according to the objective of analysis or the dependence between models. We will apply this proposed method to the traffic simulation and verify its usefulness.1. IntroductionMulti-resolution model(MRM) is simulation model which has various kind of resolution. MRM simulation is very useful to evaluate an ability of  huge and complex systems. Recently, There are many research and development about MRM simulation, such as the process of changing the resolution of an aggregate model by computing initial state of corresponding entity-level model.[1] MRM simulation chooses the entity-level models in order to analyze the micro phenomenon, and uses the aggregate level models to analyze the macro one. This technique reduces the time to calculation and save the computer resources.2. Background and ObjectivesWhile many MRM simulation systems have been prototyped, there is few study about the method to change the resolution of  models dynamically. This paper presents a method to change the resolution of models according to the objective of analysis or the dependence between models. We will apply this proposed method to the traffic simulation and verify its usefulness.3. MethodologyIt is very important  to decide resolution of MRM, when you simulate and analyze some systems. Although conclusion of simulation expects to be accurate with entity-level model which has high resolution, it takes much time to calculate and computer resources, such as memories and disks. On the other hand, although aggregate model which has low resolution tends to yield inaccurate conclusion, it can save the time to calculate and computer resources. So we need the method how to determine the degree of resolution  in MRM according to the target or the objectives of  system evaluation.Fig.1 is the block diagram which illustrates proposed MRM simulation system.Fig.  SEQ Fig. \* ARABIC 1 MRM Simulation SystemUser indicates the initial conditions of calculation engine and the conditions to select MRM models through the input condition part. MRM data base keeps several kind of MRM designed for the system which is an object of simulation evaluation.  Model selector choices the simulation model which has the adequate resolution according to the select conditions or the state variables calculated by the simulation engine. Display shows the conclusion of simulation. There are the following several kind of conditions to select the adequate simulation model.Directly indicate the model to use.(2) Simulation space has been divided into several zones, then relate the specific models to them. (3) Simulation time has been divided several periods, then relate the specific models to them.(4) Indicate the model to use according to the specific state variables of the simulation.This method enables to change the models dynamically according to the state variables or the environment of simulation.For example, you evaluate the calculation error which is produced by the low (aggregate) model during the simulation. When the error exceeds the specific limitation, you can reduce it by selecting higher-  resolution (entity-level) model. Then if you indicate the appropriate condition to select models, you can reduce the time to calculation or save computer resources with the adequate accuracy of  simulation calculation suited for the objective of simulation evaluation.4. Application to the Traffic SimulationWe show the example of  application to the traffic simulation. We can also think about an aggregate model for macro phenomena and an entity-level model for micro one in traffic simulation.Aggregate model in traffic simulation has no individual vehicle model, but represents a party of several vehicles or a flow in section. Traffic simulation by that model calculates an average velocity of vehicles, density in the specific section, average traffic at the specific point.On the other hand, entity-level model includes individual vehicle model and represents its behavior or the relationship, such as keeping the distance between them constantly. Traffic simulation by the entity-level model calculates the state variables of individual vehicles such as the position, velocity, trip time.4.1 Aggregate modelWe apply the block density method to an aggregate model  represented traffic flow. Block density method is a dynamic traffic simulation model. In this method, at first we divide the road (link) on which vehicles running as small parts (blocks). The second resemble the traffic flow closely to a fluid. Finally calculate the traffic between blocks based on the relationship of traffic quantity and density (Q-K relationship) and  preservation law of  traffic.Each Block  i has a relationship of traffic quantity EMBED Equation.3 and density EMBED Equation.3 in fig.2. This relationship represents following equation.EMBED Equation.3   			(1)Fig.2 illustrates Q-K relationship in block i. This relationship is consists of two part of domains. One is the flee flow domain and the other is jam domain. Vehicles can be running at the rate of flee velocity EMBED Equation.3 when the traffic density is less than the critical density EMBED Equation.3 in the flee flow domain. But the density exceeds EMBED Equation.3, vehicle velocity is going down and finally stall at the jam density EMBED Equation.3 in the jam deomain.Fig.  SEQ Fig. \* ARABIC 2 Q-K relationship in block iFig.3 represents the model of the block density method. In this figure, horizontal axis indicates the distance and vertical axis indicates time. Block i has the densityFig.  SEQ Fig. \* ARABIC 3 Model representation of block density methodTime axis is discrete by the fractured time EMBED Equation.3. Traffic flow which can transit from bolock i+1 to i at time t  EMBED Equation.3represents following equations based on density at time tEMBED Equation.3 or EMBED Equation.3.if EMBED Equation.3then EMBED Equation.3	(2)if EMBED Equation.3then EMBED Equation.3	(3)if EMBED Equation.3then EMBED Equation.3(4)if EMBED Equation.3then EMBED Equation.3	(5)whereEMBED Equation.3:Traffic capacity of block i.EMBED Equation.3:Critical density of block iEMBED Equation.3:Jam density of block iEMBED Equation.3:Traffic density of  block i at time t.EMBED Equation.3: Traffic flow from block i+1 to i at time t.If the lower reaches of block is flee flow, the possible traffic from upper to lower block is decided on the capacity of lower one EMBED Equation.3. On the contrary, lower block is jam, it is equal to the equation EMBED Equation.3 correspond to density of  lower one EMBED Equation.3. On the other hand, If the upper block is flee flow, the traffic is equal to the equation EMBED Equation.3. On the contrary, lower block is jam, it is the capacity of lower one EMBED Equation.3. Then we compare the possible traffic of upper block with lower one and take the smaller one. Furthermore we have to impose the condition that the number of vehicles which transit from upper to lowerEMBED Equation.3 is less than the block margin EMBED Equation.3. 4.2 Entity-level modelEntity-level model of traffic simulation represents the vehicle dynamics and includes state variables such as position, velocity. The model also includes controller model which switches the velocity control and distance control according to the head to head distance between vehicles.Fig.4 illustrates the control method of the vehicles. Fig.  SEQ Fig. \* ARABIC 4 Vehicle ControlVehicles run toward to only the x axis direction in the block. We know the position x, velocity v, head to head distance D. The dynamics of  a vehicle is represented by the simple differential equations as follows.EMBED Equation.3		(6)WhereEMBED Equation.3:acceleration of vehicle.The acceleration of vehicle is decided according to the distance D as follows.if Dâ‰§Dcthen EMBED Equation.3.		(7)if D<Dc then EMBED Equation.3.		(8)WhereEMBED Equation.3: Reference of vehicle velocity.EMBED Equation.3:Reference of head to head distance.EMBED Equation.3: Proportional gain of velocity control.EMBED Equation.3: Proportional gain of distance control.4.3 Aggregation and disaggregationWe show how to aggregate the entity-level model to aggregate model and how to disaggregate.AggregationThe density of block i EMBED Equation.3 is calculated following equation based on the number of vehicles EMBED Equation.3 and block length EMBED Equation.3.EMBED Equation.3			(9)Traffic quantity at the exit of  block i EMBED Equation.3 is calculated following equation based on the average velocity of vehicles and the density EMBED Equation.3.EMBED Equation.3		(10)DisaggregationThe number of vehicle EMBED Equation.3 is calculated following equation based on the length of  block i EMBED Equation.3 and the density EMBED Equation.3.EMBED Equation.3		(11)The vehicle velocity v is calculated following equation according to the Q-K relationship.EMBED Equation.3			(12)Then we make EMBED Equation.3 vehicles running at the rate of v on the block i  with equal distance.5. Prototyping and Simulation ExamplesWe made a prototype of simulator to verify the proposed  MRM simulation system. The prototype was implemented as an applet of Java language.Fig.5 illustrates the class configuration of the prototype simulator.Fig.  SEQ Fig. \* ARABIC 5  Class configurationMrmSim class has methods which set the initial condition and manage the simulation such as start, stop, pause. Field class has methods which add the block density models and delete them and configure the structure of traffic network. Block class has the entity-level and aggregate models as block  unit. This class has methods which calculate the density and traffic quantity as aggregate model, and also has method which direct the vehicle model to calculate its dynamics as the entity-level model. This class also has methods of aggregation and disaggregation. Vehicle class has the methods which calculates the state variables such as velocity, position and controls the vehicle velocity and head to head distance.Fig.6 shows the GUI of the prototype simulator.Fig.  SEQ Fig. \* ARABIC 6 GUI of the prototype simulatorIn this figure, There are 5 blocks model in the center of the window. The block filled with gray color represents the aggregate model and its light and shade indicates the traffic density. On the other hand, the block which has white background represents the entity-level model and a vertical short dash corresponds to a vehicle. A remarkable vehicle has its own ID number above it. The number indicated on the left of blocks shows the simulation time. Furthermore This GUI has buttons which pause, continue and step the execution of simulation and pull down menu which select the operation modes and its select button. We show the examples of traffic simulation by the prototype simulator. There are two examples of simulation. At first the simulator selects the model according to the vehicle position. The second it select according to the traffic density. Selecting  according to the vehicle positionWhen you want to know the behavior of  the specific vehicle, you only have to inspect it and around it as entity-level simulation models. It's enough to simulate as the aggregate models far from that vehicle.Fig.7 shows the conclusion of  the simulation in which the models around the specific vehicle are selected as entity-level models.Fig.  SEQ Fig. \* ARABIC 7 Select according to the vehicle positionIn this simulation the vehicle (No.7) entered form the left side and the aggregate model block1 was  disaggregated to the entity-level model at time 50.0 sec. After this the lower block2 to 5 were converted the entity-level model as the vehicle proceeded. In this case the distance between the vehicle and the converted lower block was set up 50 m. Selecting according to the traffic densityWhen you analyze the traffic flow,  you have to investigate the part of  a traffic jam in full detail. So it's very useful to convert the aggregate model block which exceeds the specific traffic density to the entity-level one and observe the individual vehicle behavior in it.Fig.8 shows another conclusion of the simulation. In this case, the aggregate model block which exceeds the density 0.7 EMBED Equation.3, this means the head to head distance is 14.3 m, will convert to the entity-level model. The traffic jam occurs at the narrow blocks, this represents its traffic capacity is small, and spreads upper (left) blocks. In proportion as this, the aggregate model block converts to the micro one. So you can acquire the detail conclusion about only a part of traffic jam.Fig.  SEQ Fig. \* ARABIC 8 Select according to the density5. Conclusion and Future worksIn MRM simulation, if you set up the adequate condition to select an aggregate and an entity-level model, you can reduce the time to calculation or save computer resources. In this paper, first we proposed the MRM simulation system which determine the resolution of the models according to state variables of  simulation objects or environment situations. Secondly we apply this proposed method to the traffic simulation and present an aggregate and an entity-level model. Finally we made the prototype of simple traffic simulator and show two examples of simulation which verify the usefulness of this method.For the future, we apply this method  to more complex traffic networks and will analyze the amount of calculation and computer resources concretely. Furthermore we consider only about traffic problem but also another fields.6. References[1]	R.W.Franceschini, A.S.Wu, A.Mukherjee: â€œComputational Strategies for Disaggregationâ€  Proceeding of  the ninth Conference on Computer Generated Forces and Behavioral Representation,   pp. 543-554, May 2000.[2]	M.Kuwahara, T.Yoshii, R.Horiguchi: â€œReproduction of  Traffic Flow with Block Density  Methodâ€ Traffic Engineering, Japan Society of Traffic engineers, Vol.32 No.4 pp39-43 1997.Author BiographiesSATOSHI SEKINE is an Simulation System Analyst at the System Integration Technology Center, TOHISBA Corp. Tokyo, Japan. He got his master degree major in Electric and Electrical Engineering from Tokyo Institute of Technology in 1989. He is developing the concepts and prototype simulator of  semi-automated forces, transportation and traffic.MAKOTO KANO is a specialist at TOSHIBA Corporation in Tokyo, Japan. He received the M.E. degree in biophysical engineering from Osaka University in 1990. His research interests are simulation, planning, and learning systems.MICHIHIKO OGATA is a system engineer who works for TOSHIBA Corporation. He got his M. S. degree major in Computer Science from Ohio University Graduate School in 1992. He is responsible for the prototype development using method of Modeling and Simulations. He has been involved withengineering support and consultation services in the area of M&S. He is also working as technical staff for design, implementation, and system integration efforts of various fields.AKIRA HIGASHIDE is a Specialist at TOSHIBA Corporation pursuing the development of command and control systems. His research interests includes applying Modeling & Simulations to all kinds of systems. He completed his Master's in Electrical Engineering, Graduate School of Engineering, Kanazawa University in 1987. He is a member of IEEJ.