Applying SOA Net-Centric Enterprise Security Services to Distributed M&SScott HolbenGestalt, LLC9432 Baymeadows Road Suite 155Jacksonville, FL 32256904-899-0290sholben@gestalt-llc.comKeywords: Information Assurance, DIS, HLA, TENA, SOA, SIP, MashupABSTRACT Because of the importance of the Global Information Grid (GIG) to the Department of Defense (DoD), it appears numerous SISO communities anticipate the DoD will pay for a new way to converge the Distributed Interactive Simulation(DIS), High Level Architecture (HLA) and the Test and Training Enabled Architecture (TENA) if Services Oriented Architecture (SOA) technology is used. SOA technologies embrace network services that are 1) platform neutral, 2) language neutral, 3) interoperable, 4) loosely coupled, 5) encapsulated and 6) support dynamic find-and-bind capabilities. This emerging distributed Modeling, Simulation and Analysis (MS&A) SOA technology must provide wire-level interoperability using existing Internet protocols deployed on real Command and Control (C2) systems. The new distributed MS&A infrastructure must also support net-centricity, which requires supporting the following four Net Ready-Key Performance Parameters (NR-KPP): 1) compliance with the Net-Centric Operations and Warfare-Reference Model (NCOW-RM), 2) supporting DoDAF integrated architecture products, 3) compliance with Key Interface Profiles, and 4) verification of compliance with DoD Information Assurance (IA) requirements. To date DIS, HLA and TENA have ignored the fourth NR-KPP by not providing any innate security services. The-next generation distributed M&S standard used by the DoD must support IA by providing appropriate IA controls identified in the DoD 8500 IA regulations to satisfy the fourth NR-KPP.This paper will identify a convergence strategy to enable existing distributed MS&A standards to use Net-Centric Enterprise Services for Security (NCES-Security) by identifying an emerging four layer SOA model that can be integrated with NCES Security services with SIP/S, XMPP, HTTP/S and S/RTP protocol bindings.  With the proper mix of popular Web protocols, SOA technology, publish, subscribe, notify, conferencing and the judicious application of NCES Security Policy Enforcement Points (PEP) and Policy Decision Points (PDP), net-centric distributed MS&A will become a reality in the next few years.  The emergence of this new technology will not rely solely on either DIS, HLA or TENA, but it will be interoperable with them all and will not require the development of specialized distributed MS&A Multi-Level Security (MLS) guards (e.g., RMG, DTNG) but will instead leverage net-centric commodity firewalls supporting Web Services Description Language (WSDL) PEP interface.  WSDL PEP interfaces are being supported by more firewall vendors and they appear to be the access control cornerstone for next generation net-centric C2 MLS guard technology.  Now, after ten years, the next big epoch for distributed MS&A is upon us.  *Effort sponsored in whole or in part by the Air Force Research Laboratory, USAF, under Memorandum of Understanding/Partnership Intermediary Agreement No. FA8652-03-3-0005 with the Wright Brothers Institute, Inc.  The U.S. Government is authorized to reproduce and distribute reprints for Government purposes notwithstanding any copyright notation thereon. The views and conclusions contained herein are those of the authors and should not be interpreted as necessarily representing the official policies or endorsements, either expressed or implied, of the Air Force Research Laboratory.1. IntroductionFlanked by this introduction and a conclusion, this paper has five core sections. Section 2 unambiguously defines net-centricity and traces DoD acquisition net-centricity requirements to applicable directives and instructions. The third section identifies two sets of IA capabilities that the distributed MS&A community needs to satisfy for the DoD acquisition community. The fourth section identifies three complementary SOA-based information assurance reference models, and the fifth section defines what an Enterprise Service Bus (ESB) is and why most ESB implementations are not useful when trying to integrate entity behaviors into virtual or live simulation events. The sixth section identifies and describes an emerging secure, streaming SOA mashup model that has the potential to change the way we think about distributed MS&A and C2 communication systems. Our conclusion is very optimistic about converging SOA ESB technology with Session Initiation Protocol (SIP) Voice over Internet Protocol (VoIP) technology.2. Net-centricity“Net-centricity is the power of digital networks to distribute information instantly and without borders. Characterized by global connectivity, real-time collaboration and rapid and continuous information exchange, net-centricity is a ubiquitous force reshaping every facet of our markets, organizational cultures, and personal lives at the dawn of the twenty-first century.”[1] “Net-centricity is a robust, globally connected network environment (including infrastructure, systems, processes, and people) in which data is shared timely and seamlessly among users, applications, and platforms. Net-centricity enables substantially improved military situational awareness and significantly shortened decision-making cycles. Net-centric capabilities enable network-centric operations and Net-Centric Warfare (NCW).”[2] DoD net-centricity is characterized and identified by four features: 1) Reach – communication across space, with time being the limiting factor for success; 2) Richness – the set of capabilities that can be brought to bear within a unit of time; 3) Agility – anticipate or react and successfully adapt to environmental changes; and 4) Assurance – the information security obtained by applying information security regulations and Defense-in-Depth (e.g., protect, detect and react) robustness strategy to design, deploy and operate IT systems [3]. Net-centricity has the following four prevailing views: data (e.g., data modeling and repository technologies), services (e.g., application protocols and applications), IA (e.g., security services) and transport (e.g., UDP, TCP, IPv6 and physical networking pipes). These views are important enough for DoD to create corresponding strategies: Net-Centric Data Strategy, NCES Strategy, IA Strategy and the IPv6 Adoption Strategy. Global multinational net-centricity cannot be achieved without systems achieving a degree of interoperability.  Net-centricity cannot be achieved without first achieving interoperability; however, achieving interoperability is not sufficient to achieve net-centricity. The “Applicability and Scope” section of DoD Directive 4630.5, “Interoperability and Supportability of Information Technology (IT) and National Security Systems (NSS),” will apply to future DoD-sponsored Simulation Interoperability Standards Organization (SISO) standards development [4].  This directive will force the Joint Capability Integration & Integration Development System (JCIDS) process to be used by all major IT programs and requires them to produce an Information Support Plan (ISP) to ensure interoperability and supportability needs are managed, evaluated and reported over the lifecycle of the IT and National Security System (NSS). An ISP documents the system’s information and interoperability dependencies and supportability requirements.  The initial ISP is submitted prior to an acquisition program’s Milestone B and is used in combination with the Capability Development Document (CDD) and Capability Production Document (CPD) to develop the Test and Evaluation Master Plan (TEMP). Section 6.2.2.5 of DoDI 4630.8 provides instructions for preparing an ISP, and section 6.3.2.1 gives its definition [5].  DoDD 4630.5 also requires the JCIDS Directive to define NR-KPPs [4].From a J-6 “JITC Interoperability Certification Process” briefing [6], NR-KPPs are applicable to:Acquisition Category (ACAT) IT and NSS ProgramsNon-ACAT IT and NSS ProgramsFielded IT and NSS ProgramsThe following two definitions were extracted from DoD JCIDS documentation for those unfamiliar with what a KPP is.Key Performance Parameters (KPP) - Those minimum attributes or characteristics considered most essential for an effective military capability. KPPs are validated by the JROC for JROC Interest documents, and by the DoD Component for Joint Integration or Independent documents. CDD and CPD KPPs are included verbatim in the APB.Acquisition Program Baseline (APB) - Each program’s APB is developed and updated by the program manager and will govern the activity by prescribing the cost, schedule and performance constraints in the phase succeeding the milestone for which it was developed.JCIDS Directive CJCSI 3170.01E defines the NR-KPPs that will be mandatory elements of the CDD and the CPD [7]. Section 4.C of CJCS Instructions 6212.01D “Interoperability and Supportability of Information Technology and National Security Systems” unambiguously identifies four mandatory NR-KPP elements [8]. The grounds for terminating an IT or NSS acquisition program can be easily established if the following four NR-KPP elements are not satisfied by such programs.Compliance with the Net-Centric Operations and Warfare (NCOW) Reference Model (RM)  HYPERLINK "https://disain.disa.mil/ncow.html" https://disain.disa.mil/ncow.html Supporting Integrated architecture products Department of Defense Architecture Framework (DoDAF)GIG Architecture, Version 2.0, 9 December 2003 at  HYPERLINK "https://disin.disa.mil/ncow.html" https://disin.disa.mil/ncow.html Compliance with applicable Global Information Grid (GIG) Key Interface Profiles (KIPs) HYPERLINK "http://kips.disa.mil" http://kips.disa.mil – DISA maintains completed GIG KIPs in the DoD Information Technology Standards Registry (DISR)Verification of compliance with DoD IA requirementsDoDD 8500.1,  HYPERLINK "http://www.dtic.mil/whs/directives/corres/html/85001.htm" http://www.dtic.mil/whs/directives/corres/html/85001.htm  DODI 8500.2,  HYPERLINK "http://www.dtic.mil/whs/directives/corres/html/85002.htm" http://www.dtic.mil/whs/directives/corres/html/85002.htm  DODI 8580.1,  HYPERLINK "http://www.dtic.mil/whs/directives/corres/html/85801.htm" http://www.dtic.mil/whs/directives/corres/html/85801.htm DODI 5200.40,  HYPERLINK "http://iase.disa.mil/ditscap/index.html" http://iase.disa.mil/ditscap/index.html End-to-End IA Component of the GIG Integrated Architecture,  HYPERLINK "https://gesportal.dod.mil" https://gesportal.dod.milNet-Centric IA Strategy,  HYPERLINK "https://gesportal.dod.mil" https://gesportal.dod.mil.For an IT system to be considered net-centric, its services must be interoperable, discoverable, collaborative and effective. Services will be interoperable by adopting and complying with Internet standards and satisfying the four NR-KKPs discussed above. (JITC or AFCA accreditation will be required to certify interoperability.) Services can be made discoverable by defining Web Services Description Language (WSDL) interfaces and posting the interface instances in a Universal Description Discover and Integration (UDDI) repository to provide dynamic find-and-bind services.  Services are collaborative if they can be associated with Communities of Interest (COI) to enhance the value of information exchanged between users. Services are effective when they deliver more value per bit as determined by an objective Measure of Effectiveness (MOE) associated with the business process value chain. For example, during any one of the seven identified value chain distributed MS&A steps used by the Air Force Integrated Collaborative Environment, if you don’t want to leave a classified voicemail, why call someone on a classified phone when a classified buddy list presence service indicates that person is not available to communicate by a classified phone service?3. Distributed MS&A Net-centricity Information Assurance RequirementsThe fourth NR-KPP requires compliance with the proper Information Assurance controls attachments specified by DODI 8500.2, in particular DODI 8500.2 attachments three and four for the acquisition community. The responsibilities for these IA controls and those belonging to the NISPOM, JAFAN 6/3 and DCID 6/3 regulations should be assigned to enterprises, facilities, roles, networks, protocols, firewalls/guards, servers and applications.  This will help ensure the final architectural solution satisfies IT and NSS IA requirements. The trick for SISO will be for it to gain a firm understanding how responsibilities should be delegated predominantly to personnel roles, networks, protocols, firewalls/guards, servers and applications. To date, the simulation standards have focused almost exclusively on physical perimeter security models using guards [9]. Within a network’s perimeter, the confidentiality Protection Level (PL) security services typically have a peak rating of PL1. Since there are no explicit identification and authentication (I&A) services, nor are any accounting services defined for DIS and HLA. Additionally, TENA currently does not have any I&A services implemented; this makes it difficult to move security service responsibilities-found protocols such as HTTP/S, SIP/S and XMPP into servers and applications.  The C2 community’s adoption of Web and SOA technologies allows them to leverage the IA-enabled IT security services provided by servers and applications. However, the C2 community desires to move even more security responsibilities into server and network infrastructure to lighten the load on accrediting new C2 applications.  This will require the C2 community to raise the security bar one more notch.The distributed MS&A experimentation, acquisition, test and training communities must raise their security service bar two notches to keep pace with the C2 community on the security front. The first notch is required to catch up. It will add explicit I&A, accounting and labeling security services. The second notch is to move more security service responsibilities into the network itself to minimize application development accreditation delays for deployment into PL2-rated and PL3-rated computer hosts. Technically, extensions to the DIS, HLA and TENA standards must be created to satisfy the requirements for the first security notch in order for them to be considered net-centric technologies that may be easily approved by a Designated Approval Authority (DAA) for operation on networks such as the GIG. 4. Three SOA-based IA Security Models  Extensions should be added in such a way to allow the DIS, TENA and HLA standards to provide loosely coupled, moderately integrated or tightly integrated security services using SOA technologies. These three forms of integration should allow SOA services to provide PL1, PL2 and PL3 confidentiality services respectively to DIS environments and may one day provide similar services for TENA and HLA environments. The idea behind defining security profiles is to identify a set of security services that will be of value to the IT system’s users. If these three IA security models are developed sufficiently, they will lead to three formalized security profiles for distributed MS&A enabled-SOA frameworks to support. The models below are being driven primarily by the Air Force acquisition community. Loosely coupled security services will allow simulation resources to be persisted across events because they can be used to satisfy regulatory PL2 need-to-know and accounting services at federated enclave boundaries. These security services can be implemented with the “dedicated relay approach or shim approach,” identified in paper 06F-SIW-110, when integrated with NAT firewalls and proxy servers to enforce access controls [10]. Apart from protecting intellectual property, there is a very compelling business case to support this capability. The Distributed Missions Operations Center (DMOC) Virtual Flag events occur every three months. Persisting simulation resources across event time-boundaries and allowing them to be accessed with Uniform Resource Identifier (URI) addresses could radically reduce event planning and execution expenditures while also increasing the rate or tempo for executing events. An example simulation resource URI for a Warthog A-10 aircraft could look like “sip:A-10_tail_32@dmoc.af.mil.”DIS can be integrated with Session Initiation Protocol (SIP) user agents that control Real Time Protocol (RTP) stack technology to provide loosely coupled security services. The SIP messaging transactions are not required to occur in real-time. The real-time communication used to transport the DIS information is RTP, which can easily transport unidirectional and bidirectional streams of real-time data. For this case, SIP message transactions, which look very similar to HTTP transactions, can be routed through an enclave’s SOA. Within the enclave’s SOA, normalized identification, authentication, authorization and accounting and governance services are rendered. SOA services are normalized if they are agnostic of the associated protocol bindings, e.g. HTTP/S, SIP/S and XMPP. SOA Enterprise Service Bus instances will provide Security Support Structure (SSS) controlled interface capabilities (as defined in NISPOM, JAFAN 6/3 and DCID 6/3 regulations) for each enclave. NAT firewalls associated with the SOA instance at each enclave are also part of the SSS. The NAT firewalls for the loosely coupled security services must support server-based PKI encryption services for the signaling and media channels to provide PL2-rated confidentiality services across the WAN. SIP URI resources must have reliable labels associated with them. SOA governance, URI labels and accounting services are used to validate the SSS is performing properly by providing audit trails for accreditation and routine audits.This loosely coupled SIP user agent technology will not provide any integrated SOA simulation presence services (e.g., buddy lists services) for the associated legacy DIS-based resources that are being relayed. However, it will allow PL1 edge enclave host resources to be persisted in a PL2 WAN environment because of its innate ability to operate in environments with NAT firewalls using proxy servers enforcing PL2 need-to-know security and accounting services. (Edge enclaves by definition do not have any tail circuit connectivity, and they contain the simulation resources. An edge enclave’s resources are governed by a common security policy.) The protocol-specific proxy server capabilities (e.g., HTTP/S, SIP/S or XMPP) associated with the firewall behave as a Policy Enforcement Point (PEP) that can either be a component of the SOA or an independent proxy server in its own right. In either case, each PEP protocol binding will be slaved to the SOA’s normalized Policy Decision Point (PDP) that enforces the need-to-know access policies. This allows current need-to-know access control policies responsibilities to be moved from the physical network’s event-specific network design into the SOA that can render the security services to transcend simulation events. For this security model, the NAT firewalls and/or associated SOA SIP proxy servers shall be capable of authenticating incoming requests arriving from the WAN.Moderately integrated security services provide PL2 security services all the way to the simulation’s edge applications, i.e., the simulation user agents. Loosely coupled security provides PL1 security services to the simulation user agents at the network’s edge but provides PL2 security services at the edge enclave’s border with a SSS. Moderately integrated security services will provide integrated SOA presence services unlike the user agents that provide loosely coupled security services. This is because programming language binding-specific Software Development Kits (SDKs) will be associated with the user agents providing the moderately integrated security services. These SDKs will provide interfaces to expose simulation presence services directly to simulations.Identity service responsibilities for loosely coupled and moderately integrated security services will initially be federated. Unlike the loosely coupled security services reference model, moderately integrated security services must provide security for federated resource discovery and enable dynamic find-and-bind capabilities to be rendered. Like loosely coupled security services, moderately integrated security services must provide encryption services when information leaves an enclave and traverses the WAN to another enclave. The NAT firewalls and/or associated SOA SIP proxy servers shall be capable of authenticating federated identities for both incoming requests and requests local to the enclave.Moderately integrated security must support integration with a Computer Network Defense (CND) Service Provider whose functionality may reside in a Network Operations Security Center (NOSC). The NOSC controls the WAN’s configuration management process, monitoring the performance and utilization of the WAN and the reporting of WAN network and security events. The NOSC provides additional WAN security services by protecting, detecting and reacting to intruder behaviors observed on the WAN. The NOSC uses centralized Intrusion Detection Services (IDS) to proactively monitor intruder actions and may provide Intrusion Protection Services (IPS) to cordon off intruder attacks into protected sandboxes. Within this paper, the responsibilities of the NOSC are expanded to provide even greater availability and persistence of simulation resources than what will be achievable without a NOSC. For moderately integrated security services, the NOSC will provide session-layer routing services to connect edge enclaves to one another. The NOSC acts a hub to facilitate and secure communications. All signaling traffic creating sessions must be routed through the NOSC. The NOSC’s session-layer routing capabilities replace the patch panels existing in most experimentation, acquisition, test and training simulation centers that provide WAN hub connectivity services. The NOSC has jurisdiction over and implements the routing of the dial plans for the WAN that allow enclaves to legitimately communicate with one another. Supporting routing dial plans and persistent NAT firewalls at edge enclave borders removes the need for the equivalent of those 1930’s vintage telephone switchboard operators manually running wires across a patch panels to complete calls. For the purpose of this paper, calls will be required to execute simulation events. Without getting into the NISPOM, JAFAN 6/3 and DCID 6/3 IA regulations’ subtle points, inter-enclave session–layer routing rules are entered into the NOSC’s session-layer routing tables only if the weapon system programs associated with the edge enclaves that the NOSC interconnects match. For example, an edge enclave associated only with the F-22 and the F-35 programs can only have signaling traffic routed, via the NOSC, to another edge enclave associated only with the F-22 and the F-35 programs with the same security classification. The entries in the session-layer routing tables are the authorization for two or more edge enclaves to communicate to one another. All the edge enclaves that can communicate to one another directly through session-layer routing rules are in the same routing dial plan. Edge enclaves can only be associated with one default routing dial plan at a time. PL3 services are required if a simulation resource must communicate to a simulation resource on a different dial plan.Tightly integrated security services leverage the PL3 security services that the NOSC is able to provide. Classified PL1, PL2 and PL3 networks always use NSA Type I encryption to protect the confidentiality and integrity of classified information sent across un-trusted channels. Within a common NSA Type I overlay, it is acceptable for PL3 networks to use FIPS 140-2 encryption to segregate data between regular classified programs that are not authorized to share data directly between one another. The tightly integrated security services require the user agents at the very edge of the network to use FIPS 140-2-based encryption. LDAP-based or user-based PKI certificates services should be supported to enable tightly integrated security services to facilitate single-sign-on and single-sign-off services. This encryption can be hop-by-hop, provided the intermediaries (e.g., proxy servers or session border controllers) between communicating user agents are all part of a DAA-approved set of controlled interface security support structures.For PL3 networks, the management of identities of simulation entities residing in different enclaves will not be as loosely federated as was possible with the loosely coupled and moderately integrated security service cases. Mutually recognized identities respected by all enclaves must be used to allow the NOSC to provide dynamic authorization services. PL3 presence services can only be rendered to a subscriber if the subscriber and provider have the proper program tickets, enabling the authorization. Unlike the moderately integrated security services reference model, the tightly integrated security services must provide centralized resource discovery to enable authorized dynamic find-and-bind capabilities for use between dial plans. The centralized resource discovery mechanism can aggregate the data from numerous decentralized resource discovery mechanisms available in common routing dial plans. The authorization decision to allow sessions to be established between routing dial plans shall always be dynamically determined on a transaction-by-transaction basis by the NOSC.The following examples demonstrate simplistic PL3 connectivity. First, let’s assume one edge enclave is associated with the F-16 program and another edge enclave is associated with the F-16 and C-130 programs, and both edge enclaves have the same clearance. The F-16 resources in both enclaves can communicate with one another via the NOSC if the NOSC confirms the edge enclave facilities, users and simulation resources all have the appropriate F-16 tickets (the officially documented approvals). Second, the DoD data owners between the F-16 and C-130 programs may also sign data exchange agreements allowing data to be exchanged between the edge enclaves during specific events. The NOSC will then allow data exchanges between the two edge enclaves to occur within the confines of a given event, i.e., event-specific routing dial plans. The patch panel approach could be used to provide connectivity for the second F-16 to C-130 enclave scenario, but the patch panel approach cannot be used to provide the dynamic authorization services for the first F-16 to F-16 scenario involving two edge enclaves.      The loosely coupled security services can operate either with or without a NOSC. Both the moderately and tightly integrated security services require a NOSC. All three security service models use application security. Notice that both the moderately and tightly integrated security services place security services squarely into the network at the NOSC. For the moderately and tightly integrated security services, all the signaling traffic must pass through the NOSC, but the real-time traffic flows directly between edge enclaves to minimize network bottlenecks and transport delays. The data traffic for a session may flow directly between the enclaves once the associated signaling transactions have successfully completed.The loosely coupled, moderately integrated and tightly integrated security service reference models address PL1, PL2 and PL3 security concerns within a domestic environment not involving network resources belonging to foreign nationals.  The NOSC shall require a controlled interface with a Secret and Below Interoperability (SABI) PL4 rating if it is to establish connectivity with coalition or allies’ edge enclave resources or peer with any existing coalition or allied nation simulation network. A NOSC can provide PL4 services without any PL4+ MLS or other PL4 multi-domain security capabilities frequently associated with Special Access Program (SAP) or Sensitive Compartmented Information (SCI) resources. In fact, it is preferable for SAP-rated and SCI-rated edge enclaves to provide their own PL4 or PL5 multi-domain security services that are only accessible on a simulation event-by-event basis. It should also be noted that the signaling and media traffic pathways shall always pass through the same controlled interface, unlike that described for the loose coupling, moderately integrated and tightly integrated security services that delineate between signaling plane and media plane traffic. SAP and SCI resources sharing a common physical network with other classified resources that are not SAP or SCI must always be segregated with NSA Type I encryption, not FIPS 140-2 encryption. A network containing only SAP resources can use FIPS 140-2 encryption to segregate the data belonging to different SAP programs, however. This section described high-level requirements for three integrated security models that SOA frameworks should provide to maximize simulation network resource connectivity across simulation events for PL1, PL2 and PL3 environments with minimal transport delays. Additionally, these security reference models were also related to PL4 and PL5 environments containing SAP and SCI resources. Current DoD IA policies for MS&A prohibit multi-domain simulation resources to be persisted across simulation events. Also, due to risks associated with managing tail circuits, it is unlikely the duration of network peering relationships between existing networks will last longer than one simulation event.5. SOA ESB Technology and NCES-Security ServicesThis section provides a very short background about what an Enterprise Service Bus (ESB) SOA component is, identifies emerging open ESB standards, and identifies an architectural capability gap that ESB or SOA implementations need to address to be useful for distributed MS&A applications. An ESB must support in a single infrastructure the following three styles of enterprise integration: SOA, message-driven architecture and event-driven architecture [11]. A collaborative MS&A environment will need to support all three architectures. An ESB is an emerging SOA component that makes SOA principles manageable within large-scale heterogeneous networks. XML messaging is used as the lingua franca between end points communicating across the ESB. Most ESB implementations have historically provided proprietary interfaces and Software Development Kits (SDKs).  Recognizing this problem, several specifications have evolved, with Java Business Integration (JBI), JSR-208, being one of the more notable ones. There is some confusion about whether the Service Component Architecture (SCA) is a competing specification to JBI. While these specifications may have some overlap, JBI is focused more on integration product standardization, while SCA addresses the different problem of writing services in a standard way. SCA does not cross programming language boundaries which does not foster interoperability. SCA also clashes with JSR-181, “Web Services Metadata for the Java Platform,” which provides a standardized means to add Web services to Java containers. JSR-181 decouples Web services from the container technologies used to deploy them. The JBI specification defines a set of interfaces that components may implement to enable them to be used in any JBI-compliant container. This enables a custom component developed for one JBI-compliant ESB to be used in other JBI-compliant ESB implementations, thus removing vendor lock-in and at the same time increasing reuse possibilities.Several vendors and open source projects have already released products supporting JBI or have announced intentions to incorporate JBI into their products. JBI container technologies should be very mature around 2008 or 2009. These include such open source projects as Apache’s ServiceMix, Sun's Glassfish and Open ESB projects, and other commercial products from Oracle, IONA, JBoss, Sonic, SAP AG, Sybase, TIBCO and others. To date it’s been impossible to obtain COTS, GOTS or open source ESB components and quickly integrate them with meaningful DIS virtual or live simulations leveraging existing Internet Engineering Task Force (IETF) wire-level protocols. This capability is needed if SISO is to develop a net-centric MS&A standard interoperable with existing DIS, TENA and HLA simulations while also supporting seamless integration with new C2 systems and leveraging SOA technologies extensively. This ESB capability gap is not being filled because the ESB application server industry does not currently understand or recognize the need to support SIP components allowing SIP user agents to be easily mashed together with VoIP-based conferencing technology across enterprise boundaries securely. A mashup is an application or Website that seamlessly integrates content from one or more sources into an integrated collaborative experience. SISO needs to help mature wire-level streaming mashups (smashups) technology that will allow service-based composite applications to be built quickly. Most of today’s mashups are biased towards using HTTP/S. The challenge for SISO over the next five years will be to develop standardized simulation smashup conferencing interfaces that can be integrated with existing real-time DIS, TENA and HLA simulations and that also provide communication security services.Since the development of a distributed MS&A ESB with streaming mashup capabilities will be very complex, there is a need for agency, industry and academic collaboration. This will require development efforts to initially leverage open-source JBI technologies as much as possible to minimize licensing cost for experimentation and foster quicker adoption.  For this paper’s purposes, the ESB component must provide reusable security services such as routing, identification, authentication, authorization, access control, content-based routing, accounting, confidentiality and governance services. ESB components will ultimately require government agency accreditation in order to be readily accepted by DAAs for deployment operational networks.DAA personnel are gaining an appreciation for DISA’s NCES-Security services. NCES-Security has WSDL interfaces that can be implemented within a JBI container to provide protocol-agnostic PDP behaviors and provide protocol-specific HTTP/S PEP behaviors. Though the capability does not exist today, an NCES-Security PEP binding for the SIP/S protocol can be built to complement the easier-to-implement HTTP/S PEP using common JBI container technology. The SIP/S PEP, which also controls S/RTP channels, will then interface to the same protocol-agnostic PDP that the HTTP/S PEP will already interface to. In a nutshell, NCES-Security can be used to enforce PL2 Discretionary Access Controls (DAC) with Role Based Access Controls (RBAC) policies for HTTP/S and SIP/S channels, complete with accounting services. All this can be accomplished within an open source ESB conforming to the JBI container interface. One shortcoming of NCES-Security, which can be overcome with additional coding, is that contractors will want finer-grained Identity Based Access Controls (IBAC) policies to supplement the NCES-Security RBAC policies to allow themselves to adequately protect their intellectual property. The following is the proper order to conceptually render groups of ESB services for a simulation MS&A environment: 1) enforce the routing policies for transactions; 2) provide identification and authentication services; 3) enforce regulatory security policies, business security and QoS policies; 4) provide content transformation services; 5) enable direct out-of-band user agent actions. It is next to impossible to make the first four sets of services operate within a real-time MS&A environment. The fifth service can function properly in a real-time MS&A environment.  The trick to understanding the architecture presented in the next section is to realize the first four sets of services are associated with what the VoIP telecommunications world calls the signaling plane and the last service set functions in the data plane. SIP/S is a fundamental signaling plane protocol, and S/RTP is a fundamental data plane protocol. The emerging streaming mashup technology described below is really a hybrid of SOA ESB technology and VoIP telecommunications technology.6. Secure Streaming Mashup Model  Streaming mashups use VoIP conferencing technology. Text chat conferences, also called chat rooms, can be implemented using streaming mashup technology. SISO, however, is more concerned about streaming mashup technology pertaining directly to distributed MS&A. This section identifies and describes an emergent distributed MS&A four-layer edge enclave model to support secure streaming mashups. This model uses SOA components extensively, and it exhibits a high degree of reuse for all edge enclaves to provide loosely coupled, moderately integrated and tightly integrated security services. The model for the NOSC enclave exhibits great asymmetry, and its details will be the subject of future SISO conference papers. The model description below references the Air Force Integrated Collaborative Environment (AF-ICE) seven-step event simulation value chain. Each of the seven steps maps directly to the following phases of a simulation event lifecycle:Formulate Event, Specify Battlespace, Build Battlespace, Integrate Battlespace, Execute Event, Analyze and Report, and Sustain Event Documentation and Environment. It is easier to identify value-added simulation services by mapping services to the simulation event lifecycle phases identified above. The DIS, TENA and HLA standards focus on providing services for the fifth simulation phase and not the whole collaborative event lifecycle. Successful SOA service deployments tend to examine the business process lifecycle holistically to identify services for reuse that add the greatest business value. It is of little value to focus on the services of one phase if the other phases are the bottlenecks reducing the system’s overall valued throughput. The objective of AF-ICE is not to minimize the time and effort to execute a single event, but to minimize the time and effort to get into the pipeline and execute multiple events across the collective seven phases involving sensitive resources (e.g., classified information, intellectual property and export controlled data).  AF-ICE desires to create distributed MS&A doctrine for the Air Force acquisition community.Figure 1 identifies four dominant architectural layers that have emerged from converging Gestalt’s Multi-Channel Service Oriented Architecture (MCSOA) container technology with SIP VoIP technology during 2006. (MCSOA’s source code is GOTS.) The components in this diagram are logical and are subject to change as Gestalt’s monthly Pathfinder Sprints provide feedback to refine the architecture.  The top two composition and control layers associated with SOA choreographic and orchestration capabilities. The bottom two layers are associated with the VoIP telecommunication industry’s signaling and media planes.The composition layer allows one or more users, either inside or outside an enterprise, to effectively compose simulation events by allowing streaming resources established by invoking SIP Uniform Resource Identifier (URI) addresses to be aggregated in one or more conferences. The composition layer is responsible for allowing simulation events to be choreographed by an end user knowing little or nothing about simulation coding. The event Live Virtual Constructive (LVC) Lead can use a Web browser to schedule DIS-based simulation, or other simulation-standard-based components, to be integrated into a simulation dry-run or simulation event. MCSOA scheduling (i.e., calendaring) services are made visible to the user at the composition layer to ensure scarce virtual and constructive resources are not overbooked.The control layer's services are never accessed directly from an external enclave.  The normalized SOA services (e.g., work flow, registration, discovery, resource resolution, calendaring, availability, publish, subscribe, notify, presence, instant messaging (IM), conferencing, network bandwidth latency & throttling, QoS, and so on) are orchestrated together by a MCSOA Web Developer into higher level aggregate services useful for the LVC Lead to utilize. The orchestrated services can be invoked by users external or internal to the enclave by the Web server at the composition layer.  The control layer will inherently provide significant security functionality such as identity management, access control, invocation authorizations and access logging.If a future AF-ICE simulation event does not have a sufficient inventory of simulation entity behaviors, new simulation models will be created by developers and deep domain subject matter experts during the AF-ICE "Build Battlespace" Phase. URI addresses often will be assigned to the new simulation models. This may require the provisioning of additional accounts to ensure simulation access control policies can be enforced properly to maintain confidentiality and integrity. During the AF-ICE "Integrate Event Battlespace" Phase, the MCSOA Web developer(s) will use MCSOA simulation wrapper technology and MCSOA orchestration services, possibly with a Business Process Execution Language (BPEL) engine, to quickly expose the new simulation resources as Web services that can be invoked by a Web Server (such as Tomcat) at the composition layer.It is very likely that the MCSOA Web developer will collaborate with the new simulation entity developer and the domain expert during Web integration in the Integrate Event Battlespace Phase. MCSOA presence, IM and voice conferencing services are likely to facilitate the collaborations, especially if the participants are remotely located from one another. It is worth noting that a MCSOA Web developer will not require the in-depth programming skills that the typical simulation entity developer will have. It is expected that the simulation entity developer will be able to easily pick up the skills of a MCSOA Web developer. By wrapping simulation entities with MCSOA Web technology, it will be much easier for the developer to inherit or leverage numerous services (e.g., security, work flow, registration, discovery, presence, IM, conferencing, availability and calendaring, and so on) integrated into MCSOA.If the new simulation entity is a smart concept munitions bomb associated with Air Armament Center (AAC) efforts, and the aircraft is a UAV associated with Aeronautical Systems Center (ASC) efforts, the MCSOA Web developer might want to perform small tests requiring a UAV desktop pilot at the Simulations Analysis Facility (SIMAF). The Web developer can quickly compose simulation dry-runs by composing the ad hoc event using only a Web browser and the composition server. Let's also assume the concept munition requires the target to be illuminated by a laser designated by a constructive soldier on a rooftop. The simulation behaviors (UAV & pilot, smart bomb and soldier laser designator) are likely to reside at three different edge enclaves containing functionality similar to the one above.By knowing the URIs associated with the three simulation entities, the Web developer can schedule an ad hoc SIP-based DIS conference, which monitor the presence of the pilot at the SIMAF. When then UAV pilot is finished with his coffee break, the MCSOA cross-enterprise presence engine notices all players are present. A courtesy instant message is sent to the pilot to confirm he is ready, and the SIP-DIS conference server invites all the participants. If SIP is used, the signaling plane layer, the second from the bottom, is used to render the presence, IM and invite session establishment commands. If XMPP is used to provide presence and IM services, the services are provided in the bottom media plane layer. It will be transparent to the simulation entities whether the presence or IM services are provided by SIP or XMPP or some combination of the two. This is an example of what it means for a SOA to provide normalized multi-channel services.The three simulation participants (UAV, smart munitions and virtual soldier) are wrapped with MCSOA DIS user agent technology, and each user agent has an associated SIP URI. The conference server calls the three participants across enclave NAT firewall boundaries by invoking the SIP URI methods associated with the three resources using the default SIP INVITE method. All of the DIS traffic between the three participants is conferenced in the media plane layer by the DIS RTP conferencing services. This is the streaming mashup capability. Note that it is possible for a simulation event to have multiple simultaneous conferences occurring in parallel on the same or different conference servers in different edge enclaves. Conferences can be bridged together, and DIS filtering services definitely will be useful when bridging conferences. The media plane natively supports the Real-time Protocol, RFC 3550, used by VoIP applications to carry real-time voice and video streams. MCSOA uses the RTP packets to transport the DIS packets between the three user agents. When the simulation is finished, the exercise controller (the MCSOA Web Developer in the example), stops the simulation with a portal interface. This causes the conference server to send three SIP BYE messages in the signaling plane to the three participants to gracefully end the integration test.7. ConclusionsHuman-to-machine audio conferencing technologies have been around for decades. Next-generation VoIP conferencing technology is currently being standardized by the IETF. The novel idea to apply VoIP conferencing technologies to DIS and HLA emerged in 2004, and a first HLA-related thesis was released in 2006 [12]. Conferencing is a pattern very similar to publish-and-subscribe. Conferencing mechanisms are very likely to complement or replace existing publish-and-subscribe mechanisms, especially when real-time services requiring security and QoS are needed. Because the telecommunications industry has proven the scalability of VoIP conferencing technology, and the IETF is in the process of standardizing it, extended VoIP conferencing concepts hold tremendous promise for real-time applications involving DIS, HLA and TENA. Numerous SISO papers have addressed SOA technologies, but most of those authors acknowledge the SOA technologies explored have a major capability gap for supporting the real-time requirements of DIS, HLA and TENA. There is also a considerable interest in SOA mashup technology to address the “need-to-share” security policies in time of crisis events while “need-to-know” policies are enforced during times of peace. Once again, however, most of the SOA mashup technologies are not suited for real-time distributed M&S. Emerging streaming mashups (smashup) technologies can fill the SOA capability gap for providing mashup services for real-time streaming applications. There is a strong overlap between smashup and VoIP conferencing technologies.  A smashup can be considered a generalized type of conferencing. SISO should foster collaboration between VoIP and SOA communities to accelerate the development of smashup technology. If VoIP and SOA ESB architectures are mixed judiciously, new architectures will emerge that will be net-centric. These emerging net-centric architectures will be well-suited for integration with Internet Protocol-based C2 systems and can also be made highly interoperable with the existing DIS, HLA and TENA standards while providing valuable services (e.g., security, QoS, presence, IM, and so on) not currently provided by DIS and HLA. Finally, net-centric C2 MLS solutions can be adopted directly by the DIS, HLA and TENA communities instead of developing very expensive MLS stovepipe solutions for each of the standards with difficult to manage MLS gateway services.       This paper gave very strong traceability to DoD acquisition directives and instructions pertaining to what it really means for systems to be net-centric. Net-centric systems must satisfy the four NR-KPPs. This author believes that DIS, HLA and TENA are anything but net-centric, and these standards should not be allowed to be used on the GIG until they first satisfy net-centric requirements, just like any other IT system deployed on the GIG. At this time, the foundation technologies for building net-centric distributed MS&A applications will be SOA-based and SIP VoIP-based. Resources need to be applied to mature the integration of these technologies to provide new and more interoperable simulation services that currently do not exist.8. ReferencesUniversity of Maryland, Robert H. Smith School of Business - Netcentric Supply Chain Lab"The Netcentric Revolution is Here!",  HYPERLINK "http://www.rhsmith.umd.edu/netcentricity/index.html" http://www.rhsmith.umd.edu/netcentricity/index.html “Interim Department of Defense (DoD) Certification and Accreditation (C&A) Process Guidance”, HYPERLINK "http://iase.disa.mil/ditscap/interim-ca-guidance.pdf" http://iase.disa.mil/ditscap/interim-ca-guidance.pdf; July 6, 2006Defense Acquisition University Guidebook, "7.2.6.1 Features of Net-Centricity",  HYPERLINK "http://www.deskbook.osd.mil/dag/Guidebook/IG_c7.2.6.1.asp" http://www.deskbook.osd.mil/dag/Guidebook/IG_c7.2.6.1.asp"Interoperability and Supportability of Information Technology (IT) and National Security Systems (NSS)",  HYPERLINK "http://www.dtic.mil/whs/directives/corres/pdf/d46305_050504/d46305p.pdf" http://www.dtic.mil/whs/directives/corres/pdf/d46305_050504/d46305p.pdf; May 5, 2004"Procedures for Interoperability and Supportability of Information Technology (IT) and National Security Systems (NSS)",  HYPERLINK "http://www.dtic.mil/whs/directives/corres/html/46308.htm" http://www.dtic.mil/whs/directives/corres/html/46308.htm;  June 30, 2004JITC Plans and Policies Branch,“JITC Interoperability Certification Process”;5 March 2005"Joint Capabilities Integration and Development System",  HYPERLINK "http://www.dtic.mil/cjcs_directives/cdata/unlimit/3170_01.pdf" http://www.dtic.mil/cjcs_directives/cdata/unlimit/3170_01.pdf; 11 May 2005"Interoperability and Supportability of Information Technology and National Security Systems",  HYPERLINK "http://www.dtic.mil/cjcs_directives/cdata/unlimit/6212_01.pdf" http://www.dtic.mil/cjcs_directives/cdata/unlimit/6212_01.pdf;  8 March 2006S. Holben, “Distributed M&S Security Capability Gaps”, 06S-SIW-075, SISO SIW; Spring 2006S. Holben and R. McKeon, “Providing Asserted Identity Services for Distributed M&S”, 06F-SIW- 110, SISO SIW; Fall 2006WebShpere Software“Patterns: Implementing an SOA Using an Enterprise Service Bus”, page 76; July 2004C. Van Ham, “SIP-RTI: A High Level Architecture, Runtime Infrastructure built on a SIP-enabled Conferencing Mechanism”, Master of Applied Science, Ottawa-Carleton Institute for Electrical Engineering Facility of Engineering; September 2006Author BiographiesSCOTT HOLBEN is a Technical Architect participating in the AF-ICE Security, Network and SOA Work Groups. He is currently leading the AF-ICE Security Work Group and has 20 years of experience working in distributed M&S environments.PAGE  Figure 1: Four-Layer Distributed MS&A Edge Enclave Model