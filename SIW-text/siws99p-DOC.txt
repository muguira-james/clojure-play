Status Report: JSIMS Environmental Tailoring Services (JETS) Tailoring Algorithms and Framework Assessment Peter S. DaileyTodd A. HutchinsonRonald F. FournierSteve O. OuztsTASC, Inc.55 Walkers Brook DriveReading, MA 01867-3297781-942-2000, Fax 781-942-7100 HYPERLINK mailto:psdailey@tasc.com psdailey@tasc.com,  HYPERLINK mailto:tahutchinson@tasc.com tahutchinson@tasc.com, HYPERLINK mailto:rffournier@tasc.com rffournier@tasc.com,  HYPERLINK mailto:soouzts@tasc.com soouzts@tasc.comKeywords:JSIMS, Synthetic Natural Environments, User-controlled weather, Environmental Tailoring, Tailoring FrameworkABSTRACT: One important objective of the Joint Simulation System (JSIMS) is to integrate physical environmental effects (atmosphere-ocean-space-terrain) to provide new levels of realism and consistency across heterogeneous simulations. Providing flexible tools to the simulation community will lead to more productive training.  For example, environmental editing tools will allow exercise controllers to steer the scenario to fulfill training objectives.  JETS (JSIMS Environmental Tailoring Services) is building a scientific basis for such editing tools.  The Pressure Field Modification (PFM) algorithm has been enhanced to include more variables and refined blending.  This paper will present progress on continuing PFM algorithm development.  Before any JETS tools can be incorporated into JSIMS, a framework must be defined to provide a basis for environmental editing across a distributed architecture.  This paper also discusses the first stages of the JETS framework investigation.1. IntroductionOn-demand tailoring of environmental data is an important objective of the Joint Simulation System (JSIMS). Tailoring tools are required to make detailed adjustments to a scenario and to steer the training experience at run-time to meet specific goals. The objective of the JSIMS Environmental Tailoring Services (JETS) project is to develop techniques and guidance for this on-demand tailoring. In the recent past, changes made to a scenario were primarily visual and had little impact on the simulations.  In the future, JSIMS envisions SNE control that provides the ability to affect run-time changes to a scenario.  Because simulations and their operators need data and products that are consistent and derived from a common SNE, any tools used to edit the Synthetic Natural Environment (SNE) must assure an appropriate level of physical consistency across all five dimensions (time, 3-D space, and variable).  One basic JETS task is to develop algorithms that will take changes to the SNE and consistently reflect those changes through the rest of the SNE data at an appropriate level of scientific validity.SNE tailoring is already seen as a critical element of scenario construction in the next century [1,2].  Tools which allow for scientifically valid adjustments to the Synthetic Natural Environment (SNE) will assist the Modeling and Simulation (M&S) community in two basic ways.  First, editing tools will allow for the adjustment of the SNE during the construction of the scenario (pre-exercise).  This can be very useful if the gridded data gathered according to some set of scenario requirements does not exactly meet those requirements.  JETS tailoring algorithms can then be used to modify a small portion of the SNE to meet a specific goal, blend those changes with adjacent regions and times, and leave the remaining data unchanged.  Second, JETS tailoring tools can provide for short-notice changes to the SNE during the exercise itself (during run-time).  This is more of a challenge than editing during scenario construction in that run-time editing tools require not only physical consistency, but also the ability to operate efficiently across a distributed simulation. There is always a delicate balance between the complexity of physics and the computational expense of adhering to those physics.  In order to fully explore such issues, the JETS effort has begun to investigate the framework within which JETS tools can be incorporated.  Section 2 discusses updates to the Pressure Field Modification algorithm.  Section 3 reports on progress in the JETS Framework task and issues associated with the framework investigation.Algorithm Development2.1  TerminologyBefore discussing the details of a JETS tailoring algorithm, it is appropriate first to review some of the basic terminology used in environmental editing.A variable edit is a user-specified change to the environmental scenario within some three-dimensional region, whether it be a priori (pre-exercise) or during run-time.  Typically, the edit is applied to one variable at a set of grid points within an elliptical subdomain.  Edits may be applied to a basic variable which is contained in the SNE data (e.g., winds) or to a derived variable defined by a transformation of SNE data (e.g., vorticity).   The variable edit serves as the starting point from which the JETS algorithm modifies some portion of the SNE.The three-dimensional region defined by the variable edit is termed the edit region.  The time at which the edit takes place is the edit time.  Data within that region that is coupled to the edit variable due to its physical relationship to the edited variable must be modified to guarantee proper physical consistency.  These are the first changes made to the SNE by JETS algorithms and are termed correlated edits.Data lying within the edit region but at SNE times other than the edit time are blended with both variable and correlated edits to assure a smooth temporal transition through the edit.  These modifications to the SNE made by JETS algorithms are called temporal blends.Similarly, data lying away from the edit location must be blended with edited data at the edit location to provide a smooth spatial transition. These modifications are called spatial blends. JETS algorithms typically make modifications to the SNE in the following order: (1) spatial blends, (2) temporal blends, and (3) correlated edits.  Though the variable edit is accepted as the user’s requirement and is not modified, the algorithm may provide guidance if the edit violates some basic physical or statistical constraint. PFM Algorithm RevisitedJETS has introduced an approach for environmental tailoring called Pressure Field Manipulation (PFM).  Details related to the formulation of PFM can be found in [3].  Here, we will briefly review the basis for the algorithm and discuss enhancements made since our last report.The basic concept of the PFM algorithm is to build “modules” which take a variable edit and reflect that change to the SNE as a change to the underlying atmospheric pressure field.  A basic schematic of the algorithmic process is shown in Figure 1.There are several advantages to this approach.  First, the construction of correlated edits is truly modular.  For example, once a pressure-to-wind module is constructed, then any front-end module which brings about a change to the pressure field will produce a modification to the wind field. The approach also allows for the incremental testing of the algorithm and a gradual build of a robust set of correlated edits.In a prior discussion [3], an example application of the PFM algorithm showed how a modification to the temperature field results in a change to the SNE wind field.  Moisture processes were largely ignored in this discussion.  PFM has now been enhanced to accept variables edits to the cloud and precipitation fields.  Moreover, edits made to other fields (e.g., temperature and wind) will result in correlated edits to clouds and precipitation.It should be noted that PFM is by no means a model of the atmosphere and is not meant to “predict” the atmospheric response to an SNE modification.  Only a fully formulated Numerical Weather Prediction (NWP) model can perform such dynamic and nonlinear prognoses.  Rather, PFM is meant as a means of supplying an appropriate level of scientific fidelity to an M&S training scenario.2.3  Application of the Enhanced PFM AlgorithmTo evaluate the enhanced PFM, we have built a test SNE using the PSU/NCAR MM5 (Pennsylvania State University/National Center for Atmospheric Research Mesoscale Modeling System Version 5) numerical model [4].  An MM5 scenario is generated for a 24 hour period with state data saved every hour.  Some model grid details are shown in Table 1.The model is initialized using 1( x 1( NOGAPS (Navy Operational Global Atmospheric Prediction System) analysis fields from December, 1998 and run over the contiguous United States.  Figure 2 shows the geographical coverage of the model domain.The enhanced PFM algorithm is tested using an edit to the cloud field at t = 12 hours placed at 35.0 N. latitude and 93.0 E longitude.  We define a modification at that location to require 100% relative humidity (RH) indicating saturated air and the existence of a cloud.  A weighting function specifies how the edit decays outward from the edit location ramping to a zero perturbation at r = 1500 km.  Thus, 1500 km away from the center of the edit region, the modification to RH is zero.  Within the edit region, RH is a blend of the humidity before and after the edit is applied.Figure 3 shows the base state and edited cloud fields at the model’s 500 mb pressure level at time t = 12 hours.  Clouds are indicated at this pressure level wherever RH exceeds 75%.  Note that clouds are not added within the entire edit region.  Due to the blending process, the edited relative humidity field is partly a reflection of the unperturbed environment.  Therefore, only those grid points within the edit region which are sufficiently close to the edit location and are sufficiently moist in the unperturbed environment will satisfy the RH threshold for clouds.  The advantage of this approach is that the resulting cloud field produced by the algorithm has a realistic shape and is correlated with the pre-edit moisture field.The pre- and post- edit RH fields are shown in Figure 4.  There is a general region of high RH within the edit region in panel B that is indicative of the modified cloud field.  Note that outside of the edit region, the RH field is undisturbed.After performing the edit to the RH field to satisfy the requirement for additional clouds around the edit location, the next step is to perform the necessary correlated edits to the remainder of the SNE.  The enhancement to the RH field can be brought about by two basic processes.  Either the temperatures within the edit region can be decreased or the dew point (or atmospheric moisture content) can be increased.  We have implemented the first approach here.  The second approach, altering the moisture field, could serve the same function but would have different atmospheric consequences.  We expect to report on a comparison of these approaches in a future paper.Here, we affect the RH modification by decreasing the temperature field within the edit region.  Because the RH has already been spatially blended, the temperature modification will also exhibit a natural ramping off at the boundary of the edit region.  Figure 5 shows the unedited and edited temperature fields resulting from the PFM algorithm.  The “bulls eye” signature of the edit to clouds is quite apparent in the temperature field.  There is a significant impact to the temperatures close to the center of the edit region.  The strongest impact is felt where the RH field has changed the most.  Note this is not a linear function out from the center of the edit because the original distributions of RH and temperature are not constant. In [3], the PFM algorithm was introduced by taking an edit to the temperature field and reflecting that change to the pressure field, then using the pressure field modification to alter the wind field.  That demonstration was based on an edit to the surface temperature.  This TEMP(PRESSURE(WIND module of PFM has been enhanced to handle edits to the temperature field aloft.  It is then applied to the modified temperature field shown in Fig. 5 to produce a new wind field.  A comparison between the unedited and edited wind vectors is shown in Figure 6.Interestingly, there is very little modification to the wind field resulting from the variable edit to the cloud field.  This can be explained as follows.  The impact of the edit to clouds on the winds is ultimately tied to the change in the temperature field.  The initial edit to the RH field can be seen as an edit to an atmospheric volume with a horizontal extent defined by the radius of influence and a vertical extent defined by the distance between SNE grid levels.  Here, the cloud field between 400 and 500 mb has been altered.  Thus, the edit to the temperature field is distributed over a three-dimensional “edit volume”.  As the volume increases (decreases), the temperature edit is smoothed over a larger area and the resulting change in the temperature gradient is smaller (larger).  The change in temperature gradient is directly proportional to the change in wind velocity.  Thus, a very large edit volume will produce a small change to the wind field.  In this example, the edit volume is quite large having a horizontal diameter of 5000 km and a vertical thickness of 100 mb.A side effect of this “volumetric” distribution of the edit is that the region of influence may be used to tune the distribution and magnitude of edits to other variables.  It may also be used to handle colocated edits to different variables or edits to derived (combined) variables.In summary, the process of modifying the cloud field in the test SNE is to first edit the relative humidity field and associated temperature distribution.  Next, the algorithm determines the pressure perturbation associated with this change to the temperature field, and finally the wind field is adjusted to reflect the new pressure distribution.  The entire process is diagrammed in Figure 7.JETS FrameworkAn integral part of the SNE construction process includes a suite of SNE tailoring tools supporting environmental variable modification in a physically consistent manner. Therefore, an Environmental Representation Framework (ERF) which supports these tailoring tools is needed to provide a means of tailoring within a distributed training environment. JETS represents SNE tailoring technology operating within the ERF.The JETS ERF definition supports a unified SNE data representation and the JETS tools needed to modify the SNE variables. The SNE variables for JETS modification are identified, reference coordinate system defined, SNE storage access is recommended and the JETS tailoring tools are identified as part of the ERF definition process.Key Framework IssuesAlthough a unified ERF for the terrain, space, atmosphere and ocean SNE realms is desired, reuse of existing and/or modified real-world technologies focused on reducing technical transition risks and minimizing implementation costs are priority objectives of the JETS project. Factors governing the definition of an ERF include the following:(   Identification of the SNE variables(   Spatial and temporal distribution of SNE variables (  Architectural structure of the tailoring algorithms by which the SNE variables are modified during the Pre-Exercise and/or Exercise Run Time phases (  Architectural structure of the retrieval and storage access mechanisms by which the SNE data is retrieved and saved during the Pre-Exercise or Exercise Run Time phases Note that the governing factors above address the SNE variable domain (i.e., the variables themselves along with their varying spatial and temporal distributions), and the software and data storage architecture needed to retrieve, modify and store the exercise SNE. Progress and PlansThe framework task began with a complete review of relevant literature including several JSIMS documents such as CMMS, CONOP, Abstract Model, Functional Requirements, Technical Requirements, and High-Level Design.  The document review also included review of several MEL (Master Environmental Library) specifications..The FY99 plan for the JETS framework specification consists of four major task areas:Framework Definition: JSIMS models, HLA, SEDRIS, WSG, STOW and JMSM documentation will be reviewed, along with the SNE tailoring algorithms. These activities lead to a JETS architectural definition. The architectural definition will allow incremental enhancement of JETS SNE tailoring capability.JETS Design: Based on the JETS framework’s architectural definition, JETS three major architectural components (JETS GUI, JETS Tools, SNE Access) will be  designed for subsequent development.Implementation: This group of tasks include the detail design of the architectural packages defined in the JETS Design tasks, development of the unit test plan, software development and unit test, package software integration and readiness reviews for each of the JETS architectural packages.Integration Test: As the software development and unit tests proceed, activities subsequent to the package readiness review are integrated and tested.Demonstration: These tasks are related to a demonstration of the integrated and tested JETS algorithms. SNE access for the demonstration will be TAOS.The framework task will be refined further as the algorithm development approaches maturity.  We intend to report more fully on JETS framework development in a future paper.Summary and Future WorkWe have discussed a physics-based technique for consistent modification of an SNE database.  It is stressed that, although we have focused on the atmosphere throughout the discussion, the procedure could be extended to other dynamical systems such as the ocean and space.The PFM technique involves the determination of a pressure perturbation resulting from a variable (user-specified) edit.  The example of an edit to the cloud field over a 2500 km region of influence is used to illustrate the capabilities of the enhanced PFM technique.  Based on a modification of the pressure field, correlated edits are made to relevant state variables to reflect the physical effect of the edit (i.e., winds).  The addition of moisture variables has extended the algorithm to handle alteration of the cloud and precipitation fields.The PFM algorithm also uses statistical and physical constraints to determine the validity of a variable edit and provide feedback to the user if an edit is deemed unreasonable (i.e., violates a constraint). PFM constrained domain analysis (CDA) is being evaluated and enhanced and we expect to report on this aspect of the environmental tailoring in a future paper.Future work will also include the incorporation of derived variable edits.  These modifications, involving the combination of more than one SNE variable, may result in significant efficiency tradeoffs.  JETS’ ultimate goal is to provide a flexible toolset of techniques of varying fidelity and complexity so that the user may choose what is appropriate given specific tailoring needs and the constraints of a distributed simulation environment.The process of defining the framework for incorporating techniques such as PFM into a distributed architecture has begun.  The next steps in this task following a review of relevant documents include design, development, and a JETS SNE tailoring demonstration.5.  References[1]	Whitney, D. A., et al.: “TAOS: Providing and Managing Realistic Natural Environments for Virtual Worlds”, Proceedings of the Fall Simulation Interoperability Workshop, September 1997.[2] Whitney, D. A., et al. “Virtual Natural Environments for the 21st Century”, Proceedings of the I/ITSEC Conference, 1998.[3]	Dailey, P. S., et al., “Algorithms for Consistent Tailoring of the Synthetic Natural Environment”, Proceedings of the Fall Simulation Interoperability Workshop (SIW), September, 1998.[4]   Grell, G. A., J. Dudhia, and D. R. Stauffer, 1995: A description of the fifth generation Penn State/NCAR mesoscale model (MM5).  NCAR Technical Note TN-398+STR, 122 pp.AcknowledgmentsThis work is sponsored by the Defense Advanced Research Projects Administration (DARPA). Author BiographiesPeter S. Dailey is an atmospheric scientist and the technical lead for atmospheric data integration on the TAOS project. Dr. Dailey received a B.A. and B.A.S. from the University of Pennsylvania, and a M.S. and Ph. D. from the University of California at Los Angeles.Todd A. Hutchinson is an atmospheric scientist with an M. S. in Meteorology from the University of Oklahoma.  Todd has worked on various Modeling and Simulation efforts.Ronald F. Fournier specializes in realtime data processing and visualization systems. Mr. Fournier received his B.S. in Meteorology from the University of Lowell in Lowell, Massachusetts, and an M.S. in Meteorology from the Massachusetts Institute of Technology.Steve O. Ouzts, a retired US Air Force Colonel, has over 25 years experience in meteorology, space operations, modeling and simulation, and remote sensing. He has a B.S. from Auburn University, a M.S. in Atmospheric Dynamics from the Naval Postgraduate School, and an M.B.A. from the University of Nebraska. Due to the governing physical equations that determine how the new pressure field is determined, the modification to the SNE takes place over a vertical layer lying between two pressure levels.  Though the original edit is to the cloud field at 500 mb, the resulting edit to the temperature field take place over a layer from 500 mb to the next model level (in this case 400 mb).SNE Variable EditBBSNE Correlated EditFigure 5 – Cross-sections of (a) pre-edit temperature field and (b) post-edit temperature field taken at a height of 500 mb.  The edit region is outlined.Figure 3 – Cross-sections of (a) pre-edit cloud field and (b) post-edit cloud field taken at a height of 500 mb.  The edit region is highlighted.Figure 4 – Cross-sections of (a) pre-edit relative humidity field and (b) post-edit relative humidity field taken at a height of 500 mb.  The edit region is outlined.Figure 6 – Cross-sections of (a) pre-edit wind field and (b) post-edit wind field taken at a height of 500 mb.  The edit region is outlined.BABA     Figure 1 – Schematic representing the process of performing an edit      using the PFM algorithm.  Figure 7 – Schematic representing the process of performing a cloud  edit on the test SNEEdit Wind FieldEdit Pressure FieldEdit   Temp FieldEdit cloud field (RH)AFigure 2 – Geographical coverage of the test SNE produced by the MM5 atmospheric numerical model.AEdit to   Pressure Field